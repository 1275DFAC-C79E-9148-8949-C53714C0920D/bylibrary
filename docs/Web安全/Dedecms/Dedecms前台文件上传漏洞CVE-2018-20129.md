---
title: 'Dedecms前台文件上传漏洞CVE-2018-20129'
date: Tue, 13 Oct 2020 01:09:22 +0000
draft: false
tags: ['白阁-漏洞库']
---

#### 影响版本

dedecmsV5.7 SP2

#### 漏洞成因

管理员用户前台可以绕过限制上传shell

#### 复现

登录并进入member/article\_add.php发布文章，选择下面的富文本编辑器插入图片 ![](https://www.bylibrary.cn/wp-content/uploads/2020/10/af04d86a30794181263cad493b759731.png) 选择好shell并上传抓包 ![](https://www.bylibrary.cn/wp-content/uploads/2020/10/189e02e32f8fc9c11570e03236594d1a.png) ![](https://www.bylibrary.cn/wp-content/uploads/2020/10/e3fef918b39b14960583f1d4e0fcb8c0.png) 向如上分析修改文件名与content-type，即可返回shell地址 ![](https://www.bylibrary.cn/wp-content/uploads/2020/10/3c7c9ec6b57528d6d3171b7153b5445b.png)

#### 修复意见

在最后拼接文件名时再判断一次。